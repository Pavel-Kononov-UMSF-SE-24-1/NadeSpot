<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NadeSpot - Лучшие гранаты CS2</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#ff4500">
  <style>
    :root {
      --primary: #ff4500;
      --primary-dark: #e03d00;
      --primary-light: #ff6a33;
      --secondary: #1a1a1a;
      --dark: #111;
      --light: #f5f5f5;
      --gray: #888;
      --card-bg: #1e1e1e;
      --card-hover: #252525;
      --text-color: #f5f5f5;
      --bg-color: #111;
      --nav-bg: #1a1a1a;
      --border-color: #333;
      --input-bg: #2a2a2a;
      --danger: #dc3545;
      --danger-dark: #bd2130;
      --success: #28a745;
      --info: #17a2b8;
      --warning: #ffc107;
      --easy: #28a745;
      --medium: #ffc107;
      --hard: #dc3545;
    }

    [data-theme="light"] {
      --primary: #ff4500;
      --primary-dark: #e03d00;
      --primary-light: #ff6a33;
      --secondary: #f0f0f0;
      --dark: #f5f5f5;
      --light: #111;
      --gray: #666;
      --card-bg: #ffffff;
      --card-hover: #f0f0f0;
      --text-color: #111;
      --bg-color: #f5f5f5;
      --nav-bg: #ffffff;
      --border-color: #ddd;
      --input-bg: #ffffff;
      --danger: #dc3545;
      --danger-dark: #bd2130;
      --success: #28a745;
      --info: #17a2b8;
      --warning: #ffc107;
      --easy: #28a745;
      --medium: #ffc107;
      --hard: #dc3545;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      overflow-x: hidden;
      transition: background-color 0.3s, color 0.3s;
    }
    
    /* Навигация */
    nav {
      background: var(--nav-bg);
      padding: 15px 0;
      border-bottom: 2px solid var(--primary);
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s, border-color 0.3s;
    }
    
    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      color: var(--primary);
      text-decoration: none;
      transition: transform 0.3s;
    }
    
    .logo:hover {
      transform: scale(1.05);
    }
    
    .logo i {
      margin-right: 10px;
      font-size: 28px;
    }
    
    .nav-links {
      display: flex;
      list-style: none;
      align-items: center;
    }
    
    .nav-links li {
      margin-left: 15px;
      position: relative;
    }
    
    .nav-links a {
      text-decoration: none;
      color: var(--text-color);
      font-weight: 600;
      transition: 0.3s;
      padding: 5px 0;
      position: relative;
    }
    
    .nav-links a:hover,
    .nav-links a.active {
      color: var(--primary);
    }
    
    .nav-links a.active::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 2px;
      background: var(--primary);
    }
    
    .language-switcher {
      display: flex;
      margin-left: 10px;
      gap: 5px;
    }
    
    .lang-btn {
      background: rgba(0, 0, 0, 0.1);
      border: none;
      color: var(--text-color);
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 12px;
    }
    
    .lang-btn:hover {
      background: rgba(0, 0, 0, 0.2);
    }
    
    .lang-btn.active {
      background: var(--primary);
      color: white;
    }
      
    .theme-switcher {
      margin-left: 15px;
      cursor: pointer;
      width: 40px;
      height: 20px;
      background: var(--card-bg);
      border-radius: 10px;
      position: relative;
      display: flex;
      align-items: center;
      padding: 2px;
      transition: background 0.3s;
    }
    
    .theme-switcher::before {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--primary);
      transition: transform 0.3s;
    }
    
    [data-theme="light"] .theme-switcher::before {
      transform: translateX(20px);
    }
    
    .theme-icon {
      font-size: 12px;
      margin: 0 5px;
      z-index: 1;
    }
    
    .theme-icon.sun {
      color: var(--text-color);
    }
    
    .theme-icon.moon {
      color: var(--text-color);
      margin-left: auto;
    }

    /* Мобильное меню */
    .menu-toggle {
      display: none;
      flex-direction: column;
      cursor: pointer;
      padding: 5px;
    }

    .menu-toggle span {
      width: 25px;
      height: 3px;
      background: var(--text-color);
      margin: 3px 0;
      transition: 0.3s;
    }
    
    /* Главный баннер */
     .hero {
      height: 500px;
      background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                 url('https://images.unsplash.com/photo-1757923028479-821ade5e2aef?q=80&w=1057&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D') 
                 no-repeat center center/cover;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 20px;
    }
    
    .hero-content {
      max-width: 800px;
    }
    
    .hero-content h1 {
      font-size: 48px;
      margin-bottom: 20px;
      color: var(--primary);
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.8);
      animation: fadeInDown 1s;
    }
    
    .hero-content p {
      font-size: 20px;
      margin-bottom: 30px;
      color: #eee;
      animation: fadeInUp 1s;
    }
    
    .hero-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      animation: fadeIn 1.5s;
    }
    
    .btn {
      display: inline-block;
      padding: 12px 30px;
      background: var(--primary);
      color: #fff;
      text-decoration: none;
      font-weight: bold;
      border-radius: 6px;
      transition: 0.3s;
      border: none;
      cursor: pointer;
    }
    
    .btn:hover {
      background: var(--primary-dark);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(255, 69, 0, 0.4);
    }
    
    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary);
      color: var(--primary);
    }
    
    .btn-outline:hover {
      background: var(--primary);
      color: #fff;
    }
    
    .btn-danger {
      background: var(--danger);
    }
    
    .btn-danger:hover {
      background: var(--danger-dark);
    }
    
    .btn-success {
      background: var(--success);
    }
    
    .btn-info {
      background: var(--info);
    }
    
    /* Уведомления */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 5px;
      color: white;
      z-index: 1000;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
    }
    
    .notification.show {
      opacity: 1;
      transform: translateX(0);
    }
    
    .notification.error {
      background-color: var(--danger);
    }
    
    .notification.success {
      background-color: var(--success);
    }
    
    .notification.info {
      background-color: var(--info);
    }
    
    /* Уведомления */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 5px;
      color: white;
      z-index: 1000;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .notification.show {
      opacity: 1;
      transform: translateX(0);
    }
    
    .notification.error {
      background-color: var(--danger);
    }
    
    .notification.success {
      background-color: var(--success);
    }
    
    .notification.info {
      background-color: var(--info);
    }
    
    /* Секции */
    section {
      display: none;
      padding: 60px 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    section.active {
      display: block;
      animation: fadeIn 0.5s;
    }
    
    .section-title {
      text-align: center;
      font-size: 36px;
      margin-bottom: 40px;
      color: var(--text-color);
      position: relative;
      padding-bottom: 15px;
    }
    
    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 4px;
      background: var(--primary);
      border-radius: 2px;
    }
    
    /* Поиск и фильтры */
    .search-filters {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .search-box {
      display: flex;
      margin-bottom: 15px;
    }
    
    .search-box input {
      flex: 1;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 4px 0 0 4px;
      background: var(--input-bg);
      color: var(--text-color);
      font-size: 16px;
    }
    
    .search-box button {
      padding: 0 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 0 4px 4px 0;
      cursor: pointer;
    }
    
    .advanced-filters {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }
    
    .filter-group {
      margin-bottom: 15px;
    }
    
    .filter-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: var(--text-color);
    }
    
    .filter-group select,
    .filter-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      background: var(--input-bg);
      color: var(--text-color);
    }
    
    /* Сетка видео */
    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }
    
    .video-card {
      background: var(--card-bg);
      border-radius: 8px;
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
    }
    
    .video-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      background: var(--card-hover);
    }
    
    .video-actions {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 5;
      display: flex;
      gap: 10px;
    }
    
    .video-card:hover .video-actions {
      display: flex;
    }
    
    .action-btn {
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .action-btn:hover {
      background: var(--primary);
      transform: scale(1.1);
    }
    
    .favorited {
      color: gold;
    }
    
    .video-thumb {
      height: 180px;
      background-color: #222;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    .video-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }
    
    .video-thumb:hover img {
      transform: scale(1.05);
    }
    
    .play-icon {
      position: absolute;
      font-size: 60px;
      color: rgba(255, 255, 255, 0.9);
      transition: 0.3s;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }
    
    .video-thumb:hover .play-icon {
      color: var(--primary);
      transform: scale(1.1);
    }
    
    .video-duration {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 14px;
    }
    
    .video-info {
      padding: 15px;
    }
    
    .video-title {
      font-size: 18px;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--text-color);
    }
    
    .video-meta {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      font-size: 14px;
      margin-bottom: 10px;
    }
    
    .video-stats {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      color: var(--gray);
      font-size: 14px;
      border-top: 1px solid var(--border-color);
      padding-top: 15px;
    }
    
    .video-stat {
      display: flex;
      align-items: center;
    }
    
    .video-stat i {
      margin-right: 5px;
    }
    
    /* Категории */
    .categories {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .category-btn {
      padding: 8px 20px;
      background: var(--card-bg);
      color: var(--text-color);
      border: none;
      border-radius: 20px;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .category-btn:hover,
    .category-btn.active {
      background: var(--primary);
    }
    
    /* Форма загрузки видео */
    .upload-form {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 8px;
      max-width: 600px;
      margin: 0 auto;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text-color);
    }
    
    .form-control {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      background: var(--input-bg);
      color: var(--text-color);
      font-size: 16px;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--primary);
    }
    
    textarea.form-control {
      min-height: 100px;
      resize: vertical;
    }
    
    .file-upload {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 2px dashed var(--border-color);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
      margin-bottom: 20px;
    }
    
    .file-upload:hover {
      border-color: var(--primary);
    }
    
    .file-upload i {
      font-size: 40px;
      color: var(--primary);
      margin-bottom: 10px;
    }
    
    .upload-types {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .upload-type-btn {
      flex: 1;
      padding: 12px;
      background: var(--input-bg);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      color: var(--text-color);
      cursor: pointer;
      transition: 0.3s;
    }
    
    .upload-type-btn.active {
      background: var(--primary);
      border-color: var(--primary);
    }
    
    /* Коллекции */
    .collections-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }
    
    .collection-card {
      background: var(--card-bg);
      border-radius: 8px;
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      cursor: pointer;
    }
    
    .collection-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    /* Стили для кнопки удаления коллекции */
    .collection-actions {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 10px;
      z-index: 5;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .collection-card:hover .collection-actions {
      opacity: 1;
    }
    
    .collection-action-btn {
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .collection-action-btn:hover {
      background: var(--danger);
      transform: scale(1.1);
    }
    
    .collection-thumb {
      height: 150px;
      background-color: #222;
      position: relative;
      overflow: hidden;
    }
    
    .collection-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .collection-count {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
    }
    
    .collection-info {
      padding: 15px;
    }
    
    .collection-title {
      font-size: 18px;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--text-color);
    }
    
    .collection-desc {
      color: var(--gray);
      font-size: 14px;
      margin-bottom: 15px;
    }
    
    .collection-meta {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      font-size: 12px;
    }
    
    /* Панель администратора */
    .admin-panel {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 8px;
      max-width: 800px;
      margin: 0 auto;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .admin-video-list {
      margin-top: 20px;
    }
    
    .admin-video-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .admin-video-item:last-child {
      border-bottom: none;
    }
    
    .admin-video-info {
      flex: 1;
    }
    
    .admin-video-title {
      font-weight: 600;
      margin-bottom: 5px;
      color: var(--text-color);
    }
    
    .admin-video-meta {
      font-size: 14px;
      color: var(--gray);
    }
    
    /* Модальное окно видео */
    .video-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .video-modal.active {
      display: flex;
      animation: fadeIn 0.3s;
    }
    
    .modal-content {
      background: var(--card-bg);
      width: 100%;
      max-width: 900px;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
    }
    
    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10;
      font-size: 20px;
      transition: background 0.3s;
    }
    
    .modal-close:hover {
      background: var(--primary);
    }
    
    .modal-video-container {
      width: 100%;
      position: relative;
      padding-top: 56.25%; /* 16:9 Aspect Ratio */
    }
    
    .modal-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
    
    .modal-body {
      padding: 20px;
    }
    
    .modal-title {
      font-size: 24px;
      margin-bottom: 10px;
      color: var(--text-color);
    }
    
    .modal-meta {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      margin-bottom: 15px;
    }
    
    .modal-description {
      margin-bottom: 20px;
      line-height: 1.6;
      color: var(--text-color);
    }
    
    .modal-stats {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      border-top: 1px solid var(--border-color);
      padding-top: 15px;
    }
    
    /* Модальное окно подтверждения удаления */
    .confirm-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .confirm-modal.active {
      display: flex;
    }
    
    .confirm-content {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 8px;
      max-width: 500px;
      width: 100%;
      text-align: center;
    }
    
    .confirm-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }
    
    /* О сайте */
    .about-content {
      background: var(--card-bg);
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .about-content p {
      margin-bottom: 20px;
      line-height: 1.8;
      color: var(--text-color);
    }
    
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    
    .feature {
      text-align: center;
      padding: 20px;
      background: var(--input-bg);
      border-radius: 8px;
      transition: 0.3s;
    }
    
    .feature:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    
    .feature i {
      font-size: 40px;
      color: var(--primary);
      margin-bottom: 15px;
    }
    
    .feature h3 {
      margin-bottom: 10px;
      color: var(--primary);
    }
    
    /* Футер */
    footer {
      background: var(--nav-bg);
      padding: 40px 20px;
      text-align: center;
      margin-top: 60px;
      border-top: 2px solid var(--primary);
      transition: background-color 0.3s;
    }
    
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .social-links {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    
    .social-links a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--card-bg);
      color: var(--text-color);
      margin: 0 10px;
      transition: 0.3s;
    }
    
    .social-links a:hover {
      background: var(--primary);
      transform: translateY(-3px);
    }
    
    .copyright {
      color: var(--gray);
      margin-top: 20px;
    }
    
    /* Бейджи сложности */
    .difficulty-badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .difficulty-easy {
      background-color: var(--easy);
      color: white;
    }
    
    .difficulty-medium {
      background-color: var(--medium);
      color: #333;
    }
    
    .difficulty-hard {
      background-color: var(--hard);
      color: white;
    }
    
    /* Рейтинг */
    .rating {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .rating-stars {
      color: var(--warning);
    }
    
    /* Теги */
    .tags {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-top: 10px;
    }
    
    .tag {
      background: var(--primary-light);
      color: white;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 12px;
    }
    
    /* Карточка с улучшенной информацией */
    .video-details {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }
    
    .video-detail {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: var(--gray);
    }
    
    .video-detail i {
      color: var(--primary);
    }
    
    /* Анимации */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Адаптивность */
    @media (max-width: 1024px) {
      .nav-links li {
        margin-left: 12px;
      }
      
      .hero-content h1 {
        font-size: 40px;
      }
      
      .video-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      }
    }
    
    @media (max-width: 768px) {
      .nav-container {
        flex-wrap: wrap;
      }
      
      .menu-toggle {
        display: flex;
      }
      
      .nav-links {
        position: fixed;
        top: 72px;
        left: -100%;
        width: 80%;
        height: calc(100vh - 72px);
        background: var(--nav-bg);
        flex-direction: column;
        padding: 20px;
        transition: 0.3s;
        z-index: 99;
      }
      
      .nav-links.active {
        left: 0;
      }
      
      .nav-links li {
        margin: 15px 0;
      }
      
      .language-switcher {
        margin: 15px 0 0 0;
        justify-content: center;
      }
      
      .theme-switcher {
        margin: 15px auto;
      }
      
      .hero-content h1 {
        font-size: 36px;
      }
      
      .hero-content p {
        font-size: 18px;
      }
      
      .hero-buttons {
        flex-direction: column;
      }
      
      .video-grid {
        grid-template-columns: 1fr;
      }
      
      .collections-container {
        grid-template-columns: 1fr;
      }
      
      .upload-types {
        flex-direction: column;
      }
      
      .advanced-filters {
        grid-template-columns: 1fr;
      }
      
      .admin-video-item {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .admin-video-item .btn {
        margin-top: 10px;
        align-self: flex-end;
      }
    }
    
    @media (max-width: 480px) {
      .nav-container {
        padding: 0 15px;
      }
      
      .logo {
        font-size: 20px;
      }
      
      .logo i {
        font-size: 24px;
      }
      
      .hero {
        height: 400px;
      }
      
      .hero-content h1 {
        font-size: 32px;
      }
      
      .hero-content p {
        font-size: 16px;
      }
      
      .section-title {
        font-size: 28px;
      }
      
      .search-filters,
      .upload-form,
      .admin-panel,
      .about-content {
        padding: 20px;
      }
      
      .video-info,
      .collection-info {
        padding: 12px;
      }
      
      .video-title,
      .collection-title {
        font-size: 16px;
      }
      
      .modal-body {
        padding: 15px;
      }
      
      .modal-title {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>

  <!-- Навигация -->
  <nav>
    <div class="nav-container">
      <a href="#" class="logo" onclick="showSection('home'); return false;">
        <i class="fas fa-bomb"></i>
        <span data-translate="logo">NadeSpot</span>
      </a>
      
      <div class="menu-toggle" id="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
      </div>
      
      <ul class="nav-links" id="nav-links">
        <li><a href="#" class="active" data-section="home" data-translate="nav_home">Главная</a></li>
        <li><a href="#" data-section="videos" data-translate="nav_videos">Видео</a></li>
        <li><a href="#" data-section="collections" data-translate="nav_collections">Коллекции</a></li>
        <li><a href="#" data-section="upload" data-translate="nav_upload">Загрузить</a></li>
        <li><a href="#" data-section="admin" data-translate="nav_admin">Управление</a></li>
        <li><a href="#" data-section="about" data-translate="nav_about">О сайте</a></li>
        
        <li>
          <div class="language-switcher">
            <button class="lang-btn active" data-lang="ru">RU</button>
            <button class="lang-btn" data-lang="uk">UA</button>
            <button class="lang-btn" data-lang="en">EN</button>
          </div>
        </li>
        
        <li>
          <div class="theme-switcher" id="theme-switcher">
            <i class="fas fa-sun theme-icon sun"></i>
            <i class="fas fa-moon theme-icon moon"></i>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Уведомления -->
  <div class="notification" id="notification"></div>

  <!-- Главная -->
  <section id="home" class="active">
    <div class="hero">
      <div class="hero-content">
        <h1 class="animate__animated animate__fadeInDown" data-translate="hero_title">Лучшие гранаты в CS2</h1>
        <p class="animate__animated animate__fadeInUp" data-translate="hero_text">Изучайте, практикуйте и совершенствуйте свои навыки владения гранатами</p>
        <div class="hero-buttons">
          <a href="#" class="btn" data-section="videos" data-translate="hero_btn_watch">Смотреть гранаты</a>
          <a href="#" class="btn btn-outline" data-section="upload" data-translate="hero_btn_upload">Загрузить видео</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Видео -->
  <section id="videos">
    <h2 class="section-title" data-translate="videos_title">Популярные гранаты</h2>
    
    <div class="search-filters">
      <div class="search-box">
        <input type="text" id="search-input" data-placeholder="search_placeholder" placeholder="Поиск по названию, карте или описанию...">
        <button onclick="searchVideos()"><i class="fas fa-search"></i></button>
      </div>
      
      <div class="advanced-filters">
        <div class="filter-group">
          <label for="filter-category" data-translate="filter_category">Категория</label>
          <select id="filter-category" onchange="filterVideos()">
            <option value="all" data-translate="filter_all">Все категории</option>
            <option value="smoke" data-translate="filter_smoke">Дымовые</option>
            <option value="flash" data-translate="filter_flash">Светошумовые</option>
            <option value="molotov" data-translate="filter_molotov">Зажигательные</option>
            <option value="he" data-translate="filter_he">Осколочные</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filter-map" data-translate="filter_map">Карта</label>
          <select id="filter-map" onchange="filterVideos()">
            <option value="all" data-translate="filter_all">Все карты</option>
            <option value="Mirage">Mirage</option>
            <option value="Dust2">Dust II</option>
            <option value="Ancient">Ancient</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filter-side" data-translate="filter_side">Сторона</label>
          <select id="filter-side" onchange="filterVideos()">
            <option value="all" data-translate="filter_both">Обе стороны</option>
            <option value="CT" data-translate="filter_ct">Контр-террористы</option>
            <option value="T" data-translate="filter_t">Террористы</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filter-difficulty" data-translate="filter_difficulty">Сложность</label>
          <select id="filter-difficulty" onchange="filterVideos()">
            <option value="all" data-translate="filter_all">Любая</option>
            <option value="easy" data-translate="upload_difficulty_easy">Легкая</option>
            <option value="medium" data-translate="upload_difficulty_medium">Средняя</option>
            <option value="hard" data-translate="upload_difficulty_hard">Сложная</option>
          </select>
        </div>
      </div>
    </div>
    
    <div class="categories">
      <button class="category-btn active" data-filter="all" data-translate="filter_all">Все</button>
      <button class="category-btn" data-filter="smoke" data-translate="filter_smoke">Дымовые</button>
      <button class="category-btn" data-filter="flash" data-translate="filter_flash">Светошумовые</button>
      <button class="category-btn" data-filter="molotov" data-translate="filter_molotov">Зажигательные</button>
      <button class="category-btn" data-filter="he" data-translate="filter_he">Осколочные</button>
    </div>
    
    <div class="video-grid" id="video-container">
      <!-- Видео будут добавляться динамически -->
    </div>
  </section>

  <!-- Коллекции -->
  <section id="collections">
    <h2 class="section-title" data-translate="collections_title">Мои коллекции</h2>
    
    <div class="hero-buttons" style="justify-content: center; margin-bottom: 30px;">
      <button class="btn" onclick="createNewCollection()">
        <i class="fas fa-plus"></i> <span data-translate="collections_create">Создать коллекцию</span>
      </button>
      <button class="btn btn-info" data-section="favorites">
        <i class="fas fa-star"></i> <span data-translate="collections_favorites">Избранное</span>
      </button>
    </div>
    
    <div class="collections-container" id="collections-container">
      <!-- Коллекции будут добавляться динамически -->
    </div>

    <!-- View for a single collection (hidden by default) -->
    <div id="collection-view" style="display:none; margin-top:30px;">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <div>
          <button class="btn" id="collection-back-btn" onclick="closeCollectionView()" style="display:none;">
            <span data-translate="collections_back">← Назад к коллекциям</span>
          </button>
        </div>
        <div id="collection-view-title" style="font-weight:700; font-size:18px;"></div>
        <div></div>
      </div>
      <div id="collection-videos-container" class="video-grid"></div>
    </div>
  </section>

  <!-- Избранное -->
  <section id="favorites">
    <h2 class="section-title" data-translate="favorites_title">Избранные гранаты</h2>
    
    <div class="video-grid" id="favorites-container">
      <!-- Избранные видео будут добавляться динамически -->
    </div>
  </section>

  <!-- Загрузка видео -->
  <section id="upload">
    <h2 class="section-title" data-translate="upload_title">Загрузить видео</h2>
    
    <div class="upload-form">
      <div class="upload-types">
        <button class="upload-type-btn active" data-type="file" data-translate="upload_type_file">Файл видео</button>
        <button class="upload-type-btn" data-type="youtube" data-translate="upload_type_youtube">YouTube ссылка</button>
      </div>
      
      <div id="file-upload-section">
        <div class="file-upload" id="drop-zone">
          <i class="fas fa-cloud-upload-alt"></i>
          <p data-translate="upload_drag">Перетащите видеофайл сюда или</p>
          <label for="video-file" class="btn" data-translate="upload_select">Выбрать файл</label>
          <input type="file" id="video-file" accept="video/*" style="display: none;">
        </div>
      </div>
      
      <div id="youtube-upload-section" style="display: none;">
        <div class="form-group">
          <label for="youtube-url" data-translate="upload_youtube_label">Ссылка на YouTube видео</label>
          <input type="url" id="youtube-url" class="form-control" data-placeholder="upload_youtube_placeholder" placeholder="https://www.youtube.com/watch?v=...">
        </div>
      </div>
      
      <div class="form-group">
        <label for="video-title" data-translate="upload_title_label">Название видео</label>
        <input type="text" id="video-title" class="form-control" data-placeholder="upload_title_placeholder" placeholder="Введите название видео">
      </div>
      
      <div class="form-group">
        <label for="video-category" data-translate="upload_category_label">Категория гранаты</label>
        <select id="video-category" class="form-control">
          <option value="" data-translate="upload_category_select">Выберите категорию</option>
          <option value="smoke" data-translate="filter_smoke">Дымовая</option>
          <option value="flash" data-translate="filter_flash">Светошумовая</option>
          <option value="molotov" data-translate="filter_molotov">Зажигательная</option>
          <option value="he" data-translate="filter_he">Осколочная</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-map" data-translate="upload_map_label">Карта</label>
        <select id="video-map" class="form-control">
          <option value="" data-translate="upload_map_select">Выберите карту</option>
          <option value="Mirage">Mirage</option>
          <option value="Dust2">Dust II</option>
          <option value="Ancient">Ancient</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-side" data-translate="upload_side_label">Сторона</label>
        <select id="video-side" class="form-control">
          <option value="" data-translate="upload_side_select">Выберите сторону</option>
          <option value="CT" data-translate="filter_ct">Контр-террористы</option>
          <option value="T" data-translate="filter_t">Террористы</option>
          <option value="both" data-translate="filter_both">Обе стороны</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-difficulty" data-translate="upload_difficulty_label">Сложность</label>
        <select id="video-difficulty" class="form-control">
          <option value="" data-translate="upload_difficulty_select">Выберите сложность</option>
          <option value="easy" data-translate="upload_difficulty_easy">Легкая</option>
          <option value="medium" data-translate="upload_difficulty_medium">Средняя</option>
          <option value="hard" data-translate="upload_difficulty_hard">Сложная</option>
        </select>
      </div>

      <div class="form-group">
        <label for="video-tags" data-translate="upload_tags_label">Теги (через запятую)</label>
        <input type="text" id="video-tags" class="form-control" data-placeholder="upload_tags_placeholder" placeholder="например: A site, mid, window">
      </div>
      
      <div class="form-group">
        <label for="video-description" data-translate="upload_description_label">Описание</label>
        <textarea id="video-description" class="form-control" data-placeholder="upload_description_placeholder" placeholder="Опишите свой заброс"></textarea>
      </div>
      
      <button class="btn" style="width: 100%;" onclick="uploadVideo()" data-translate="upload_btn">Загрузить видео</button>
    </div>
  </section>

  <!-- Панель администратора -->
  <section id="admin">
    <h2 class="section-title" data-translate="admin_title">Управление видео</h2>
    
    <div class="admin-panel">
      <p data-translate="admin_description">Здесь вы можете управлять загруженными видео. Для удаления видео нажмите на кнопку "Удалить".</p>
      
      <div class="admin-video-list" id="admin-video-list">
        <!-- Список видео для управления -->
      </div>
    </div>
  </section>

  <!-- Модальное окно видео -->
  <div class="video-modal" id="video-modal">
    <div class="modal-content">
      <div class="modal-close" onclick="closeVideo()">
        <i class="fas fa-times"></i>
      </div>
      <div class="modal-video-container" id="modal-video-container">
        <!-- Видео будет вставлено сюда -->
      </div>
      <div class="modal-body">
        <h3 class="modal-title" id="modal-title"></h3>
        <div class="modal-meta">
          <span id="modal-category"></span>
          <span id="modal-date"></span>
        </div>
        <p class="modal-description" id="modal-description"></p>
        <div class="modal-stats">
          <span><i class="fas fa-map-marker-alt"></i> <span id="modal-map"></span></span>
          <span><i class="fas fa-user-shield"></i> <span id="modal-side"></span></span>
          <span><i class="fas fa-signal"></i> <span id="modal-difficulty"></span></span>
        </div>
        <div class="tags" id="modal-tags"></div>
      </div>
    </div>
  </div>

  <!-- Модальное окно подтверждения удаления -->
  <div class="confirm-modal" id="confirm-modal">
    <div class="confirm-content">
      <h3 id="confirm-title" data-translate="confirm_title">Подтверждение удаления</h3>
      <p id="confirm-message" data-translate="confirm_message">Вы уверены, что хотите удалить эту коллекцию? Это действие нельзя отменить.</p>
      <div class="confirm-buttons">
        <button class="btn btn-danger" id="confirm-yes" data-translate="confirm_yes">Да, удалить</button>
        <button class="btn" id="confirm-no" data-translate="confirm_no">Отмена</button>
      </div>
    </div>
  </div>

  <!-- О сайте -->
  <section id="about">
    <h2 class="section-title" data-translate="about_title">О сайте</h2>
    
    <div class="about-content">
      <p data-translate="about_text1">
        NadeSpot — это платформа для изучения и применения гранат в Counter-Strike 2. 
        Наша цель — помочь игрокам улучшить свои навыки и тактическое мышление.
      </p>
      
      <p data-translate="about_text2">
        Здесь вы найдете тщательно отобранные видео с эффективными применениями гранат на всех популярных картах. 
        Наша команда модераторов проверяет каждый материал перед публикацией.
      </p>
      
      <div class="features">
        <div class="feature">
          <i class="fas fa-filter"></i>
          <h3 data-translate="about_feature1_title">Качественный контент</h3>
          <p data-translate="about_feature1_desc">Все видео проверяются на эффективность и актуальность</p>
        </div>
        
        <div class="feature">
          <i class="fas fa-sort-amount-down"></i>
          <h3 data-translate="about_feature2_title">Удобная категоризация</h3>
          <p data-translate="about_feature2_desc">Гранаты отсортированы по типам и картам для быстрого поиска</p>
        </div>
        
        <div class="feature">
          <i class="fas fa-map-marked-alt"></i>
          <h3 data-translate="about_feature3_title">Все карты CS2</h3>
          <p data-translate="about_feature3_desc">Гранаты для всех официальных карт</p>
        </div>
        
        <div class="feature">
          <i class="fas fa-rocket"></i>
          <h3 data-translate="about_feature4_title">Актуальные стратегии</h3>
          <p data-translate="about_feature4_desc">Мы регулярно обновляем коллекцию под текущую мету игры</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Футер -->
  <footer>
    <div class="footer-content">
      <div class="logo">
        <i class="fas fa-bomb"></i>
        <span data-translate="logo">NadeSpot</span>
      </div>
      
      <div class="social-links">
        <a href="#"><i class="fab fa-youtube"></i></a>
        <a href="#"><i class="fab fa-discord"></i></a>
      </div>
      
      <p class="copyright" data-translate="footer_copyright">NadeSpot © 2025 - Все права защищены</p>
      <p class="copyright" data-translate="footer_demo">Это демонстрационный сайт, созданный в образовательных целях</p>
    </div>
  </footer>

  <script>
    // База переводов
    const translations = {
      "ru": {
        "logo": "NadeSpot",
        "nav_home": "Главная",
        "nav_videos": "Видео",
        "nav_collections": "Коллекции",
        "nav_upload": "Загрузить",
        "nav_admin": "Управление",
        "nav_about": "О сайте",
        "hero_title": "Лучшие гранаты в CS2",
        "hero_text": "Изучайте, практикуйте и совершенствуйте свои навыки владения гранатами",
        "hero_btn_watch": "Смотреть гранаты",
        "hero_btn_upload": "Загрузить видео",
        "videos_title": "Популярные гранаты",
        "search_placeholder": "Поиск по названию, карте или описанию...",
        "filter_category": "Категория",
        "filter_all": "Все",
        "filter_smoke": "Дымовые",
        "filter_flash": "Светошумовые",
        "filter_molotov": "Зажигательные",
        "filter_he": "Осколочные",
        "filter_map": "Карта",
        "filter_side": "Сторона",
        "filter_difficulty": "Сложность",
        "filter_both": "Обе стороны",
        "filter_ct": "Контр-террористы",
        "filter_t": "Террористы",
        "filter_sort": "Сортировка",
        "sort_newest": "Сначала новые",
        "sort_oldest": "Сначала старые",
        "sort_popular": "По популярности",
        "sort_rating": "По рейтингу",
        "collections_title": "Мои коллекции",
        "collections_create": "Создать коллекцию",
        "collections_favorites": "Избранное",
        "collections_back": "← Назад к коллекциям",
        "favorites_title": "Избранные гранаты",
        "upload_title": "Загрузить видео",
        "upload_type_youtube": "YouTube ссылка",
        "upload_drag": "Перетащите видеофайл сюда или",
        "upload_select": "Выбрать файл",
        "upload_youtube_label": "Ссылка на YouTube видео",
        "upload_youtube_placeholder": "https://www.youtube.com/watch?v=...",
        "upload_title_label": "Название видео",
        "upload_title_placeholder": "Введите название видео",
        "upload_category_label": "Категория гранаты",
        "upload_category_select": "Выберите категорию",
        "upload_map_label": "Карта",
        "upload_map_select": "Выберите карту",
        "upload_side_label": "Сторона",
        "upload_side_select": "Выберите сторону",
        "upload_difficulty_label": "Сложность",
        "upload_difficulty_select": "Выберите сложность",
        "upload_difficulty_easy": "Легкая",
        "upload_difficulty_medium": "Средняя",
        "upload_difficulty_hard": "Сложная",
        "upload_tags_label": "Теги (через запятую)",
        "upload_tags_placeholder": "например: A site, mid, window",
        "upload_description_label": "Описание",
        "upload_description_placeholder": "Опишите свой заброс",
        "upload_btn": "Загрузить видео",
        "admin_title": "Управление видео",
        "admin_description": "Здесь вы можете управлять загруженными видео. Для удаления видео нажмите на кнопку \"Удалить\".",
        "admin_delete": "Удалить",
        "modal_views": "просмотров",
        "modal_favorites": "в избранном",
        "view3d_example_meta": "Дымовая граната • Mirage",
        "view3d_example_side": "CT сторона",
        "confirm_title": "Подтверждение удаления",
        "confirm_message": "Вы уверены, что хотите удалить эту коллекцию? Это действие нельзя отменить.",
        "confirm_yes": "Да, удалить",
        "confirm_no": "Отмена",
        "about_title": "О сайте",
        "about_text1": "NadeSpot — это платформа для изучения и применения гранат в Counter-Strike 2. Наша цель — помочь игрокам улучшить свои навыки и тактическое мышление.",
        "about_text2": "Здесь вы найдете тщательно отобранные видео с эффективными применениями гранат на всех популярных картах. Наша команда модераторов проверяет каждый материал перед публикацией.",
        "about_feature1_title": "Качественный контент",
        "about_feature1_desc": "Все видео проверяются на эффективность и актуальность",
        "about_feature2_title": "Удобная категоризация",
        "about_feature2_desc": "Гранаты отсортированы по типам и картам для быстрого поиска",
        "about_feature3_title": "Все карты CS2",
        "about_feature3_desc": "Гранаты для всех официальных карт",
        "about_feature4_title": "Актуальные стратегии",
        "about_feature4_desc": "Мы регулярно обновляем коллекцию под текущую мету игры",
        "footer_copyright": "NadeSpot © 2025 - Все права защищены",
        "footer_demo": "Это демонстрационный сайт, созданный в образовательных целях",
        "notification_success": "Операция выполнена успешно!",
        "notification_error": "Произошла ошибка!",
        "notification_info": "Тема изменена",
        "no_videos": "Видео не найдены",
        "no_videos_text": "Будьте первым, кто загрузит видео с гранатой!",
        "no_favorites": "Нет избранных видео",
        "no_favorites_text": "Добавляйте видео в избранное, чтобы легко находить их позже",
        "no_collections": "Коллекций пока нет",
        "no_collections_text": "Создайте свою первую коллекцию для организации видео",
        "collection_empty": "В коллекции пока нет видео",
        "video_duration": "Длительность",
        "video_views": "просмотров",
        "video_favorites": "в избранном",
        "video_add_to_collection": "Добавить в коллекцию",
        "video_remove_from_favorites": "Удалить из избранного",
        "video_add_to_favorites": "Добавить в избранное",
        "video_rating": "Рейтинг",
        "video_side": "Сторона",
        "video_map": "Карта",
        "video_tags": "Теги",
        "grenade_molotov": "Зажигательная",
        "difficulty_hard": "СЛОЖНАЯ",
        "side_ct": "Контр-террористы"
      },
      "uk": {
        "logo": "NadeSpot",
        "nav_home": "Головна",
        "nav_videos": "Відео",
        "nav_collections": "Колекції",
        "nav_upload": "Завантажити",
        "nav_admin": "Управління",
        "nav_about": "Про сайт",
        "hero_title": "Найкращі гранати в CS2",
        "hero_text": "Вивчайте, практикуйте та вдосконалюйте свої навички володіння гранатами",
        "hero_btn_watch": "Дивитися гранати",
        "hero_btn_upload": "Завантажити відео",
        "videos_title": "Популярні гранати",
        "search_placeholder": "Пошук за назвою, картою або описом...",
        "filter_category": "Категорія",
        "filter_all": "Всі",
        "filter_smoke": "Димові",
        "filter_flash": "Світлошумові",
        "filter_molotov": "Запалювальні",
        "filter_he": "Осколкові",
        "filter_map": "Карта",
        "filter_side": "Сторона",
        "filter_difficulty": "Складність",
        "filter_both": "Обидві сторони",
        "filter_ct": "Контр-терористи",
        "filter_t": "Терористи",
        "filter_sort": "Сортування",
        "sort_newest": "Спочатку нові",
        "sort_oldest": "Спочатку старі",
        "sort_popular": "За популярністю",
        "sort_rating": "За рейтингом",
        "collections_title": "Мої колекції",
        "collections_create": "Створити колекцію",
        "collections_favorites": "Обране",
        "collections_back": "← Назад до колекцій",
        "favorites_title": "Обрані гранати",
        "upload_title": "Завантажити відео",
        "upload_type_youtube": "YouTube посилання",
        "upload_drag": "Перетягніть відеофайл сюди або",
        "upload_select": "Обрати файл",
        "upload_youtube_label": "Посилання на YouTube відео",
        "upload_youtube_placeholder": "https://www.youtube.com/watch?v=...",
        "upload_title_label": "Назва відео",
        "upload_title_placeholder": "Введіть назву відео",
        "upload_category_label": "Категорія гранати",
        "upload_category_select": "Оберіть категорію",
        "upload_map_label": "Карта",
        "upload_map_select": "Оберіть карту",
        "upload_side_label": "Сторона",
        "upload_side_select": "Оберіть сторону",
        "upload_difficulty_label": "Складність",
        "upload_difficulty_select": "Виберіть складність",
        "upload_difficulty_easy": "Легка",
        "upload_difficulty_medium": "Середня",
        "upload_difficulty_hard": "Складна",
        "upload_tags_label": "Теги (через кому)",
        "upload_tags_placeholder": "наприклад: A site, mid, window",
        "upload_description_label": "Опис",
        "upload_description_placeholder": "Опишіть свій кидок",
        "upload_btn": "Завантажити відео",
        "admin_title": "Управління відео",
        "admin_description": "Тут ви можете керувати завантаженими відео. Для видалення відео натисніть кнопку \"Видалити\".",
        "admin_delete": "Видалити",
        "modal_views": "переглядів",
        "modal_favorites": "в обраному",
        "view3d_example_meta": "Димова граната • Mirage",
        "view3d_example_side": "CT сторона",
        "confirm_title": "Підтвердження видалення",
        "confirm_message": "Ви впевнені, що хочете видалити цю колекцію? Цю дію не можна скасувати.",
        "confirm_yes": "Так, видалити",
        "confirm_no": "Скасувати",
        "about_title": "Про сайт",
        "about_text1": "NadeSpot — це платформа для вивчення та застосування гранат у Counter-Strike 2. Наша мета — допомогти гравцям покращити свої навички та тактичне мислення.",
        "about_text2": "Тут ви знайдете ретельно відібрані відео з ефективними застосуваннями гранат на всіх популярних картах. Наша команда модераторів перевіряє кожен матеріал перед публікацією.",
        "about_feature1_title": "Якісний контент",
        "about_feature1_desc": "Усі відео перевіряються на ефективність та актуальність",
        "about_feature2_title": "Зручна категорізація",
        "about_feature2_desc": "Гранати відсортовані за типами та картами для швидкого пошуку",
        "about_feature3_title": "Усі карти CS2",
        "about_feature3_desc": "Гранати для всіх офіційних карт",
        "about_feature4_title": "Актуальні стратегії",
        "about_feature4_desc": "Ми регулярно оновлюємо колекцію під поточну мету гри",
        "footer_copyright": "NadeSpot © 2025 - Всі права захищені",
        "footer_demo": "Це демонстраційний сайт, створений в освітніх цілях",
        "notification_success": "Операція успішно виконана!",
        "notification_error": "Сталася помилка!",
        "notification_info": "Тема змінена",
        "no_videos": "Відео не знайдено",
        "no_videos_text": "Будьте першим, хто завантажить відео з гранатою!",
        "no_favorites": "Немає обраних відео",
        "no_favorites_text": "Додавайте відео в обране, щоб легко знаходити їх пізніше",
        "no_collections": "Колекцій поки немає",
        "no_collections_text": "Створіть свою першу колекцію для організації відео",
        "collection_empty": "У колекції поки немає відео",
        "video_duration": "Тривалість",
        "video_views": "переглядів",
        "video_favorites": "в обраному",
        "video_add_to_collection": "Додати до колекції",
        "video_remove_from_favorites": "Видалити з обраного",
        "video_add_to_favorites": "Додати в обране",
        "video_rating": "Рейтинг",
        "video_side": "Сторона",
        "video_map": "Карта",
        "video_tags": "Теги",
        "grenade_molotov": "Запалювальна",
        "difficulty_hard": "СКЛАДНА",
        "side_ct": "Контр-терористи"
      },
      "en": {
        "logo": "NadeSpot",
        "nav_home": "Home",
        "nav_videos": "Videos",
        "nav_collections": "Collections",
        "nav_upload": "Upload",
        "nav_admin": "Management",
        "nav_about": "About",
        "hero_title": "Best grenades in CS2",
        "hero_text": "Study, practice and improve your grenade skills",
        "hero_btn_watch": "Watch grenades",
        "hero_btn_upload": "Upload video",
        "videos_title": "Popular grenades",
        "search_placeholder": "Search by name, map or description...",
        "filter_category": "Category",
        "filter_all": "All",
        "filter_smoke": "Smoke",
        "filter_flash": "Flash",
        "filter_molotov": "Molotov",
        "filter_he": "HE Grenade",
        "filter_map": "Map",
        "filter_side": "Side",
        "filter_difficulty": "Difficulty",
        "filter_both": "Both sides",
        "filter_ct": "Counter-Terrorists",
        "filter_t": "Terrorists",
        "filter_sort": "Sort by",
        "sort_newest": "Newest first",
        "sort_oldest": "Oldest first",
        "sort_popular": "By popularity",
        "sort_rating": "By rating",
        "collections_title": "My collections",
        "collections_create": "Create collection",
        "collections_favorites": "Favorites",
        "collections_back": "← Back to collections",
        "favorites_title": "Favorite grenades",
        "upload_title": "Upload video",
        "upload_type_youtube": "YouTube link",
        "upload_drag": "Drag video file here or",
        "upload_select": "Select file",
        "upload_youtube_label": "YouTube video link",
        "upload_youtube_placeholder": "https://www.youtube.com/watch?v=...",
        "upload_title_label": "Video title",
        "upload_title_placeholder": "Enter video title",
        "upload_category_label": "Grenade category",
        "upload_category_select": "Select category",
        "upload_map_label": "Map",
        "upload_map_select": "Select map",
        "upload_side_label": "Side",
        "upload_side_select": "Select side",
        "upload_difficulty_label": "Difficulty",
        "upload_difficulty_select": "Select difficulty",
        "upload_difficulty_easy": "Easy",
        "upload_difficulty_medium": "Medium",
        "upload_difficulty_hard": "Hard",
        "upload_tags_label": "Tags (comma separated)",
        "upload_tags_placeholder": "e.g.: A site, mid, window",
        "upload_description_label": "Description",
        "upload_description_placeholder": "Describe your throw",
        "upload_btn": "Upload video",
        "admin_title": "Video management",
        "admin_description": "Here you can manage uploaded videos. To delete a video, click the \"Delete\" button.",
        "admin_delete": "Delete",
        "modal_views": "views",
        "modal_favorites": "favorites",
        "view3d_example_meta": "Smoke grenade • Mirage",
        "view3d_example_side": "CT side",
        "confirm_title": "Delete confirmation",
        "confirm_message": "Are you sure you want to delete this collection? This action cannot be undone.",
        "confirm_yes": "Yes, delete",
        "confirm_no": "Cancel",
        "about_title": "About",
        "about_text1": "NadeSpot is a platform for learning and using grenades in Counter-Strike 2. Our goal is to help players improve their skills and tactical thinking.",
        "about_text2": "Here you will find carefully selected videos with effective grenade uses on all popular maps. Our team of moderators checks each material before publication.",
        "about_feature1_title": "Quality content",
        "about_feature1_desc": "All videos are checked for effectiveness and relevance",
        "about_feature2_title": "Convenient categorization",
        "about_feature2_desc": "Grenades are sorted by types and maps for quick search",
        "about_feature3_title": "All CS2 maps",
        "about_feature3_desc": "Grenades for all official maps",
        "about_feature4_title": "Relevant strategies",
        "about_feature4_desc": "We regularly update the collection for the current game meta",
        "footer_copyright": "NadeSpot © 2025 - All rights reserved",
        "footer_demo": "This is a demo site created for educational purposes",
        "notification_success": "Operation completed successfully!",
        "notification_error": "An error has occurred!",
        "notification_info": "Theme changed",
        "no_videos": "No videos found",
        "no_videos_text": "Be the first to upload a grenade video!",
        "no_favorites": "No favorite videos",
        "no_favorites_text": "Add videos to favorites to easily find them later",
        "no_collections": "No collections yet",
        "no_collections_text": "Create your first collection to organize videos",
        "collection_empty": "No videos in collection yet",
        "video_duration": "Duration",
        "video_views": "views",
        "video_favorites": "favorites",
        "video_add_to_collection": "Add to collection",
        "video_remove_from_favorites": "Remove from favorites",
        "video_add_to_favorites": "Add to favorites",
        "video_difficulty": "Difficulty",
        "video_side": "Side",
        "video_map": "Map",
        "video_tags": "Tags",
        "grenade_molotov": "Molotov",
        "difficulty_hard": "HARD",
        "side_ct": "Counter-Terrorists"
      }
    };

    // Функция для применения перевода
    function applyLanguage(lang) {
      document.documentElement.lang = lang;
      const elements = document.querySelectorAll('[data-translate]');
      elements.forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang] && translations[lang][key]) {
          element.textContent = translations[lang][key];
        }
      });
      const placeholders = document.querySelectorAll('[data-placeholder]');
      placeholders.forEach(element => {
        const key = element.getAttribute('data-placeholder');
        if (translations[lang] && translations[lang][key]) {
          element.setAttribute('placeholder', translations[lang][key]);
        }
      });
      document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.getAttribute('data-lang') === lang) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
      
      // МГНОВЕННО перерисовываем контент с новым языком
      const activeSection = Array.from(document.querySelectorAll('section')).find(s => s.classList.contains('active'));
      if (activeSection) {
        const sectionId = activeSection.id;
        const currentLang = lang;
        
        if (sectionId === 'videos') {
          renderVideos(currentLang);
        } else if (sectionId === 'collections') {
          renderCollections(currentLang);
        } else if (sectionId === 'admin') {
          renderAdminPanel(currentLang);
        } else if (sectionId === 'favorites') {
          renderFavorites(currentLang);
        }
      }
      
      saveSetting('preferredLanguage', lang);
    }

    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      saveSetting('preferredTheme', newTheme);
      const lang = document.documentElement.lang || 'ru';
      showNotification(translations[lang]['notification_info'], 'info');
    }

    // Инициализация IndexedDB
    let db;
    const dbName = 'NadeSpotDB';
    const dbVersion = 1;

    // Инициализация базы данных
    function initDB() {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open(dbName, dbVersion);
        request.onerror = event => {
          console.error('IndexedDB error:', event.target.error);
          reject(event.target.error);
        };
        request.onsuccess = event => {
          db = event.target.result;
          resolve(db);
        };
        request.onupgradeneeded = event => {
          const idb = event.target.result;
          if (!idb.objectStoreNames.contains('videos')) {
            const videoStore = idb.createObjectStore('videos', { keyPath: 'id' });
            videoStore.createIndex('category', 'category', { unique: false });
            videoStore.createIndex('map', 'map', { unique: false });
          }
          if (!idb.objectStoreNames.contains('collections')) {
            const collectionStore = idb.createObjectStore('collections', { keyPath: 'id' });
            collectionStore.createIndex('name', 'name', { unique: false });
          }
          if (!idb.objectStoreNames.contains('favorites')) {
            idb.createObjectStore('favorites', { keyPath: 'id' });
          }
          if (!idb.objectStoreNames.contains('settings')) {
            idb.createObjectStore('settings', { keyPath: 'key' });
          }
        };
      });
    }

    async function saveSetting(key, value) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['settings'], 'readwrite');
        const store = transaction.objectStore('settings');
        const request = store.put({ key, value });
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function getSetting(key, defaultValue = null) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['settings'], 'readonly');
        const store = transaction.objectStore('settings');
        const request = store.get(key);
        request.onsuccess = () => resolve(request.result ? request.result.value : defaultValue);
        request.onerror = () => reject(request.error);
      });
    }

    async function getAllVideos() {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['videos'], 'readonly');
        const store = transaction.objectStore('videos');
        const request = store.getAll();
        request.onsuccess = () => resolve(request.result || []);
        request.onerror = () => reject(request.error);
      });
    }

    async function saveVideo(video) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['videos'], 'readwrite');
        const store = transaction.objectStore('videos');
        const request = store.put(video);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function deleteVideoFromDB(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['videos'], 'readwrite');
        const store = transaction.objectStore('videos');
        const request = store.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function getAllCollections() {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['collections'], 'readonly');
        const store = transaction.objectStore('collections');
        const request = store.getAll();
        request.onsuccess = () => resolve(request.result || []);
        request.onerror = () => reject(request.error);
      });
    }

    async function saveCollection(collection) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['collections'], 'readwrite');
        const store = transaction.objectStore('collections');
        const request = store.put(collection);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function deleteCollectionFromDB(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['collections'], 'readwrite');
        const store = transaction.objectStore('collections');
        const request = store.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function getAllFavorites() {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['favorites'], 'readonly');
        const store = transaction.objectStore('favorites');
        const request = store.getAll();
        request.onsuccess = () => resolve((request.result || []).map(f => f.id));
        request.onerror = () => reject(request.error);
      });
    }

    async function addFavorite(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['favorites'], 'readwrite');
        const store = transaction.objectStore('favorites');
        const request = store.put({ id });
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function removeFavorite(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['favorites'], 'readwrite');
        const store = transaction.objectStore('favorites');
        const request = store.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    // Инициализация UI при загрузке
    document.addEventListener('DOMContentLoaded', async function() {
      await initDB();
      const savedLanguage = await getSetting('preferredLanguage');
      const savedTheme = await getSetting('preferredTheme', 'dark');
      const browserLanguage = navigator.language.substring(0, 2);
      if (savedLanguage) applyLanguage(savedLanguage);
      else if (browserLanguage in translations) applyLanguage(browserLanguage);
      else applyLanguage('ru');
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      const lang = document.documentElement.lang || 'ru';
      await renderVideos(lang);
      await renderCollections(lang);
      
      // Обработчики для навигации
      document.getElementById('menu-toggle').addEventListener('click', function() {
        document.getElementById('nav-links').classList.toggle('active');
      });
      
      // Обработчики для навигационных ссылок
      document.querySelectorAll('nav a, .btn, .hero-buttons a').forEach(element => {
        if (element.hasAttribute('data-section')) {
          element.addEventListener('click', function(e) {
            e.preventDefault();
            const sectionId = this.getAttribute('data-section');
            showSection(sectionId);
          });
        }
      });
      
      // Обработчики для переключения языка
      document.querySelectorAll('.lang-btn').forEach(button => {
        button.addEventListener('click', function() {
          const lang = this.getAttribute('data-lang');
          applyLanguage(lang);
        });
      });
      
      // Обработчик для переключения темы
      document.getElementById('theme-switcher').addEventListener('click', toggleTheme);
    });

    // Переменные состояния
    let currentUploadType = 'file';
    let isAdminMode = false;
    let currentDeletion = { type: null, id: null };

    // Уведомления
    function showNotification(message, type = 'success') {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.className = `notification ${type} show`;
      setTimeout(() => {
        notification.classList.remove('show');
      }, 2500);
    }

    // Проверка дубликатов
    async function isDuplicateVideo(videoData) {
      const videos = await getAllVideos();
      return videos.some(video => {
        if (videoData.type === 'youtube' && video.type === 'youtube') {
          return video.src === videoData.src;
        }
        if (videoData.type === 'file' && video.type === 'file') {
          return video.title === videoData.title && video.category === videoData.category;
        }
        return false;
      });
    }

    // Показать/скрыть секции
    async function showSection(id) {
      document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
      const el = document.getElementById(id);
      if (el) el.classList.add("active");

      // Обновление активной ссылки в навигации
      document.querySelectorAll("nav a").forEach(a => a.classList.remove("active"));
      const navLink = Array.from(document.querySelectorAll("nav a")).find(a => {
        return a.getAttribute('data-section') === id;
      });
      if (navLink) navLink.classList.add('active');

      // Закрытие мобильного меню
      document.getElementById('nav-links').classList.remove('active');
      
      // Прокрутка к началу страницы
      window.scrollTo(0, 0);

      const lang = document.documentElement.lang || 'ru';

      // Обновление контента в зависимости от раздела
      if (id === 'videos') {
        isAdminMode = false;
        await renderVideos(lang);
      } else if (id === 'admin') {
        isAdminMode = true;
        await renderAdminPanel(lang);
      } else if (id === 'collections') {
        await renderCollections(lang);
      } else if (id === 'favorites') {
        await renderFavorites(lang);
      }
    }

    document.querySelectorAll('.upload-type-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.upload-type-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        currentUploadType = this.getAttribute('data-type');
        document.getElementById('file-upload-section').style.display =
          currentUploadType === 'file' ? 'block' : 'none';
        document.getElementById('youtube-upload-section').style.display =
          currentUploadType === 'youtube' ? 'block' : 'none';
      });
    });

    // File input preview text
    document.getElementById('video-file').addEventListener('change', function(e) {
      if (e.target.files.length > 0) {
        const fileName = e.target.files[0].name;
        document.querySelector('#drop-zone p').textContent = `Выбран файл: ${fileName}`;
      }
    });

    const dropZone = document.getElementById('drop-zone');
    dropZone.addEventListener('dragover', function(e) {
      e.preventDefault();
      this.style.borderColor = 'var(--primary)';
      this.style.backgroundColor = 'rgba(255, 69, 0, 0.1)';
    });
    dropZone.addEventListener('dragleave', function() {
      this.style.borderColor = 'var(--border-color)';
      this.style.backgroundColor = 'transparent';
    });
    dropZone.addEventListener('drop', function(e) {
      e.preventDefault();
      this.style.borderColor = 'var(--border-color)';
      this.style.backgroundColor = 'transparent';
      if (e.dataTransfer.files.length > 0) {
        const file = e.dataTransfer.files[0];
        if (file.type.startsWith('video/')) {
          document.getElementById('video-file').files = e.dataTransfer.files;
          document.querySelector('#drop-zone p').textContent = `Выбран файл: ${file.name}`;
        } else {
          showNotification('Пожалуйста, выберите видео файл', 'error');
        }
      }
    });

    // UploadVideo
    async function uploadVideo() {
      const title = document.getElementById('video-title').value;
      const category = document.getElementById('video-category').value;
      const map = document.getElementById('video-map').value;
      const side = document.getElementById('video-side').value;
      const difficulty = document.getElementById('video-difficulty').value;
      const tags = document.getElementById('video-tags').value;
      const description = document.getElementById('video-description').value;

      if (!title || !category) {
        const lang = document.documentElement.lang || 'ru';
        showNotification(translations[lang]['notification_error'], 'error');
        return;
      }

      let videoData = {
        id: Date.now(),
        title,
        category,
        map,
        side,
        difficulty,
        tags: tags ? tags.split(',').map(tag => tag.trim()) : [],
        description,
        date: new Date().toLocaleDateString('ru-RU'),
        views: 0,
        favorites: 0
      };

      if (currentUploadType === 'file') {
        const fileInput = document.getElementById('video-file');
        if (fileInput.files.length === 0) {
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_error'], 'error');
          return;
        }
        const file = fileInput.files[0];
        const reader = new FileReader();
        reader.onload = async function(e) {
          videoData.src = e.target.result;
          videoData.type = 'file';

          if (await isDuplicateVideo(videoData)) {
            showNotification('Такое видео уже существует!', 'error');
            return;
          }

          await saveVideo(videoData);
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_success']);
          resetForm();
          await renderVideos(lang);
        };
        reader.readAsDataURL(file);
      } else {
        const youtubeUrl = document.getElementById('youtube-url').value;
        if (!youtubeUrl) {
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_error'], 'error');
          return;
        }
        let videoId = youtubeUrl.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);
        if (videoId) {
          videoId = videoId[1];
          // Исправление для YouTube - используем правильный формат ссылки
          videoData.src = `https://www.youtube.com/embed/${videoId}`;
          videoData.type = 'youtube';
          if (await isDuplicateVideo(videoData)) {
            showNotification('Это YouTube видео уже добавлено!', 'error');
            return;
          }
          await saveVideo(videoData);
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_success']);
          resetForm();
          await renderVideos(lang);
        } else {
          showNotification('Некорректная ссылка на YouTube видео', 'error');
        }
      }
    }

    function resetForm() {
      document.getElementById('video-title').value = '';
      document.getElementById('video-category').value = '';
      document.getElementById('video-map').value = '';
      document.getElementById('video-side').value = '';
      document.getElementById('video-difficulty').value = '';
      document.getElementById('video-tags').value = '';
      document.getElementById('video-description').value = '';
      document.getElementById('youtube-url').value = '';
      document.getElementById('video-file').value = '';
      document.querySelector('#drop-zone p').textContent = 'Перетащите видеофайл сюда или';
    }

    // Функции перевода
    function getCategoryName(category, lang = document.documentElement.lang || 'ru') {
      const categories = {
        'smoke': translations[lang]?.['filter_smoke'] || 'Дымовая',
        'flash': translations[lang]?.['filter_flash'] || 'Светошумовая',
        'molotov': translations[lang]?.['filter_molotov'] || 'Зажигательная',
        'he': translations[lang]?.['filter_he'] || 'Осколочная'
      };
      return categories[category] || category || '—';
    }

    function getDifficultyName(difficulty, lang = document.documentElement.lang || 'ru') {
      const difficulties = {
        'easy': translations[lang]?.['upload_difficulty_easy'] || 'Легкая',
        'medium': translations[lang]?.['upload_difficulty_medium'] || 'Средняя',
        'hard': translations[lang]?.['upload_difficulty_hard'] || 'Сложная'
      };
      return difficulties[difficulty] || difficulty || '—';
    }

    function getSideName(side, lang = document.documentElement.lang || 'ru') {
      const sides = {
        'CT': translations[lang]?.['filter_ct'] || 'Контр-террористы',
        'T': translations[lang]?.['filter_t'] || 'Террористы',
        'both': translations[lang]?.['filter_both'] || 'Обе стороны'
      };
      return sides[side] || side || '—';
    }

    // Отображение и управление видео
    async function renderVideos(lang = document.documentElement.lang || 'ru') {
      const videoContainer = document.getElementById('video-container');
      videoContainer.innerHTML = '';
      const videos = await getAllVideos();
      
      if (videos.length === 0) {
        videoContainer.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <i class="fas fa-video-slash" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>${translations[lang]['no_videos']}</h3>
            <p>${translations[lang]['no_videos_text']}</p>
          </div>
        `;
        return;
      }
      const favorites = await getAllFavorites();
      // сортируем новые сверху
      videos.sort((a,b) => (b.date || 0) - (a.date || 0));
      videos.forEach(video => {
        const isFavorited = favorites.includes(video.id);
        const videoCard = document.createElement('div');
        videoCard.className = 'video-card';
        videoCard.setAttribute('data-category', video.category);
        videoCard.setAttribute('data-map', video.map || '');
        videoCard.setAttribute('data-side', video.side || '');
        videoCard.setAttribute('data-difficulty', video.difficulty || '');
        let thumbContent = '';
        if (video.type === 'youtube') {
          const videoId = (video.src || '').split('/embed/')[1] || '';
          thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}">`;
        } else {
          const fileText = translations[lang]?.['upload_type_file'] || 'Файл';
          thumbContent = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:var(--gray)">${fileText}</div>`;
        }
        videoCard.innerHTML = `
          <div class="video-actions">
            <button class="action-btn ${isFavorited ? 'favorited' : ''}" onclick="toggleFavorite(${video.id}, this)">
              <i class="fas fa-star"></i>
            </button>
            <button class="action-btn" onclick="addToCollection(${video.id})">
              <i class="fas fa-folder-plus"></i>
            </button>
          </div>
          <div class="video-thumb" onclick="openVideo(${video.id})">
            ${thumbContent}
            <div class="play-icon"><i class="fas fa-play"></i></div>
          </div>
          <div class="video-info">
            <h3 class="video-title">${escapeHtml(video.title)}</h3>
            <div class="video-meta">
              <span>${getCategoryName(video.category, lang)}</span>
              <span>${escapeHtml(video.map || '—')}</span>
            </div>
            <p>${escapeHtml(video.description || '')}</p>
            <div class="video-details">
              ${video.difficulty ? `<div class="video-detail"><i class="fas fa-signal"></i> <span class="difficulty-badge difficulty-${video.difficulty}">${getDifficultyName(video.difficulty, lang)}</span></div>` : ''}
              ${video.side ? `<div class="video-detail"><i class="fas fa-user-shield"></i> ${getSideName(video.side, lang)}</div>` : ''}
            </div>
            ${video.tags && video.tags.length > 0 ? `<div class="tags">${video.tags.map(tag => `<span class="tag">${escapeHtml(tag)}</span>`).join('')}</div>` : ''}
          </div>
        `;
        videoContainer.appendChild(videoCard);
      });
    }

    // Поиск видео
    function searchVideos() {
      const searchTerm = document.getElementById('search-input').value.toLowerCase();
      const videoCards = document.querySelectorAll('.video-card');
      videoCards.forEach(card => {
        const title = (card.querySelector('.video-title') ? card.querySelector('.video-title').textContent : '').toLowerCase();
        const description = (card.querySelector('p') ? card.querySelector('p').textContent : '').toLowerCase();
        const map = (card.getAttribute('data-map') || '').toLowerCase();
        if (title.includes(searchTerm) || description.includes(searchTerm) || map.includes(searchTerm)) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    }

    // Фильтрация видео
    function filterVideos() {
      const category = document.getElementById('filter-category').value;
      const map = document.getElementById('filter-map').value;
      const side = document.getElementById('filter-side').value;
      const difficulty = document.getElementById('filter-difficulty').value;
      const videoCards = document.querySelectorAll('.video-card');
      videoCards.forEach(card => {
        const videoCategory = card.getAttribute('data-category');
        const videoMap = card.getAttribute('data-map');
        const videoSide = card.getAttribute('data-side');
        const videoDifficulty = card.getAttribute('data-difficulty');
        let show = true;
        if (category !== 'all' && category !== '' && videoCategory !== category) show = false;
        if (map !== 'all' && map !== '' && videoMap !== map) show = false;
        if (side !== 'all' && side !== '' && videoSide !== side) show = false;
        if (difficulty !== 'all' && difficulty !== '' && videoDifficulty !== difficulty) show = false;
        card.style.display = show ? 'block' : 'none';
      });
    }

    async function toggleFavorite(videoId, element) {
      const favorites = await getAllFavorites();
      const index = favorites.indexOf(videoId);
      const lang = document.documentElement.lang || 'ru';
      
      if (index === -1) {
        await addFavorite(videoId);
        element.classList.add('favorited');
        const videos = await getAllVideos();
        const video = videos.find(v => v.id === videoId);
        if (video) {
          video.favorites = (video.favorites || 0) + 1;
          await saveVideo(video);
        }
        showNotification(translations[lang]['video_add_to_favorites']);
      } else {
        await removeFavorite(videoId);
        element.classList.remove('favorited');
        const videos = await getAllVideos();
        const video = videos.find(v => v.id === videoId);
        if (video && video.favorites > 0) {
          video.favorites -= 1;
          await saveVideo(video);
        }
        showNotification(translations[lang]['video_remove_from_favorites']);
      }
      if (document.getElementById('favorites').classList.contains('active')) {
        await renderFavorites(lang);
      }
    }

    // Отображение избранного
    async function renderFavorites(lang = document.documentElement.lang || 'ru') {
      const favoritesContainer = document.getElementById('favorites-container');
      favoritesContainer.innerHTML = '';
      const favorites = await getAllFavorites();
      const videos = await getAllVideos();
      
      if (favorites.length === 0) {
        favoritesContainer.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <i class="far fa-star" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>${translations[lang]['no_favorites']}</h3>
            <p>${translations[lang]['no_favorites_text']}</p>
          </div>
        `;
        return;
      }
      videos.forEach(video => {
        if (favorites.includes(video.id)) {
          const videoCard = document.createElement('div');
          videoCard.className = 'video-card';
          let thumbContent = '';
          if (video.type === 'youtube') {
            const videoId = (video.src || '').split('/embed/')[1] || '';
            thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}">`;
          } else {
            const fileText = translations[lang]?.['upload_type_file'] || 'Файл';
            thumbContent = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:var(--gray)">${fileText}</div>`;
          }
          videoCard.innerHTML = `
            <div class="video-actions">
              <button class="action-btn favorited" onclick="toggleFavorite(${video.id}, this)">
                <i class="fas fa-star"></i>
              </button>
              <button class="action-btn" onclick="addToCollection(${video.id})">
                <i class="fas fa-folder-plus"></i>
              </button>
            </div>
            <div class="video-thumb" onclick="openVideo(${video.id})">
              ${thumbContent}
              <div class="play-icon"><i class="fas fa-play"></i></div>
            </div>
            <div class="video-info">
              <h3 class="video-title">${escapeHtml(video.title)}</h3>
              <div class="video-meta">
                <span>${getCategoryName(video.category, lang)}</span>
                <span>${escapeHtml(video.map || '—')}</span>
              </div>
              <p>${escapeHtml(video.description || '')}</p>
              <div class="video-details">
                ${video.difficulty ? `<div class="video-detail"><i class="fas fa-signal"></i> <span class="difficulty-badge difficulty-${video.difficulty}">${getDifficultyName(video.difficulty, lang)}</span></div>` : ''}
                ${video.side ? `<div class="video-detail"><i class="fas fa-user-shield"></i> ${getSideName(video.side, lang)}</div>` : ''}
              </div>
              ${video.tags && video.tags.length > 0 ? `<div class="tags">${video.tags.map(tag => `<span class="tag">${escapeHtml(tag)}</span>`).join('')}</div>` : ''}
            </div>
          `;
          favoritesContainer.appendChild(videoCard);
        }
      });
    }

    // Создание новой коллекции
    async function createNewCollection() {
      const lang = document.documentElement.lang || 'ru';
      const name = prompt(translations[lang]['upload_title_placeholder'] || 'Название коллекции');
      if (!name) return;
      const newCollection = {
        id: Date.now(),
        name,
        description: '',
        videos: [],
        created: new Date().toLocaleDateString('ru-RU')
      };
      await saveCollection(newCollection);
      await renderCollections(lang);
      showNotification(translations[lang]['notification_success']);
    }

    // Добавление видео в коллекцию
    async function addToCollection(videoId) {
      const collections = await getAllCollections();
      const lang = document.documentElement.lang || 'ru';
      
      if (collections.length === 0) {
        showNotification(translations[lang]['notification_info'], 'info');
        setTimeout(createNewCollection, 500);
        return;
      }
      let listStr = translations[lang]['collections_title'] + ':\n';
      collections.forEach(c => listStr += `${c.id} — ${c.name}\n`);
      const collectionId = prompt('Введите ID коллекции, куда добавить видео:\n' + listStr);
      if (!collectionId) return;
      const collection = collections.find(c => String(c.id) === String(collectionId).trim());
      if (collection) {
        if (!collection.videos) collection.videos = [];
        if (!collection.videos.includes(videoId)) {
          collection.videos.push(videoId);
          await saveCollection(collection);
          showNotification(translations[lang]['notification_success']);
        } else {
          showNotification(translations[lang]['notification_info'], 'info');
        }
      } else {
        showNotification(translations[lang]['notification_error'], 'error');
      }
    }

    // Отображение коллекций
    async function renderCollections(lang = document.documentElement.lang || 'ru') {
      const collectionsContainer = document.getElementById('collections-container');
      collectionsContainer.innerHTML = '';
      const collections = await getAllCollections();
      
      if (!collections || collections.length === 0) {
        collectionsContainer.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <i class="far fa-folder-open" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>${translations[lang]['no_collections']}</h3>
            <p>${translations[lang]['no_collections_text']}</p>
          </div>
        `;
        // hide collection view
        document.getElementById('collection-view').style.display = 'none';
        return;
      }
      const videos = await getAllVideos();
      collections.forEach(collection => {
        const collectionCard = document.createElement('div');
        collectionCard.className = 'collection-card';
        let thumbSrc = '';
        if (collection.videos && collection.videos.length > 0) {
          const firstVideo = videos.find(v => v.id === collection.videos[0]);
          if (firstVideo && firstVideo.type === 'youtube') {
            const videoId = (firstVideo.src || '').split('/embed/')[1] || '';
            thumbSrc = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
          } else {
            thumbSrc = ''; // no thumbnail for file
          }
        }
        collectionCard.innerHTML = `
          <div class="collection-actions">
            <button class="collection-action-btn" onclick="event.stopPropagation(); confirmDeleteCollection(${collection.id})">
              <i class="fas fa-trash"></i>
            </button>
          </div>
          <div class="collection-thumb">
            ${thumbSrc ? `<img src="${thumbSrc}" alt="${collection.name}">` : `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:var(--gray)">Нет превью</div>`}
            <div class="collection-count">${(collection.videos ? collection.videos.length : 0)} ${translations[lang]['video_views']}</div>
          </div>
          <div class="collection-info">
            <h3 class="collection-title">${escapeHtml(collection.name)}</h3>
            <p class="collection-desc">${escapeHtml(collection.description || '')}</p>
            <div class="collection-meta">
              <span>${translations[lang]['collections_create']}: ${collection.created}</span>
              <span><i class="fas fa-video"></i> ${(collection.videos ? collection.videos.length : 0)}</span>
            </div>
          </div>
        `;
        collectionCard.addEventListener('click', () => openCollection(collection.id, lang));
        collectionsContainer.appendChild(collectionCard);
      });
      // hide collection view
      document.getElementById('collection-view').style.display = 'none';
    }

    // Открытие коллекции
    async function openCollection(collectionId, lang = document.documentElement.lang || 'ru') {
      const collections = await getAllCollections();
      const collection = collections.find(c => String(c.id) === String(collectionId));
      
      if (!collection) {
        showNotification(translations[lang]['notification_error'], 'error');
        return;
      }
      // Загружаем видео
      const videos = await getAllVideos();
      const container = document.getElementById('collection-videos-container');
      container.innerHTML = '';
      const ids = collection.videos || [];
      if (ids.length === 0) {
        container.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; padding: 30px; color: var(--gray);">${translations[lang]['collection_empty']}</div>`;
      } else {
        for (const id of ids) {
          const video = videos.find(v => String(v.id) === String(id));
          if (video) {
            const card = document.createElement('div');
            card.className = 'video-card';
            card.setAttribute('data-category', video.category || '');
            card.setAttribute('data-map', video.map || '');
            let thumbContent = '';
            if (video.type === 'youtube') {
              const videoId = (video.src || '').split('/embed/')[1] || '';
              thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}">`;
            } else {
              const fileText = translations[lang]?.['upload_type_file'] || 'Файл';
              thumbContent = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:var(--gray)">${fileText}</div>`;
            }
            card.innerHTML = `
              <div class="video-actions">
                <button class="action-btn" onclick="toggleFavorite(${video.id}, this)">
                  <i class="fas fa-star"></i>
                </button>
                <button class="action-btn" onclick="addToCollection(${video.id})">
                  <i class="fas fa-folder-plus"></i>
                </button>
              </div>
              <div class="video-thumb" onclick="openVideo(${video.id})">
                ${thumbContent}
                <div class="play-icon"><i class="fas fa-play"></i></div>
              </div>
              <div class="video-info">
                <h3 class="video-title">${escapeHtml(video.title)}</h3>
                <div class="video-meta">
                  <span>${getCategoryName(video.category, lang)}</span>
                  <span>${escapeHtml(video.map || '—')}</span>
                </div>
                <p>${escapeHtml(video.description || '')}</p>
                <div class="video-details">
                  ${video.difficulty ? `<div class="video-detail"><i class="fas fa-signal"></i> <span class="difficulty-badge difficulty-${video.difficulty}">${getDifficultyName(video.difficulty, lang)}</span></div>` : ''}
                  ${video.side ? `<div class="video-detail"><i class="fas fa-user-shield"></i> ${getSideName(video.side, lang)}</div>` : ''}
                </div>
                ${video.tags && video.tags.length > 0 ? `<div class="tags">${video.tags.map(tag => `<span class="tag">${escapeHtml(tag)}</span>`).join('')}</div>` : ''}
              </div>
            `;
            container.appendChild(card);
          }
        }
      }
      document.getElementById('collection-view').style.display = 'block';
      const backBtn = document.getElementById('collection-back-btn');
      backBtn.style.display = 'inline-block';
      document.getElementById('collection-view-title').textContent = collection.name;
      // Scroll to view
      setTimeout(()=> document.getElementById('collection-view').scrollIntoView({behavior:'smooth'}), 50);
    }

    function closeCollectionView() {
      document.getElementById('collection-view').style.display = 'none';
      document.getElementById('collection-back-btn').style.display = 'none';
      document.getElementById('collection-view-title').textContent = '';
      document.getElementById('collection-videos-container').innerHTML = '';
      // Ensure collections list visible
      document.getElementById('collections-container').scrollIntoView({behavior:'smooth'});
    }

    // Рендер панели администратора
    async function renderAdminPanel(lang = document.documentElement.lang || 'ru') {
      const adminList = document.getElementById('admin-video-list');
      adminList.innerHTML = '';
      const videos = await getAllVideos();
      
      if (videos.length === 0) {
        adminList.innerHTML = `
          <div style="text-align: center; padding: 40px;">
            <i class="fas fa-video-slash" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>${translations[lang]['no_videos']}</h3>
            <p>${translations[lang]['no_videos_text']}</p>
          </div>
        `;
        return;
      }
      videos.forEach(video => {
        const videoItem = document.createElement('div');
        videoItem.className = 'admin-video-item';
        videoItem.innerHTML = `
          <div class="admin-video-info">
            <div class="admin-video-title">${escapeHtml(video.title)}</div>
            <div class="admin-video-meta">
              ${getCategoryName(video.category, lang)} • ${escapeHtml(video.map || 'Не указана')} • 
              ${video.date} • ${translations[lang]['video_views']}: ${video.views || 0}
            </div>
          </div>
          <button class="btn btn-danger" onclick="confirmDeleteVideo(${video.id})">
            <i class="fas fa-trash"></i> ${translations[lang]['admin_delete']}
          </button>
        `;
        adminList.appendChild(videoItem);
      });
    }

    // Подтверждение удаления видео
    function confirmDeleteVideo(videoId) {
      currentDeletion = { type: 'video', id: videoId };
      const lang = document.documentElement.lang || 'ru';
      document.getElementById('confirm-title').textContent = translations[lang]['confirm_title'];
      document.getElementById('confirm-message').textContent = translations[lang]['confirm_message'];
      document.getElementById('confirm-modal').classList.add('active');
    }

    // Обработчики кнопок в confirm-modal
    document.getElementById('confirm-yes').addEventListener('click', async function() {
      const { type, id } = currentDeletion;
      const lang = document.documentElement.lang || 'ru';
      
      if (!type || id === null) {
        document.getElementById('confirm-modal').classList.remove('active');
        return;
      }
      if (type === 'video') {
        try {
          // remove from collections
          const collections = await getAllCollections();
          for (const c of collections) {
            if (c.videos && c.videos.includes(id)) {
              c.videos = c.videos.filter(vid => String(vid) !== String(id));
              await saveCollection(c);
            }
          }
          // remove from favorites
          await removeFavorite(id);
          // remove from videos store
          await deleteVideoFromDB(id);
          // Обновляем UI
          await renderVideos(lang);
          await renderCollections(lang);
          await renderAdminPanel(lang);
          await renderFavorites(lang);
          showNotification(translations[lang]['notification_success']);
        } catch (e) {
          console.error(e);
          showNotification(translations[lang]['notification_error'], 'error');
        }
      } else if (type === 'collection') {
        try {
          await deleteCollectionFromDB(id);
          await renderCollections(lang);
          showNotification(translations[lang]['notification_success']);
        } catch (e) {
          console.error(e);
          showNotification(translations[lang]['notification_error'], 'error');
        }
      }
      currentDeletion = { type: null, id: null };
      document.getElementById('confirm-modal').classList.remove('active');
    });

    document.getElementById('confirm-no').addEventListener('click', function() {
      currentDeletion = { type: null, id: null };
      document.getElementById('confirm-modal').classList.remove('active');
    });

    // Подтверждение удаления коллекции
    async function confirmDeleteCollection(collectionId) {
      const collections = await getAllCollections();
      const collection = collections.find(c => String(c.id) === String(collectionId));
      if (!collection) return;
      currentDeletion = { type: 'collection', id: collectionId };
      const lang = document.documentElement.lang || 'ru';
      document.getElementById('confirm-title').textContent = translations[lang]['confirm_title'];
      document.getElementById('confirm-message').textContent = `Вы уверены, что хотите удалить коллекцию "${collection.name}"? Это действие нельзя отменить.`;
      document.getElementById('confirm-modal').classList.add('active');
    }

    // Открытие видео
    async function openVideo(videoId) {
      const videos = await getAllVideos();
      const video = videos.find(v => String(v.id) === String(videoId));
      const lang = document.documentElement.lang || 'ru';
      
      if (video) {
        await saveVideo(video);
        const modalContainer = document.getElementById('modal-video-container');
        modalContainer.innerHTML = '';
        if (video.type === 'youtube') {
          const iframe = document.createElement('iframe');
          iframe.className = 'modal-video';
          iframe.src = video.src + '?enablejsapi=1';
          iframe.frameBorder = '0';
          iframe.allowFullscreen = true;
          iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
          modalContainer.appendChild(iframe);
        } else {
          const videoElement = document.createElement('video');
          videoElement.className = 'modal-video';
          videoElement.controls = true;
          const source = document.createElement('source');
          source.src = video.src;
          source.type = 'video/mp4';
          videoElement.appendChild(source);
          modalContainer.appendChild(videoElement);
        }
        document.getElementById('modal-title').textContent = video.title;
        document.getElementById('modal-category').textContent = `${getCategoryName(video.category, lang)}${video.map ? ' • ' + video.map : ''}`;
        document.getElementById('modal-date').textContent = video.date;
        document.getElementById('modal-description').textContent = video.description || 'Описание';
        document.getElementById('modal-map').textContent = video.map || 'Не указана';
        document.getElementById('modal-side').textContent = getSideName(video.side, lang);
        document.getElementById('modal-difficulty').textContent = getDifficultyName(video.difficulty, lang);
        
        // Добавляем теги
        const tagsContainer = document.getElementById('modal-tags');
        tagsContainer.innerHTML = '';
        if (video.tags && video.tags.length > 0) {
          video.tags.forEach(tag => {
            const tagElement = document.createElement('span');
            tagElement.className = 'tag';
            tagElement.textContent = tag;
            tagsContainer.appendChild(tagElement);
          });
        }
        
        document.getElementById('video-modal').classList.add('active');
        document.body.style.overflow = 'hidden';
      }
    }

    // Закрытие видео
    function closeVideo() {
      document.getElementById('video-modal').classList.remove('active');
      document.body.style.overflow = 'auto';
      const videoContainer = document.getElementById('modal-video-container');
      const videoElement = videoContainer.querySelector('video, iframe');
      if (videoElement) {
        if (videoElement.tagName === 'VIDEO') {
          videoElement.pause();
        } else if (videoElement.tagName === 'IFRAME') {
          const src = videoElement.src;
          videoElement.src = '';
          videoElement.src = src;
        }
      }
      videoContainer.innerHTML = '';
    }

    // Закрытие модального окна при клике вне него
    document.getElementById('video-modal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeVideo();
      }
    });

    // Категории — кнопки фильтра
    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        const filter = this.getAttribute('data-filter');
        document.querySelectorAll('.video-card').forEach(card => {
          if (filter === 'all' || card.getAttribute('data-category') === filter) {
            card.style.display = 'block';
          } else {
            card.style.display = 'none';
          }
        });
      });
    });

    // Маленькая утилита — экранирование HTML при вставке в innerHTML
    function escapeHtml(text) {
      if (!text && text !== 0) return '';
      return String(text)
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
    }

    // Периодическое обновление
    setInterval(async () => {
      if (!db) return;
      const active = Array.from(document.querySelectorAll('section')).find(s => s.classList.contains('active'));
      if (!active) return;
      const id = active.id;
      const lang = document.documentElement.lang || 'ru';
      if (id === 'videos') await renderVideos(lang);
      else if (id === 'collections') await renderCollections(lang);
      else if (id === 'admin') await renderAdminPanel(lang);
      else if (id === 'favorites') await renderFavorites(lang);
    }, 8000);

  </script>
</body>
</html>
</body>

</html>


