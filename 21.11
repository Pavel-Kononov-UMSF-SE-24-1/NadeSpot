<?php
$host = 'localhost'; // Обычно localhost
$db   = '...'; // Имя вашей базы
$user = '...'; // Логин от базы данных
$pass = '...'; // Пароль от базы данных
$charset = 'utf8mb4';

$dsn = "mysql:host=$host;dbname=$db;charset=$charset";
$opt = [
    PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
    PDO::ATTR_EMULATE_PREPARES   => false,
];

try {
    $pdo = new PDO($dsn, $user, $pass, $opt);
} catch (\PDOException $e) {
    throw new \PDOException($e->getMessage(), (int)$e->getCode());
}
?>
<?php
header('Content-Type: application/json');
require 'db.php';

// Получаем данные
$data = json_decode(file_get_contents('php://input'), true);

if (!isset($data['id'])) {
    http_response_code(400);
    echo json_encode(['error' => 'No ID provided']);
    exit;
}

try {
    // Удаляем видео
    $stmt = $pdo->prepare("DELETE FROM videos WHERE id = ?");
    $stmt->execute([$data['id']]);

    if ($stmt->rowCount() > 0) {
        echo json_encode(['success' => true]);
    } else {
        echo json_encode(['success' => false, 'error' => 'Video not found']);
    }
} catch (Exception $e) {
    http_response_code(500);
    echo json_encode(['error' => $e->getMessage()]);
}
?>
<?php
header('Content-Type: application/json');
require 'db.php';

try {
    // Получаем видео, сортируем по ID (новые в конце, JS перевернет)
    $stmt = $pdo->query("SELECT * FROM videos ORDER BY id DESC");
    $videos = $stmt->fetchAll();
    echo json_encode($videos);
} catch (Exception $e) {
    http_response_code(500);
    echo json_encode(['error' => $e->getMessage()]);
}
?>
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NadeSpot - Лучшие гранаты CS2</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#ff4500">
  <style>
    /* Все существующие стили остаются без изменений */
    :root {
      --primary: #ff4500;
      --primary-dark: #e03d00;
      --primary-light: #ff6a33;
      --secondary: #1a1a1a;
      --dark: #111;
      --light: #f5f5f5;
      --gray: #888;
      --card-bg: #1e1e1e;
      --card-hover: #252525;
      --text-color: #f5f5f5;
      --bg-color: #111;
      --nav-bg: #1a1a1a;
      --border-color: #333;
      --input-bg: #2a2a2a;
      --danger: #dc3545;
      --danger-dark: #bd2130;
      --success: #28a745;
      --info: #17a2b8;
      --warning: #ffc107;
      --easy: #28a745;
      --medium: #ffc107;
      --hard: #dc3545;
      
      /* Responsive scaling variables */
      --scale-factor: 1;
      --base-font-size: 16px;
      --heading-scale: 1.2;
      --element-scale: 1;
      --spacing-scale: 1;
    }

    [data-theme="light"] {
      --primary: #ff4500;
      --primary-dark: #e03d00;
      --primary-light: #ff6a33;
      --secondary: #f0f0f0;
      --dark: #f5f5f5;
      --light: #111;
      --gray: #666;
      --card-bg: #ffffff;
      --card-hover: #f0f0f0;
      --text-color: #111;
      --bg-color: #f5f5f5;
      --nav-bg: #ffffff;
      --border-color: #ddd;
      --input-bg: #ffffff;
      --danger: #dc3545;
      --danger-dark: #bd2130;
      --success: #28a745;
      --info: #17a2b8;
      --warning: #ffc107;
      --easy: #28a745;
      --medium: #ffc107;
      --hard: #dc3545;
    }
    
    /* Responsive scaling for large screens */
    @media (min-width: 1920px) {
      :root {
        --scale-factor: 1.15;
        --base-font-size: 18px;
        --heading-scale: 1.3;
        --element-scale: 1.1;
        --spacing-scale: 1.1;
      }
    }
    
    @media (min-width: 2560px) {
      :root {
        --scale-factor: 1.3;
        --base-font-size: 20px;
        --heading-scale: 1.4;
        --element-scale: 1.2;
        --spacing-scale: 1.2;
      }
    }
    
    @media (min-width: 3840px) {
      :root {
        --scale-factor: 1.5;
        --base-font-size: 24px;
        --heading-scale: 1.6;
        --element-scale: 1.4;
        --spacing-scale: 1.4;
      }
    }
    
    /* Responsive scaling for small screens */
    @media (max-width: 768px) {
      :root {
        --scale-factor: 0.9;
        --base-font-size: 15px;
        --heading-scale: 1.1;
        --element-scale: 0.9;
        --spacing-scale: 0.9;
      }
    }
    
    @media (max-width: 480px) {
      :root {
        --scale-factor: 0.8;
        --base-font-size: 14px;
        --heading-scale: 1;
        --element-scale: 0.8;
        --spacing-scale: 0.8;
      }
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      overflow-x: hidden;
      transition: background-color 0.3s, color 0.3s;
      font-size: var(--base-font-size);
    }
    
    /* Навигация */
    nav {
      background: var(--nav-bg);
      padding: calc(15px * var(--spacing-scale)) 0;
      border-bottom: calc(2px * var(--element-scale)) solid var(--primary);
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s, border-color 0.3s;
    }
    
    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: calc(1200px * var(--element-scale));
      margin: 0 auto;
      padding: 0 calc(20px * var(--spacing-scale));
    }
    
    .logo {
      display: flex;
      align-items: center;
      font-size: calc(24px * var(--heading-scale));
      font-weight: bold;
      color: var(--primary);
      text-decoration: none;
      transition: transform 0.3s;
    }
    
    .logo:hover {
      transform: scale(1.05);
    }
    
    .logo i {
      margin-right: calc(10px * var(--spacing-scale));
      font-size: calc(28px * var(--element-scale));
    }
    
    .nav-links {
      display: flex;
      list-style: none;
      align-items: center;
    }
    
    .nav-links li {
      margin-left: calc(15px * var(--spacing-scale));
      position: relative;
    }
    
    .nav-links a {
      text-decoration: none;
      color: var(--text-color);
      font-weight: 600;
      transition: 0.3s;
      padding: calc(5px * var(--spacing-scale)) 0;
      position: relative;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .nav-links a:hover,
    .nav-links a.active {
      color: var(--primary);
    }
    
    .nav-links a.active::after {
      content: '';
      position: absolute;
      bottom: calc(-5px * var(--spacing-scale));
      left: 0;
      width: 100%;
      height: calc(2px * var(--element-scale));
      background: var(--primary);
    }
    
    .language-switcher {
      display: flex;
      margin-left: calc(10px * var(--spacing-scale));
      gap: calc(5px * var(--spacing-scale));
    }
    
    .lang-btn {
      background: rgba(0, 0, 0, 0.1);
      border: none;
      color: var(--text-color);
      padding: calc(5px * var(--spacing-scale)) calc(10px * var(--spacing-scale));
      border-radius: calc(4px * var(--element-scale));
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: calc(12px * var(--scale-factor));
    }
    
    .lang-btn:hover {
      background: rgba(0, 0, 0, 0.2);
    }
    
    .lang-btn.active {
      background: var(--primary);
      color: white;
    }
      
    .theme-switcher {
      margin-left: calc(15px * var(--spacing-scale));
      cursor: pointer;
      width: calc(40px * var(--element-scale));
      height: calc(20px * var(--element-scale));
      background: var(--card-bg);
      border-radius: calc(10px * var(--element-scale));
      position: relative;
      display: flex;
      align-items: center;
      padding: calc(2px * var(--spacing-scale));
      transition: background 0.3s;
    }
    
    .theme-switcher::before {
      content: '';
      position: absolute;
      width: calc(16px * var(--element-scale));
      height: calc(16px * var(--element-scale));
      border-radius: 50%;
      background: var(--primary);
      transition: transform 0.3s;
    }
    
    [data-theme="light"] .theme-switcher::before {
      transform: translateX(calc(20px * var(--element-scale)));
    }
    
    .theme-icon {
      font-size: calc(12px * var(--scale-factor));
      margin: 0 calc(5px * var(--spacing-scale));
      z-index: 1;
    }
    
    .theme-icon.sun {
      color: var(--text-color);
    }
    
    .theme-icon.moon {
      color: var(--text-color);
      margin-left: auto;
    }

    /* Мобильное меню */
    .menu-toggle {
      display: none;
      flex-direction: column;
      cursor: pointer;
      padding: calc(5px * var(--spacing-scale));
    }

    .menu-toggle span {
      width: calc(25px * var(--element-scale));
      height: calc(3px * var(--element-scale));
      background: var(--text-color);
      margin: calc(3px * var(--spacing-scale)) 0;
      transition: 0.3s;
    }
    
    /* Главный баннер */
    .hero {
      height: calc(500px * var(--element-scale));
      background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                 url('https://images.unsplash.com/photo-1757923028479-821ade5e2aef?q=80&w=1057&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D') 
                 no-repeat center center/cover;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 calc(20px * var(--spacing-scale));
    }
    
    .hero-content {
      max-width: calc(800px * var(--element-scale));
    }
    
    .hero-content h1 {
      font-size: calc(48px * var(--heading-scale));
      margin-bottom: calc(20px * var(--spacing-scale));
      color: var(--primary);
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.8);
      animation: fadeInDown 1s;
    }
    
    .hero-content p {
      font-size: calc(20px * var(--scale-factor));
      margin-bottom: calc(30px * var(--spacing-scale));
      color: #eee;
      animation: fadeInUp 1s;
    }
    
    .hero-buttons {
      display: flex;
      justify-content: center;
      gap: calc(15px * var(--spacing-scale));
      animation: fadeIn 1.5s;
    }
    
    .btn {
      display: inline-block;
      padding: calc(12px * var(--spacing-scale)) calc(30px * var(--spacing-scale));
      background: var(--primary);
      color: #fff;
      text-decoration: none;
      font-weight: bold;
      border-radius: calc(6px * var(--element-scale));
      transition: 0.3s;
      border: none;
      cursor: pointer;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .btn:hover {
      background: var(--primary-dark);
      transform: translateY(calc(-3px * var(--element-scale)));
      box-shadow: 0 5px 15px rgba(255, 69, 0, 0.4);
    }
    
    .btn-outline {
      background: transparent;
      border: calc(2px * var(--element-scale)) solid var(--primary);
      color: var(--primary);
    }
    
    .btn-outline:hover {
      background: var(--primary);
      color: #fff;
    }
    
    .btn-danger {
      background: var(--danger);
    }
    
    .btn-danger:hover {
      background: var(--danger-dark);
    }
    
    .btn-success {
      background: var(--success);
    }
    
    .btn-info {
      background: var(--info);
    }

    /* Статистика */
    .stats-section {
      background: var(--card-bg);
      padding: calc(40px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      margin: calc(40px * var(--spacing-scale)) auto;
      max-width: calc(1200px * var(--element-scale));
      border-radius: calc(12px * var(--element-scale));
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(calc(200px * var(--element-scale)), 1fr));
      gap: calc(25px * var(--spacing-scale));
      text-align: center;
    }

    .stat-item {
      padding: calc(20px * var(--spacing-scale));
      background: var(--input-bg);
      border-radius: calc(8px * var(--element-scale));
      transition: transform 0.3s;
    }

    .stat-item:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
    }

    .stat-number {
      font-size: calc(2.5rem * var(--heading-scale));
      font-weight: bold;
      color: var(--primary);
      margin-bottom: calc(10px * var(--spacing-scale));
    }

    .stat-label {
      color: var(--text-color);
      font-size: calc(1rem * var(--scale-factor));
    }

    /* Карты CS2 */
    .maps-section {
      padding: calc(40px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      max-width: calc(1200px * var(--element-scale));
      margin: 0 auto;
    }

    .maps-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(calc(280px * var(--element-scale)), 1fr));
      gap: calc(20px * var(--spacing-scale));
      margin-top: calc(30px * var(--spacing-scale));
    }

    .map-card {
      background: var(--card-bg);
      border-radius: calc(12px * var(--element-scale));
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      cursor: pointer;
    }

    .map-card:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .map-image {
      height: calc(180px * var(--element-scale));
      background: linear-gradient(45deg, #333, #555);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: calc(1.2rem * var(--scale-factor));
      font-weight: bold;
      background-size: cover;
      background-position: center;
    }

    .map-info {
      padding: calc(20px * var(--spacing-scale));
    }

    .map-name {
      font-size: calc(1.3rem * var(--scale-factor));
      font-weight: bold;
      margin-bottom: calc(10px * var(--spacing-scale));
      color: var(--primary);
    }

    .map-stats {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      font-size: calc(0.9rem * var(--scale-factor));
    }

    /* Типы гранат */
    .grenades-section {
      padding: calc(40px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      max-width: calc(1200px * var(--element-scale));
      margin: 0 auto;
    }

    .grenades-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(calc(250px * var(--element-scale)), 1fr));
      gap: calc(20px * var(--spacing-scale));
      margin-top: calc(30px * var(--spacing-scale));
    }

    .grenade-card {
      background: var(--card-bg);
      padding: calc(25px * var(--spacing-scale));
      border-radius: calc(12px * var(--element-scale));
      text-align: center;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .grenade-card:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .grenade-icon {
      font-size: calc(3rem * var(--element-scale));
      color: var(--primary);
      margin-bottom: calc(15px * var(--spacing-scale));
    }

    .grenade-name {
      font-size: calc(1.2rem * var(--scale-factor));
      font-weight: bold;
      margin-bottom: calc(10px * var(--spacing-scale));
      color: var(--text-color);
    }

    .grenade-desc {
      color: var(--gray);
      font-size: calc(0.9rem * var(--scale-factor));
      line-height: 1.5;
    }

    /* Уведомления */
    .notification {
      position: fixed;
      top: calc(20px * var(--spacing-scale));
      right: calc(20px * var(--spacing-scale));
      padding: calc(15px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      border-radius: calc(5px * var(--element-scale));
      color: white;
      z-index: 1000;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .notification.show {
      opacity: 1;
      transform: translateX(0);
    }
    
    .notification.error {
      background-color: var(--danger);
    }
    
    .notification.success {
      background-color: var(--success);
    }
    
    .notification.info {
      background-color: var(--info);
    }
    
    /* Секции */
    section {
      display: none;
      padding: calc(40px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      max-width: calc(1200px * var(--element-scale));
      margin: 0 auto;
    }
    
    section.active {
      display: block;
      animation: fadeIn 0.5s;
    }
    
    .section-title {
      text-align: center;
      font-size: calc(36px * var(--heading-scale));
      margin-bottom: calc(30px * var(--spacing-scale));
      color: var(--text-color);
      position: relative;
      padding-bottom: calc(15px * var(--spacing-scale));
    }
    
    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: calc(80px * var(--element-scale));
      height: calc(4px * var(--element-scale));
      background: var(--primary);
      border-radius: calc(2px * var(--element-scale));
    }

    .section-subtitle {
      text-align: center;
      color: var(--gray);
      margin-bottom: calc(40px * var(--spacing-scale));
      font-size: calc(1.1rem * var(--scale-factor));
      max-width: calc(600px * var(--element-scale));
      margin-left: auto;
      margin-right: auto;
    }
    
    /* Поиск и фильтры */
    .search-filters {
      background: var(--card-bg);
      padding: calc(20px * var(--spacing-scale));
      border-radius: calc(8px * var(--element-scale));
      margin-bottom: calc(30px * var(--spacing-scale));
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .search-box {
      display: flex;
      margin-bottom: calc(15px * var(--spacing-scale));
    }
    
    .search-box input {
      flex: 1;
      padding: calc(12px * var(--spacing-scale));
      border: calc(1px * var(--element-scale)) solid var(--border-color);
      border-radius: calc(4px * var(--element-scale)) 0 0 calc(4px * var(--element-scale));
      background: var(--input-bg);
      color: var(--text-color);
      font-size: calc(16px * var(--scale-factor));
    }
    
    .search-box button {
      padding: 0 calc(20px * var(--spacing-scale));
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 0 calc(4px * var(--element-scale)) calc(4px * var(--element-scale)) 0;
      cursor: pointer;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .advanced-filters {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(calc(200px * var(--element-scale)), 1fr));
      gap: calc(15px * var(--spacing-scale));
    }
    
    .filter-group {
      margin-bottom: calc(15px * var(--spacing-scale));
    }
    
    .filter-group label {
      display: block;
      margin-bottom: calc(5px * var(--spacing-scale));
      font-weight: 500;
      color: var(--text-color);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .filter-group select,
    .filter-group input {
      width: 100%;
      padding: calc(10px * var(--spacing-scale));
      border: calc(1px * var(--element-scale)) solid var(--border-color);
      border-radius: calc(4px * var(--element-scale));
      background: var(--input-bg);
      color: var(--text-color);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    /* Сетка видео */
    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(calc(300px * var(--element-scale)), 1fr));
      gap: calc(25px * var(--spacing-scale));
      margin-top: calc(30px * var(--spacing-scale));
    }
    
    .video-card {
      background: var(--card-bg);
      border-radius: calc(8px * var(--element-scale));
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
    }
    
    .video-card:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      background: var(--card-hover);
    }
    
    .video-actions {
      position: absolute;
      top: calc(10px * var(--spacing-scale));
      right: calc(10px * var(--spacing-scale));
      z-index: 5;
      display: flex;
      gap: calc(10px * var(--spacing-scale));
    }
    
    .video-card:hover .video-actions {
      display: flex;
    }
    
    .action-btn {
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      border-radius: 50%;
      width: calc(30px * var(--element-scale));
      height: calc(30px * var(--element-scale));
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.3s;
      font-size: calc(14px * var(--scale-factor));
    }
    
    .action-btn:hover {
      background: var(--primary);
      transform: scale(1.1);
    }
    
    .favorited {
      color: gold;
    }
    
    .video-thumb {
      height: calc(180px * var(--element-scale));
      background-color: #222;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    .video-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }
    
    .video-thumb:hover img {
      transform: scale(1.05);
    }
    
    .play-icon {
      position: absolute;
      font-size: calc(60px * var(--element-scale));
      color: rgba(255, 255, 255, 0.9);
      transition: 0.3s;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }
    
    .video-thumb:hover .play-icon {
      color: var(--primary);
      transform: scale(1.1);
    }
    
    .video-duration {
      position: absolute;
      bottom: calc(10px * var(--spacing-scale));
      right: calc(10px * var(--spacing-scale));
      background: rgba(0, 0, 0, 0.7);
      padding: calc(3px * var(--spacing-scale)) calc(8px * var(--spacing-scale));
      border-radius: calc(4px * var(--element-scale));
      font-size: calc(14px * var(--scale-factor));
    }
    
    .video-info {
      padding: calc(15px * var(--spacing-scale));
    }
    
    .video-title {
      font-size: calc(18px * var(--scale-factor));
      margin-bottom: calc(10px * var(--spacing-scale));
      font-weight: 600;
      color: var(--text-color);
    }
    
    .video-meta {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      font-size: calc(14px * var(--scale-factor));
      margin-bottom: calc(10px * var(--spacing-scale));
    }
    
    .video-stats {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      border-top: calc(1px * var(--element-scale)) solid var(--border-color);
      padding-top: calc(15px * var(--spacing-scale));
      font-size: calc(14px * var(--scale-factor));
    }
    
    .video-stat {
      display: flex;
      align-items: center;
    }
    
    .video-stat i {
      margin-right: calc(5px * var(--spacing-scale));
    }
    
    /* Категории */
    .categories {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: calc(15px * var(--spacing-scale));
      margin-bottom: calc(30px * var(--spacing-scale));
    }
    
    .category-btn {
      padding: calc(8px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      background: var(--card-bg);
      color: var(--text-color);
      border: none;
      border-radius: calc(20px * var(--element-scale));
      cursor: pointer;
      transition: 0.3s;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .category-btn:hover,
    .category-btn.active {
      background: var(--primary);
    }
    
    /* Форма загрузки видео */
    .upload-form {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(8px * var(--element-scale));
      max-width: calc(600px * var(--element-scale));
      margin: 0 auto;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .form-group {
      margin-bottom: calc(20px * var(--spacing-scale));
    }
    
    .form-group label {
      display: block;
      margin-bottom: calc(8px * var(--spacing-scale));
      font-weight: 500;
      color: var(--text-color);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .form-control {
      width: 100%;
      padding: calc(12px * var(--spacing-scale));
      border: calc(1px * var(--element-scale)) solid var(--border-color);
      border-radius: calc(4px * var(--element-scale));
      background: var(--input-bg);
      color: var(--text-color);
      font-size: calc(16px * var(--scale-factor));
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--primary);
    }
    
    textarea.form-control {
      min-height: calc(100px * var(--element-scale));
      resize: vertical;
    }
    
    .file-upload {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: calc(2px * var(--element-scale)) dashed var(--border-color);
      border-radius: calc(8px * var(--element-scale));
      padding: calc(20px * var(--spacing-scale));
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
      margin-bottom: calc(20px * var(--spacing-scale));
    }
    
    .file-upload:hover {
      border-color: var(--primary);
    }
    
    .file-upload i {
      font-size: calc(40px * var(--element-scale));
      color: var(--primary);
      margin-bottom: calc(10px * var(--spacing-scale));
    }
    
    .upload-types {
      display: flex;
      gap: calc(15px * var(--spacing-scale));
      margin-bottom: calc(20px * var(--spacing-scale));
    }
    
    .upload-type-btn {
      flex: 1;
      padding: calc(12px * var(--spacing-scale));
      background: var(--input-bg);
      border: calc(1px * var(--element-scale)) solid var(--border-color);
      border-radius: calc(6px * var(--element-scale));
      color: var(--text-color);
      cursor: pointer;
      transition: 0.3s;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .upload-type-btn.active {
      background: var(--primary);
      border-color: var(--primary);
    }
    
    /* Коллекции */
    .collections-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(calc(280px * var(--element-scale)), 1fr));
      gap: calc(25px * var(--spacing-scale));
      margin-top: calc(30px * var(--spacing-scale));
    }
    
    .collection-card {
      background: var(--card-bg);
      border-radius: calc(8px * var(--element-scale));
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      cursor: pointer;
    }
    
    .collection-card:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    /* Стили для кнопки удаления коллекции */
    .collection-actions {
      position: absolute;
      top: calc(10px * var(--spacing-scale));
      right: calc(10px * var(--spacing-scale));
      display: flex;
      gap: calc(10px * var(--spacing-scale));
      z-index: 5;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .collection-card:hover .collection-actions {
      opacity: 1;
    }
    
    .collection-action-btn {
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      border-radius: 50%;
      width: calc(30px * var(--element-scale));
      height: calc(30px * var(--element-scale));
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.3s;
      font-size: calc(14px * var(--scale-factor));
    }
    
    .collection-action-btn:hover {
      background: var(--danger);
      transform: scale(1.1);
    }
    
    .collection-thumb {
      height: calc(150px * var(--element-scale));
      background-color: #222;
      position: relative;
      overflow: hidden;
    }
    
    .collection-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .collection-count {
      position: absolute;
      top: calc(10px * var(--spacing-scale));
      right: calc(10px * var(--spacing-scale));
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: calc(5px * var(--spacing-scale)) calc(10px * var(--spacing-scale));
      border-radius: calc(20px * var(--element-scale));
      font-size: calc(12px * var(--scale-factor));
    }
    
    .collection-info {
      padding: calc(15px * var(--spacing-scale));
    }
    
    .collection-title {
      font-size: calc(18px * var(--scale-factor));
      margin-bottom: calc(10px * var(--spacing-scale));
      font-weight: 600;
      color: var(--text-color);
    }
    
    .collection-desc {
      color: var(--gray);
      font-size: calc(14px * var(--scale-factor));
      margin-bottom: calc(15px * var(--spacing-scale));
    }
    
    .collection-meta {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      font-size: calc(12px * var(--scale-factor));
    }
    
    /* Панель администратора */
    .admin-panel {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(8px * var(--element-scale));
      max-width: calc(800px * var(--element-scale));
      margin: 0 auto;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .admin-video-list {
      margin-top: calc(20px * var(--spacing-scale));
    }
    
    .admin-video-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: calc(15px * var(--spacing-scale));
      border-bottom: calc(1px * var(--element-scale)) solid var(--border-color);
    }
    
    .admin-video-item:last-child {
      border-bottom: none;
    }
    
    .admin-video-info {
      flex: 1;
    }
    
    .admin-video-title {
      font-weight: 600;
      margin-bottom: calc(5px * var(--spacing-scale));
      color: var(--text-color);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .admin-video-meta {
      font-size: calc(14px * var(--scale-factor));
      color: var(--gray);
    }
    
    /* Модальное окно видео */
    .video-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: calc(20px * var(--spacing-scale));
    }
    
    .video-modal.active {
      display: flex;
      animation: fadeIn 0.3s;
    }
    
    .modal-content {
      background: var(--card-bg);
      width: 100%;
      max-width: calc(900px * var(--element-scale));
      border-radius: calc(8px * var(--element-scale));
      overflow: hidden;
      position: relative;
    }
    
    .modal-close {
      position: absolute;
      top: calc(15px * var(--spacing-scale));
      right: calc(15px * var(--spacing-scale));
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      width: calc(40px * var(--element-scale));
      height: calc(40px * var(--element-scale));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10;
      font-size: calc(20px * var(--scale-factor));
      transition: background 0.3s;
    }
    
    .modal-close:hover {
      background: var(--primary);
    }
    
    .modal-video-container {
      width: 100%;
      position: relative;
      padding-top: 56.25%; /* 16:9 Aspect Ratio */
    }
    
    .modal-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
    
    .modal-body {
      padding: calc(20px * var(--spacing-scale));
    }
    
    .modal-title {
      font-size: calc(24px * var(--scale-factor));
      margin-bottom: calc(10px * var(--spacing-scale));
      color: var(--text-color);
    }
    
    .modal-meta {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      margin-bottom: calc(15px * var(--spacing-scale));
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .modal-description {
      margin-bottom: calc(20px * var(--spacing-scale));
      line-height: 1.6;
      color: var(--text-color);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .modal-stats {
      display: flex;
      justify-content: space-between;
      color: var(--gray);
      border-top: calc(1px * var(--element-scale)) solid var(--border-color);
      padding-top: calc(15px * var(--spacing-scale));
      font-size: calc(1rem * var(--scale-factor));
    }
    
    /* Модальное окно подтверждения удаления */
    .confirm-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .confirm-modal.active {
      display: flex;
    }
    
    .confirm-content {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(8px * var(--element-scale));
      max-width: calc(500px * var(--element-scale));
      width: 100%;
      text-align: center;
    }
    
    .confirm-buttons {
      display: flex;
      justify-content: center;
      gap: calc(15px * var(--spacing-scale));
      margin-top: calc(20px * var(--spacing-scale));
    }
    
    /* О сайте */
    .about-content {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(8px * var(--element-scale));
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }
    
    .about-content p {
      margin-bottom: calc(20px * var(--spacing-scale));
      line-height: 1.8;
      color: var(--text-color);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(calc(250px * var(--element-scale)), 1fr));
      gap: calc(20px * var(--spacing-scale));
      margin-top: calc(30px * var(--spacing-scale));
    }
    
    .feature {
      text-align: center;
      padding: calc(20px * var(--spacing-scale));
      background: var(--input-bg);
      border-radius: calc(8px * var(--element-scale));
      transition: 0.3s;
    }
    
    .feature:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    
    .feature i {
      font-size: calc(40px * var(--element-scale));
      color: var(--primary);
      margin-bottom: calc(15px * var(--spacing-scale));
    }
    
    .feature h3 {
      margin-bottom: calc(10px * var(--spacing-scale));
      color: var(--primary);
      font-size: calc(1.2rem * var(--scale-factor));
    }
    
    /* Футер */
    footer {
      background: var(--nav-bg);
      padding: calc(40px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      text-align: center;
      margin-top: calc(60px * var(--spacing-scale));
      border-top: calc(2px * var(--element-scale)) solid var(--primary);
      transition: background-color 0.3s;
    }
    
    .footer-content {
      max-width: calc(1200px * var(--element-scale));
      margin: 0 auto;
    }
    
    .social-links {
      display: flex;
      justify-content: center;
      margin: calc(20px * var(--spacing-scale)) 0;
    }
    
    .social-links a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: calc(40px * var(--element-scale));
      height: calc(40px * var(--element-scale));
      border-radius: 50%;
      background: var(--card-bg);
      color: var(--text-color);
      margin: 0 calc(10px * var(--spacing-scale));
      transition: 0.3s;
    }
    
    .social-links a:hover {
      background: var(--primary);
      transform: translateY(calc(-3px * var(--element-scale)));
    }
    
    .copyright {
      color: var(--gray);
      margin-top: calc(20px * var(--spacing-scale));
      font-size: calc(1rem * var(--scale-factor));
    }
    
    /* Бейджи сложности */
    .difficulty-badge {
      display: inline-block;
      padding: calc(3px * var(--spacing-scale)) calc(8px * var(--spacing-scale));
      border-radius: calc(12px * var(--element-scale));
      font-size: calc(12px * var(--scale-factor));
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .difficulty-easy {
      background-color: var(--easy);
      color: white;
    }
    
    .difficulty-medium {
      background-color: var(--medium);
      color: #333;
    }
    
    .difficulty-hard {
      background-color: var(--hard);
      color: white;
    }
    
    /* Рейтинг */
    .rating {
      display: flex;
      align-items: center;
      gap: calc(5px * var(--spacing-scale));
    }
    
    .rating-stars {
      color: var(--warning);
    }
    
    /* Теги */
    .tags {
      display: flex;
      flex-wrap: wrap;
      gap: calc(5px * var(--spacing-scale));
      margin-top: calc(10px * var(--spacing-scale));
    }
    
    .tag {
      background: var(--primary-light);
      color: white;
      padding: calc(3px * var(--spacing-scale)) calc(8px * var(--spacing-scale));
      border-radius: calc(12px * var(--element-scale));
      font-size: calc(12px * var(--scale-factor));
    }
    
    /* Карточка с улучшенной информацией */
    .video-details {
      display: flex;
      flex-direction: column;
      gap: calc(10px * var(--spacing-scale));
      margin-top: calc(10px * var(--spacing-scale));
    }
    
    .video-detail {
      display: flex;
      align-items: center;
      gap: calc(8px * var(--spacing-scale));
      font-size: calc(14px * var(--scale-factor));
      color: var(--gray);
    }
    
    .video-detail i {
      color: var(--primary);
    }
    
    /* Анимации */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Адаптивность */
    @media (max-width: 1024px) {
      .nav-links li {
        margin-left: calc(12px * var(--spacing-scale));
      }
      
      .hero-content h1 {
        font-size: calc(40px * var(--heading-scale));
      }
      
      .video-grid {
        grid-template-columns: repeat(auto-fill, minmax(calc(280px * var(--element-scale)), 1fr));
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (max-width: 768px) {
      .nav-container {
        flex-wrap: wrap;
      }
      
      .menu-toggle {
        display: flex;
      }
      
      .nav-links {
        position: fixed;
        top: calc(72px * var(--element-scale));
        left: -100%;
        width: 80%;
        height: calc(100vh - 72px * var(--element-scale));
        background: var(--nav-bg);
        flex-direction: column;
        padding: calc(20px * var(--spacing-scale));
        transition: 0.3s;
        z-index: 99;
      }
      
      .nav-links.active {
        left: 0;
      }
      
      .nav-links li {
        margin: calc(15px * var(--spacing-scale)) 0;
      }
      
      .language-switcher {
        margin: calc(15px * var(--spacing-scale)) 0 0 0;
        justify-content: center;
      }
      
      .theme-switcher {
        margin: calc(15px * var(--spacing-scale)) auto;
      }
      
      .hero-content h1 {
        font-size: calc(36px * var(--heading-scale));
      }
      
      .hero-content p {
        font-size: calc(18px * var(--scale-factor));
      }
      
      .hero-buttons {
        flex-direction: column;
      }
      
      .video-grid {
        grid-template-columns: 1fr;
      }
      
      .collections-container {
        grid-template-columns: 1fr;
      }
      
      .upload-types {
        flex-direction: column;
      }
      
      .advanced-filters {
        grid-template-columns: 1fr;
      }
      
      .admin-video-item {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .admin-video-item .btn {
        margin-top: calc(10px * var(--spacing-scale));
        align-self: flex-end;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .maps-grid {
        grid-template-columns: 1fr;
      }

      .grenades-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .nav-container {
        padding: 0 calc(15px * var(--spacing-scale));
      }
      
      .logo {
        font-size: calc(20px * var(--heading-scale));
      }
      
      .logo i {
        font-size: calc(24px * var(--element-scale));
      }
      
      .hero {
        height: calc(400px * var(--element-scale));
      }
      
      .hero-content h1 {
        font-size: calc(32px * var(--heading-scale));
      }
      
      .hero-content p {
        font-size: calc(16px * var(--scale-factor));
      }
      
      .section-title {
        font-size: calc(28px * var(--heading-scale));
      }
      
      .search-filters,
      .upload-form,
      .admin-panel,
      .about-content {
        padding: calc(20px * var(--spacing-scale));
      }
      
      .video-info,
      .collection-info {
        padding: calc(12px * var(--spacing-scale));
      }
      
      .video-title,
      .collection-title {
        font-size: calc(16px * var(--scale-factor));
      }
      
      .modal-body {
        padding: calc(15px * var(--spacing-scale));
      }
      
      .modal-title {
        font-size: calc(20px * var(--scale-factor));
      }
      .map-image {
        transition: transform 0.3s ease;
      }
    }

    /* Новые стили для системы аккаунтов */
    .auth-section {
      max-width: 400px;
      margin: 0 auto;
    }

    .auth-form {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(8px * var(--element-scale));
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .auth-tabs {
      display: flex;
      margin-bottom: calc(20px * var(--spacing-scale));
    }

    .auth-tab {
      flex: 1;
      padding: calc(12px * var(--spacing-scale));
      background: var(--input-bg);
      border: none;
      color: var(--text-color);
      cursor: pointer;
      transition: 0.3s;
    }

    .auth-tab.active {
      background: var(--primary);
    }

    .user-menu {
      position: relative;
    }

    .user-avatar {
      width: calc(40px * var(--element-scale));
      height: calc(40px * var(--element-scale));
      border-radius: 50%;
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }

    .user-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: var(--card-bg);
      border-radius: calc(8px * var(--element-scale));
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      min-width: calc(200px * var(--element-scale));
      display: none;
      z-index: 100;
    }

    .user-dropdown.active {
      display: block;
    }

    .user-dropdown-item {
      padding: calc(12px * var(--spacing-scale));
      display: flex;
      align-items: center;
      gap: calc(10px * var(--spacing-scale));
      cursor: pointer;
      transition: 0.3s;
    }

    .user-dropdown-item:hover {
      background: var(--card-hover);
    }

    .user-dropdown-item i {
      width: calc(20px * var(--element-scale));
      text-align: center;
    }

    .collection-select-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .collection-select-modal.active {
      display: flex;
    }

    .collection-select-content {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(8px * var(--element-scale));
      max-width: calc(500px * var(--element-scale));
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .collection-select-list {
      margin: calc(20px * var(--spacing-scale)) 0;
    }

    .collection-select-item {
      padding: calc(15px * var(--spacing-scale));
      border-bottom: calc(1px * var(--element-scale)) solid var(--border-color);
      cursor: pointer;
      transition: 0.3s;
    }

    .collection-select-item:hover {
      background: var(--card-hover);
    }

    .collection-select-item:last-child {
      border-bottom: none;
    }

    .admin-user-list {
      margin-top: calc(20px * var(--spacing-scale));
    }

    .admin-user-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: calc(15px * var(--spacing-scale));
      border-bottom: calc(1px * var(--element-scale)) solid var(--border-color);
    }

    .admin-user-item:last-child {
      border-bottom: none;
    }

    .user-role {
      display: inline-block;
      padding: calc(3px * var(--spacing-scale)) calc(8px * var(--spacing-scale));
      border-radius: calc(12px * var(--element-scale));
      font-size: calc(12px * var(--scale-factor));
      font-weight: 600;
    }

    .role-admin {
      background-color: var(--danger);
      color: white;
    }

    .role-moderator {
      background-color: var(--info);
      color: white;
    }

    .role-user {
      background-color: var(--gray);
      color: white;
    }

    .featured-videos-manager {
      margin-top: calc(30px * var(--spacing-scale));
    }

    .featured-videos-list {
      margin: calc(20px * var(--spacing-scale)) 0;
    }

    .featured-video-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: calc(15px * var(--spacing-scale));
      border-bottom: calc(1px * var(--element-scale)) solid var(--border-color);
    }

    .featured-video-item:last-child {
      border-bottom: none;
    }

    /* Обновленные стили для кнопок авторизации */
    .auth-buttons {
      display: flex;
      gap: calc(10px * var(--spacing-scale));
      margin-left: calc(15px * var(--spacing-scale));
    }

    .auth-btn {
      padding: calc(8px * var(--spacing-scale)) calc(16px * var(--spacing-scale));
      background: transparent;
      border: calc(1px * var(--element-scale)) solid var(--primary);
      color: var(--primary);
      border-radius: calc(6px * var(--element-scale));
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: calc(14px * var(--scale-factor));
    }

    .auth-btn:hover {
      background: var(--primary);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(255, 69, 0, 0.3);
    }

    .auth-btn-primary {
      background: var(--primary);
      color: white;
    }

    .auth-btn-primary:hover {
      background: var(--primary-dark);
    }

    /* Обновленные стили для вкладок администратора */
    .admin-tabs {
      display: flex;
      gap: calc(10px * var(--spacing-scale));
      margin-bottom: calc(20px * var(--spacing-scale));
      border-bottom: calc(1px * var(--element-scale)) solid var(--border-color);
      padding-bottom: calc(10px * var(--spacing-scale));
    }

    .admin-tab-btn {
      padding: calc(10px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      background: transparent;
      border: none;
      color: var(--text-color);
      border-radius: calc(6px * var(--element-scale));
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: calc(14px * var(--scale-factor));
      position: relative;
    }

    .admin-tab-btn.active {
      background: var(--primary);
      color: white;
    }

    .admin-tab-btn:hover:not(.active) {
      background: var(--card-hover);
    }

    /* Обновленные стили для коллекций */
    .collections-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(calc(250px * var(--element-scale)), 1fr));
      gap: calc(20px * var(--spacing-scale));
      margin-top: calc(30px * var(--spacing-scale));
    }

    .collection-item {
      background: var(--card-bg);
      border-radius: calc(12px * var(--element-scale));
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      cursor: pointer;
      aspect-ratio: 1 / 1;
      display: flex;
      flex-direction: column;
    }

    .collection-item:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .collection-item-thumb {
      flex: 1;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .collection-item-thumb i {
      font-size: calc(3rem * var(--element-scale));
      color: rgba(255, 255, 255, 0.9);
    }

    .collection-item-count {
      position: absolute;
      top: calc(10px * var(--spacing-scale));
      right: calc(10px * var(--spacing-scale));
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: calc(5px * var(--spacing-scale)) calc(10px * var(--spacing-scale));
      border-radius: calc(20px * var(--element-scale));
      font-size: calc(12px * var(--scale-factor));
    }

    .collection-item-info {
      padding: calc(15px * var(--spacing-scale));
    }

    .collection-item-title {
      font-size: calc(16px * var(--scale-factor));
      font-weight: 600;
      margin-bottom: calc(5px * var(--spacing-scale));
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .collection-item-desc {
      color: var(--gray);
      font-size: calc(12px * var(--scale-factor));
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    /* Стили для модального окна добавления в быстрый старт */
    .featured-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
      padding: calc(20px * var(--spacing-scale));
    }

    .featured-modal.active {
      display: flex;
    }

    .featured-content {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(12px * var(--element-scale));
      max-width: calc(600px * var(--element-scale));
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .featured-video-list {
      margin: calc(20px * var(--spacing-scale)) 0;
      max-height: 400px;
      overflow-y: auto;
    }

    .featured-video-select-item {
      padding: calc(15px * var(--spacing-scale));
      border-bottom: calc(1px * var(--element-scale)) solid var(--border-color);
      cursor: pointer;
      transition: 0.3s;
      display: flex;
      align-items: center;
      gap: calc(15px * var(--spacing-scale));
    }

    .featured-video-select-item:hover {
      background: var(--card-hover);
    }

    .featured-video-select-item:last-child {
      border-bottom: none;
    }

    .featured-video-thumb {
      width: calc(80px * var(--element-scale));
      height: calc(60px * var(--element-scale));
      background: #333;
      border-radius: calc(4px * var(--element-scale));
      overflow: hidden;
      flex-shrink: 0;
    }

    .featured-video-info {
      flex: 1;
    }

    .featured-video-title {
      font-weight: 600;
      margin-bottom: calc(5px * var(--spacing-scale));
      font-size: calc(14px * var(--scale-factor));
    }

    .featured-video-meta {
      color: var(--gray);
      font-size: calc(12px * var(--scale-factor));
    }

    /* Стили для удаления аккаунта */
    .delete-account-section {
      margin-top: calc(30px * var(--spacing-scale));
      padding: calc(20px * var(--spacing-scale));
      background: var(--input-bg);
      border-radius: calc(8px * var(--element-scale));
      border-left: calc(4px * var(--element-scale)) solid var(--danger);
    }

    .delete-account-btn {
      background: var(--danger);
      color: white;
      border: none;
      padding: calc(10px * var(--spacing-scale)) calc(20px * var(--spacing-scale));
      border-radius: calc(6px * var(--element-scale));
      cursor: pointer;
      transition: 0.3s;
      font-weight: 600;
    }

    .delete-account-btn:hover {
      background: var(--danger-dark);
    }

    /* Новые стили для улучшения UI */
    
    /* Модальное окно создания коллекции */
    .collection-create-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .collection-create-modal.active {
      display: flex;
    }

    .collection-create-content {
      background: var(--card-bg);
      padding: calc(30px * var(--spacing-scale));
      border-radius: calc(12px * var(--element-scale));
      max-width: calc(500px * var(--element-scale));
      width: 100%;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .collection-create-title {
      font-size: calc(24px * var(--scale-factor));
      margin-bottom: calc(20px * var(--spacing-scale));
      color: var(--primary);
      text-align: center;
    }

    .collection-create-form {
      display: flex;
      flex-direction: column;
      gap: calc(15px * var(--spacing-scale));
    }

    .collection-create-input {
      padding: calc(12px * var(--spacing-scale));
      border: calc(1px * var(--element-scale)) solid var(--border-color);
      border-radius: calc(6px * var(--element-scale));
      background: var(--input-bg);
      color: var(--text-color);
      font-size: calc(16px * var(--scale-factor));
    }

    .collection-create-input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .collection-create-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: calc(20px * var(--spacing-scale));
    }

    /* Крестик для закрытия модальных окон */
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: calc(20px * var(--spacing-scale));
    }

    .modal-close-btn {
      background: transparent;
      border: none;
      color: var(--text-color);
      font-size: calc(24px * var(--scale-factor));
      cursor: pointer;
      transition: color 0.3s;
    }

    .modal-close-btn:hover {
      color: var(--primary);
    }

    /* Улучшенные стили для коллекций */
    .collections-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(calc(280px * var(--element-scale)), 1fr));
      gap: calc(25px * var(--spacing-scale));
      margin-top: calc(30px * var(--spacing-scale));
    }

    .collection-gallery-item {
      background: var(--card-bg);
      border-radius: calc(12px * var(--element-scale));
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      cursor: pointer;
      aspect-ratio: 1 / 1;
      display: flex;
      flex-direction: column;
    }

    .collection-gallery-item:hover {
      transform: translateY(calc(-5px * var(--element-scale)));
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .collection-gallery-thumb {
      flex: 1;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .collection-gallery-thumb i {
      font-size: calc(3rem * var(--element-scale));
      color: rgba(255, 255, 255, 0.9);
    }

    .collection-gallery-count {
      position: absolute;
      top: calc(10px * var(--spacing-scale));
      right: calc(10px * var(--spacing-scale));
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: calc(5px * var(--spacing-scale)) calc(10px * var(--spacing-scale));
      border-radius: calc(20px * var(--element-scale));
      font-size: calc(12px * var(--scale-factor));
    }

    .collection-gallery-info {
      padding: calc(15px * var(--spacing-scale));
    }

    .collection-gallery-title {
      font-size: calc(16px * var(--scale-factor));
      font-weight: 600;
      margin-bottom: calc(5px * var(--spacing-scale));
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .collection-gallery-desc {
      color: var(--gray);
      font-size: calc(12px * var(--scale-factor));
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    /* Улучшенные стили для сообщения о необходимости входа */
    .collections-login-prompt {
      text-align: center;
      margin-bottom: 30px;
      padding: 40px 20px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .collections-login-prompt i {
      font-size: 60px;
      color: var(--primary);
      margin-bottom: 20px;
    }

    .collections-login-prompt h3 {
      margin-bottom: 15px;
      color: var(--text-color);
    }

    .collections-login-prompt p {
      color: var(--gray);
      margin-bottom: 25px;
    }
  </style>
</head>
<body>

  <!-- Навигация -->
  <nav>
    <div class="nav-container">
      <a href="#" class="logo" onclick="showSection('home'); return false;">
        <i class="fas fa-bomb"></i>
        <span data-translate="logo">NadeSpot</span>
      </a>
      
      <div class="menu-toggle" id="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
      </div>
      
      <ul class="nav-links" id="nav-links">
        <li><a href="#" class="active" data-section="home" data-translate="nav_home">Главная</a></li>
        <li><a href="#" data-section="videos" data-translate="nav_videos">Видео</a></li>
        <li><a href="#" data-section="collections" data-translate="nav_collections">Коллекции</a></li>
        <li id="upload-nav" style="display: none;"><a href="#" data-section="upload" data-translate="nav_upload">Загрузить</a></li>
        <li id="admin-nav" style="display: none;"><a href="#" data-section="admin" data-translate="nav_admin">Управление</a></li>
        <li><a href="#" data-section="about" data-translate="nav_about">О сайте</a></li>
        
        <!-- Перемещенные элементы управления -->
        <li>
          <div class="language-switcher">
            <button class="lang-btn active" data-lang="ru">RU</button>
            <button class="lang-btn" data-lang="uk">UA</button>
            <button class="lang-btn" data-lang="en">EN</button>
          </div>
        </li>
        
        <li>
          <div class="theme-switcher" id="theme-switcher">
            <i class="fas fa-sun theme-icon sun"></i>
            <i class="fas fa-moon theme-icon moon"></i>
          </div>
        </li>
        
        <!-- Кнопки авторизации/пользовательское меню -->
        <li id="auth-buttons" class="auth-buttons">
          <button class="auth-btn" onclick="showSection('auth')" data-translate="auth_login">Вход</button>
          <button class="auth-btn auth-btn-primary" onclick="showSection('auth'); showAuthTab('register')" data-translate="auth_register">Регистрация</button>
        </li>
        
        <li id="user-menu" class="user-menu" style="display: none;">
          <div class="user-avatar" id="user-avatar" onclick="toggleUserDropdown()">U</div>
          <div class="user-dropdown" id="user-dropdown">
            <div class="user-dropdown-item" onclick="showSection('account')">
              <i class="fas fa-user"></i>
              <span data-translate="account_settings">Настройки аккаунта</span>
            </div>
            <div class="user-dropdown-item" onclick="logout()">
              <i class="fas fa-sign-out-alt"></i>
              <span data-translate="auth_logout">Выйти</span>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Уведомления -->
  <div class="notification" id="notification"></div>

  <!-- Главная -->
  <section id="home" class="active">
    <div class="hero">
      <div class="hero-content">
        <h1 class="animate__animated animate__fadeInDown" data-translate="hero_title">Лучшие гранаты в CS2</h1>
        <p class="animate__animated animate__fadeInUp" data-translate="hero_text">Изучайте, практикуйте и совершенствуйте свои навыки владения гранатами</p>
        <div class="hero-buttons">
          <a href="#" class="btn" data-section="videos" data-translate="hero_btn_watch">Смотреть гранаты</a>
          <a href="#" class="btn btn-outline" id="upload-btn-main" data-section="upload" data-translate="hero_btn_upload" style="display: none;">Загрузить видео</a>
        </div>
      </div>
    </div>

    <!-- Статистика -->
    <div class="stats-section">
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-number" id="total-videos">0</div>
          <div class="stat-label" data-translate="total_videos">Всего видео</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="user-collections-count">0</div>
          <div class="stat-label" data-translate="total_collections">Мои коллекции</div>
        </div>
        </div>
      </div>
    </div>

  <!-- Популярные карты -->
    <div class="maps-section">
      <h2 class="section-title" data-translate="popular_maps">Популярные карты</h2>
      <p class="section-subtitle" data-translate="maps_subtitle">Изучайте гранаты на самых популярных картах CS2</p>
      
      <div class="maps-grid">
      <div class="map-card" onclick="filterByMap('Mirage')">
    <div class="map-image" style="background-image: url('https://fv5-2.files.fm/thumb_show.php?i=4tesm5beah&view&v=1&PHPSESSID=c85d7603ce45ecb98d2b05f68aa241419cdcf330')">
      <div class="map-overlay">
        <i class="fas fa-map"></i> Mirage
      </div>
    </div>
    <div class="map-info">
      <div class="map-name">Mirage</div>
      <div class="map-stats">
        <span id="mirage-count" data-translate="grenades_count" data-count="0">0 Гранат</span>
      </div>
    </div>
  </div>
  
  <div class="map-card" onclick="filterByMap('Overpass')">
    <div class="map-image" style="background-image: url('https://fv5-2.files.fm/thumb_show.php?i=hjq975pr2r&view&v=1&PHPSESSID=a55fb6a286523c77371be1b3669abdb581c00dfc')">
      <div class="map-overlay">
        <i class="fas fa-map"></i> Overpass
      </div>
    </div>
    <div class="map-info">
      <div class="map-name">Overpass</div>
      <div class="map-stats">
        <span id="dust2-count" data-translate="grenades_count" data-count="0">0 Гранат</span>
      </div>
    </div>
  </div>
  <div class="map-card" onclick="filterByMap('Ancient')">
    <div class="map-image" style="background-image: url('https://fv5-2.files.fm/thumb_show.php?i=e57sv998c4&view&v=1&PHPSESSID=c85d7603ce45ecb98d2b05f68aa241419cdcf330')">
      <div class="map-overlay">
        <i class="fas fa-map"></i> Ancient
      </div>
               </div>
               <div class="map-info">
               <div class="map-name">Ancient</div>
               <div class="map-stats">
             <span id="ancient-count" data-translate="grenades_count" data-count="0">0 Гранат</span>
           </div>
         </div>
       </div>
    </div>

    <!-- Типы гранат -->
    <div class="grenades-section">
      <h2 class="section-title" data-translate="grenade_types">Типы гранат</h2>
      <p class="section-subtitle" data-translate="grenades_subtitle">Изучите все виды гранат и их применение</p>
      
      <div class="grenades-grid">
        <div class="grenade-card">
          <div class="grenade-icon">
            <i class="fas fa-smog"></i>
          </div>
          <div class="grenade-name" data-translate="filter_smoke">Дымовые</div>
          <div class="grenade-desc" data-translate="smoke_desc">Создают дымовую завесу для скрытия перемещений и блокировки обзора</div>
        </div>
        
        <div class="grenade-card">
          <div class="grenade-icon">
            <i class="fas fa-bolt"></i>
          </div>
          <div class="grenade-name" data-translate="filter_flash">Светошумовые</div>
          <div class="grenade-desc" data-translate="flash_desc">Ослепляют противников на короткое время, позволяя зайти с фланга</div>
        </div>
        
        <div class="grenade-card">
          <div class="grenade-icon">
            <i class="fas fa-fire"></i>
          </div>
          <div class="grenade-name" data-translate="filter_molotov">Зажигательные</div>
          <div class="grenade-desc" data-translate="molotov_desc">Создают зону огня, нанося урон и вынуждая противников покинуть позицию</div>
        </div>
        
        <div class="grenade-card">
          <div class="grenade-icon">
            <i class="fas fa-bomb"></i>
          </div>
          <div class="grenade-name" data-translate="filter_he">Осколочные</div>
          <div class="grenade-desc" data-translate="he_desc">Наносят прямой урон противникам в радиусе взрыва</div>
        </div>
      </div>
    </div>

    <!-- Быстрый старт -->
    <div class="maps-section">
      <h2 class="section-title" data-translate="quick_start">Быстрый старт</h2>
      <p class="section-subtitle" data-translate="quick_start_subtitle">Начните изучение с самых эффективных гранат</p>
      
      <div class="video-grid" id="featured-videos">
        <!-- Избранные видео будут добавляться здесь -->
      </div>
    </div>
  </section>

  <!-- Видео -->
  <section id="videos">
    <h2 class="section-title" data-translate="videos_title">Популярные гранаты</h2>
    <p class="section-subtitle" data-translate="videos_subtitle">Изучайте проверенные гранаты от профессиональных игроков</p>
    
    <div class="search-filters">
      <div class="search-box">
        <input type="text" id="search-input" data-placeholder="search_placeholder" placeholder="Поиск по названию, карте или описанию...">
        <button onclick="searchVideos()"><i class="fas fa-search"></i></button>
      </div>
      
      <div class="advanced-filters">
        <div class="filter-group">
          <label for="filter-category" data-translate="filter_category">Категория</label>
          <select id="filter-category" onchange="filterVideos()">
            <option value="all" data-translate="filter_all">Все категории</option>
            <option value="smoke" data-translate="filter_smoke">Дымовые</option>
            <option value="flash" data-translate="filter_flash">Светошумовые</option>
            <option value="molotov" data-translate="filter_molotov">Зажигательные</option>
            <option value="he" data-translate="filter_he">Осколочные</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filter-map" data-translate="filter_map">Карта</label>
          <select id="filter-map" onchange="filterVideos()">
            <option value="all" data-translate="filter_all">Все карты</option>
            <option value="Mirage">Mirage</option>
            <option value="Overpass">Overpass</option>
            <option value="Ancient">Ancient</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filter-position" data-translate="filter_position">Позиция</label>
          <select id="filter-position" onchange="filterVideos()">
            <option value="all" data-translate="filter_all">Все позиции</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="mid">Mid</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filter-side" data-translate="filter_side">Сторона</label>
          <select id="filter-side" onchange="filterVideos()">
            <option value="all" data-translate="filter_both">Обе стороны</option>
            <option value="CT" data-translate="filter_ct">Контр-террористы</option>
            <option value="T" data-translate="filter_t">Террористы</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filter-difficulty" data-translate="filter_difficulty">Сложность</label>
          <select id="filter-difficulty" onchange="filterVideos()">
            <option value="all" data-translate="filter_all">Любая</option>
            <option value="easy" data-translate="upload_difficulty_easy">Легкая</option>
            <option value="medium" data-translate="upload_difficulty_medium">Средняя</option>
            <option value="hard" data-translate="upload_difficulty_hard">Сложная</option>
          </select>
        </div>
      </div>
    </div>
    
    <div class="categories">
      <button class="category-btn active" data-filter="all" data-translate="filter_all">Все</button>
      <button class="category-btn" data-filter="smoke" data-translate="filter_smoke">Дымовые</button>
      <button class="category-btn" data-filter="flash" data-translate="filter_flash">Светошумовые</button>
      <button class="category-btn" data-filter="molotov" data-translate="filter_molotov">Зажигательные</button>
      <button class="category-btn" data-filter="he" data-translate="filter_he">Осколочные</button>
    </div>
    
    <div class="video-grid" id="video-container">
      <!-- Видео будут добавляться динамически -->
    </div>
  </section>

  <!-- Коллекции -->
  <section id="collections">
    <h2 class="section-title" data-translate="collections_title">Коллекции</h2>
    <p class="section-subtitle" data-translate="collections_subtitle">Организуйте свои любимые гранаты в коллекции для быстрого доступа</p>
    
    <div id="collections-login-prompt" class="collections-login-prompt">
      <i class="fas fa-user-lock"></i>
      <h3 data-translate="collections_login_title">Для создания коллекций необходима авторизация</h3>
      <p data-translate="collections_login_text">Войдите в аккаунт, чтобы создавать и управлять своими коллекциями</p>
      <div class="hero-buttons" style="justify-content: center; margin-top: 20px;">
        <button class="btn" onclick="showSection('auth')" data-translate="auth_login">Войти в аккаунт</button>
      </div>
    </div>
    
    <div class="hero-buttons" style="justify-content: center; margin-bottom: 30px; display: none;" id="collections-buttons">
      <button class="btn" onclick="openCreateCollectionModal()">
        <i class="fas fa-plus"></i> <span data-translate="collections_create">Создать коллекцию</span>
      </button>
      <button class="btn btn-info" onclick="showSection('favorites')">
        <i class="fas fa-star"></i> <span data-translate="collections_favorites">Избранное</span>
      </button>
    </div>
    
    <div class="collections-gallery" id="collections-container">
      <!-- Коллекции будут добавляться динамически -->
    </div>

    <!-- View for a single collection (hidden by default) -->
    <div id="collection-view" style="display:none; margin-top:30px;">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <div>
          <button class="btn" id="collection-back-btn" onclick="closeCollectionView()" style="display:none;">
            <span data-translate="collections_back">← Назад к коллекциям</span>
          </button>
        </div>
        <div id="collection-view-title" style="font-weight:700; font-size:18px;"></div>
        <div></div>
      </div>
      <div id="collection-videos-container" class="video-grid"></div>
    </div>
  </section>

  <!-- Избранное -->
  <section id="favorites">
    <h2 class="section-title" data-translate="favorites_title">Избранные гранаты</h2>
    <p class="section-subtitle" data-translate="favorites_subtitle">Ваши любимые гранаты всегда под рукой</p>
    
    <div class="video-grid" id="favorites-container">
      <!-- Избранные видео будут добавляться динамически -->
    </div>
  </section>

  <!-- Загрузка видео -->
  <section id="upload">
    <h2 class="section-title" data-translate="upload_title">Загрузить видео</h2>
    <p class="section-subtitle" data-translate="upload_subtitle">Поделитесь своими уникальными гранатами с сообществом</p>
    
    <div class="upload-form">
      <div class="upload-types">
        <button class="upload-type-btn active" data-type="file" data-translate="upload_type_file">Файл видео</button>
        <button class="upload-type-btn" data-type="youtube" data-translate="upload_type_youtube">YouTube ссылка</button>
      </div>
      
      <div id="file-upload-section">
        <div class="file-upload" id="drop-zone">
          <i class="fas fa-cloud-upload-alt"></i>
          <p data-translate="upload_drag">Перетащите видеофайл сюда или</p>
          <label for="video-file" class="btn" data-translate="upload_select">Выбрать файл</label>
          <input type="file" id="video-file" accept="video/*" style="display: none;">
        </div>
      </div>
      
      <div id="youtube-upload-section" style="display: none;">
        <div class="form-group">
          <label for="youtube-url" data-translate="upload_youtube_label">Ссылка на YouTube видео</label>
          <input type="url" id="youtube-url" class="form-control" data-placeholder="upload_youtube_placeholder" placeholder="https://www.youtube.com/watch?v=...">
        </div>
      </div>
      
      <div class="form-group">
        <label for="video-title" data-translate="upload_title_label">Название видео</label>
        <input type="text" id="video-title" class="form-control" data-placeholder="upload_title_placeholder" placeholder="Введите название видео">
      </div>
      
      <div class="form-group">
        <label for="video-category" data-translate="upload_category_label">Категория гранаты</label>
        <select id="video-category" class="form-control">
          <option value="" data-translate="upload_category_select">Выберите категорию</option>
          <option value="smoke" data-translate="filter_smoke">Дымовая</option>
          <option value="flash" data-translate="filter_flash">Светошумовая</option>
          <option value="molotov" data-translate="filter_molotov">Зажигательная</option>
          <option value="he" data-translate="filter_he">Осколочная</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-map" data-translate="upload_map_label">Карта</label>
        <select id="video-map" class="form-control">
          <option value="" data-translate="upload_map_select">Выберите карту</option>
          <option value="Mirage">Mirage</option>
          <option value="Overpass">Overpass</option>
          <option value="Ancient">Ancient</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-position" data-translate="upload_position_label">Позиция</label>
        <select id="video-position" class="form-control">
          <option value="" data-translate="upload_position_select">Выберите позицию</option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="mid">Mid</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-side" data-translate="upload_side_label">Сторона</label>
        <select id="video-side" class="form-control">
          <option value="" data-translate="upload_side_select">Выберите сторону</option>
          <option value="CT" data-translate="filter_ct">Контр-террористы</option>
          <option value="T" data-translate="filter_t">Террористы</option>
          <option value="both" data-translate="filter_both">Обе стороны</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-difficulty" data-translate="upload_difficulty_label">Сложность</label>
        <select id="video-difficulty" class="form-control">
          <option value="" data-translate="upload_difficulty_select">Выберите сложность</option>
          <option value="easy" data-translate="upload_difficulty_easy">Легкая</option>
          <option value="medium" data-translate="upload_difficulty_medium">Средняя</option>
          <option value="hard" data-translate="upload_difficulty_hard">Сложная</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="video-description" data-translate="upload_description_label">Описание</label>
        <textarea id="video-description" class="form-control" data-placeholder="upload_description_placeholder" placeholder="Опишите гранату"></textarea>
      </div>
      
      <button class="btn" style="width: 100%;" onclick="uploadVideo()" data-translate="upload_btn">Загрузить видео</button>
    </div>
  </section>

  <!-- Панель администратора -->
  <section id="admin">
    <h2 class="section-title" data-translate="admin_title">Управление</h2>
    <p class="section-subtitle" data-translate="admin_subtitle">Управляйте контентом и пользователями</p>
    
    <div class="admin-panel">
      <div class="admin-tabs">
        <button class="admin-tab-btn active" onclick="showAdminTab('videos')" data-translate="admin_videos_tab">Видео</button>
        <button class="admin-tab-btn" onclick="showAdminTab('featured')" data-translate="admin_featured_tab">Быстрый старт</button>
      </div>
      
      <div id="admin-videos-tab">
        <h3 data-translate="admin_videos_title">Управление видео</h3>
        <p data-translate="admin_videos_description">Здесь вы можете управлять загруженными видео. Для удаления видео нажмите на кнопку "Удалить".</p>
        
        <div class="admin-video-list" id="admin-video-list">
          <!-- Список видео для управления -->
        </div>
      </div>
      
      <div id="admin-featured-tab" style="display: none;">
        <h3 data-translate="admin_featured_title">Управление разделом "Быстрый старт"</h3>
        <p data-translate="admin_featured_description">Здесь вы можете выбрать видео, которые будут отображаться в разделе "Быстрый старт" на главной странице.</p>
        
        <div class="featured-videos-manager">
          <div class="featured-videos-list" id="featured-videos-list">
            <!-- Список видео для быстрого старта -->
          </div>
          <button class="btn" onclick="openFeaturedModal()" data-translate="admin_add_featured">Добавить видео</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Авторизация -->
  <section id="auth">
    <h2 class="section-title" data-translate="auth_title">Вход в аккаунт</h2>
    <p class="section-subtitle" data-translate="auth_subtitle">Войдите в свой аккаунт или создайте новый</p>
    
    <div class="auth-section">
      <div class="auth-form">
        <div class="modal-header">
          <h3 id="auth-modal-title" data-translate="auth_title">Вход в аккаунт</h3>
          <button class="modal-close-btn" onclick="closeAuthModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <div class="auth-tabs">
          <button class="auth-tab active" onclick="showAuthTab('login')" data-translate="auth_login">Вход</button>
          <button class="auth-tab" onclick="showAuthTab('register')" data-translate="auth_register">Регистрация</button>
        </div>
        
        <div id="login-tab">
          <div class="form-group">
            <label for="login-email" data-translate="auth_email">Email</label>
            <input type="email" id="login-email" class="form-control" placeholder="">
          </div>
          
          <div class="form-group">
            <label for="login-password" data-translate="auth_password">Пароль</label>
            <input type="password" id="login-password" class="form-control" placeholder="">
          </div>
          
          <button class="btn" style="width: 100%;" onclick="login()" data-translate="auth_login">Войти</button>
        </div>
        
        <div id="register-tab" style="display: none;">
          <div class="form-group">
            <label for="register-name" data-translate="auth_name">Имя</label>
            <input type="text" id="register-name" class="form-control" placeholder="">
          </div>
          
          <div class="form-group">
            <label for="register-email" data-translate="auth_email">Email</label>
            <input type="email" id="register-email" class="form-control" placeholder="">
          </div>
          
          <div class="form-group">
            <label for="register-password" data-translate="auth_password">Пароль</label>
            <input type="password" id="register-password" class="form-control" placeholder="">
          </div>
          
          <div class="form-group">
            <label for="register-confirm-password" data-translate="auth_confirm_password">Подтвердите пароль</label>
            <input type="password" id="register-confirm-password" class="form-control" placeholder="">
          </div>
          
          <button class="btn" style="width: 100%;" onclick="register()" data-translate="auth_register">Зарегистрироваться</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Настройки аккаунта -->
  <section id="account">
    <h2 class="section-title" data-translate="account_title">Настройки аккаунта</h2>
    <p class="section-subtitle" data-translate="account_subtitle">Управляйте настройками вашего аккаунта</p>
    
    <div class="auth-section">
      <div class="auth-form">
        <div class="form-group">
          <label for="account-name" data-translate="auth_name">Имя</label>
          <input type="text" id="account-name" class="form-control">
        </div>
        
        <div class="form-group">
          <label for="account-email" data-translate="auth_email">Email</label>
          <input type="email" id="account-email" class="form-control" readonly>
        </div>
        
        <div class="form-group">
          <label for="account-current-password" data-translate="account_current_password">Текущий пароль</label>
          <input type="password" id="account-current-password" class="form-control" placeholder="">
        </div>
        
        <div class="form-group">
          <label for="account-new-password" data-translate="account_new_password">Новый пароль</label>
          <input type="password" id="account-new-password" class="form-control" placeholder="">
        </div>
        
        <div class="form-group">
          <label for="account-confirm-password" data-translate="auth_confirm_password">Подтвердите новый пароль</label>
          <input type="password" id="account-confirm-password" class="form-control" placeholder="">
        </div>
        
        <button class="btn" style="width: 100%;" onclick="updateAccount()" data-translate="account_save">Сохранить изменения</button>
        
        <div class="delete-account-section">
          <h3 data-translate="account_delete_title">Удаление аккаунта</h3>
          <p data-translate="account_delete_description">Удаление аккаунта приведет к безвозвратному удалению всех ваших данных, включая коллекции и избранное.</p>
          <button class="delete-account-btn" onclick="confirmDeleteAccount()" data-translate="account_delete_button">Удалить аккаунт</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Модальное окно видео -->
  <div class="video-modal" id="video-modal">
    <div class="modal-content">
      <div class="modal-close" onclick="closeVideo()">
        <i class="fas fa-times"></i>
      </div>
      <div class="modal-video-container" id="modal-video-container">
        <!-- Видео будет вставлено сюда -->
      </div>
      <div class="modal-body">
        <h3 class="modal-title" id="modal-title"></h3>
        <div class="modal-meta">
          <span id="modal-category"></span>
          <span id="modal-date"></span>
        </div>
        <p class="modal-description" id="modal-description"></p>
        <div class="modal-stats">
          <span><i class="fas fa-map-marker-alt"></i> <span id="modal-map"></span></span>
          <span><i class="fas fa-user-shield"></i> <span id="modal-side"></span></span>
          <span><i class="fas fa-signal"></i> <span id="modal-difficulty"></span></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Модальное окно подтверждения удаления -->
  <div class="confirm-modal" id="confirm-modal">
    <div class="confirm-content">
      <h3 id="confirm-title" data-translate="confirm_title">Подтверждение удаления</h3>
      <p id="confirm-message" data-translate="confirm_message">Вы уверены, что хотите удалить эту коллекцию? Это действие нельзя отменить.</p>
      <div class="confirm-buttons">
        <button class="btn btn-danger" id="confirm-yes" data-translate="confirm_yes">Да, удалить</button>
        <button class="btn" id="confirm-no" data-translate="confirm_no">Отмена</button>
      </div>
    </div>
  </div>

  <!-- Модальное окно выбора коллекции -->
  <div class="collection-select-modal" id="collection-select-modal">
    <div class="collection-select-content">
      <h3 data-translate="collection_select_title">Выберите коллекцию</h3>
      <div class="collection-select-list" id="collection-select-list">
        <!-- Список коллекций будет добавляться динамически -->
      </div>
      <div class="confirm-buttons">
        <button class="btn" onclick="closeCollectionSelect()" data-translate="confirm_no">Отмена</button>
      </div>
    </div>
  </div>

  <!-- Модальное окно добавления в быстрый старт -->
  <div class="featured-modal" id="featured-modal">
    <div class="featured-content">
      <h3 data-translate="featured_add_title">Добавить видео в "Быстрый старт"</h3>
      <p data-translate="featured_add_description">Выберите видео для добавления в раздел "Быстрый старт" на главной странице</p>
      
      <div class="featured-video-list" id="featured-video-select-list">
        <!-- Список видео для выбора -->
      </div>
      
      <div class="confirm-buttons">
        <button class="btn" onclick="closeFeaturedModal()" data-translate="confirm_no">Отмена</button>
      </div>
    </div>
  </div>

  <!-- Модальное окно создания коллекции -->
  <div class="collection-create-modal" id="collection-create-modal">
    <div class="collection-create-content">
      <div class="modal-header">
        <h3 class="collection-create-title" data-translate="collections_create">Создать коллекцию</h3>
        <button class="modal-close-btn" onclick="closeCreateCollectionModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="collection-create-form">
        <input type="text" id="collection-create-name" class="collection-create-input" data-placeholder="upload_title_placeholder" placeholder="Название коллекции">
        <textarea id="collection-create-description" style="height: 0px; width:0px;"></textarea>
        <div class="collection-create-buttons">
          <button class="btn" onclick="closeCreateCollectionModal()" data-translate="confirm_no">Отмена</button>
          <button class="btn" onclick="createNewCollection()" data-translate="collections_create">Создать</button>
        </div>
      </div>
    </div>
  </div>

  <!-- О сайте -->
  <section id="about">
    <h2 class="section-title" data-translate="about_title">О сайте</h2>
    <p class="section-subtitle" data-translate="about_subtitle">Узнайте больше о платформе NadeSpot и нашей миссии</p>
    
    <div class="about-content">
      <p data-translate="about_text1">
        NadeSpot — это платформа для изучения и применения гранат в Counter-Strike 2. 
        Наша цель — помочь игрокам улучшить свои навыки и тактическое мышление.
      </p>
      
      <p data-translate="about_text2">
        Здесь вы найдете тщательно отобранные видео с эффективными применениями гранат на всех популярных картах. 
        Наша команда модераторов проверяет каждый материал перед публикацией.
      </p>
      
      <div class="features">
        <div class="feature">
          <i class="fas fa-filter"></i>
          <h3 data-translate="about_feature1_title">Качественный контент</h3>
          <p data-translate="about_feature1_desc">Все видео проверяются на эффективность и актуальность</p>
        </div>
        
        <div class="feature">
          <i class="fas fa-sort-amount-down"></i>
          <h3 data-translate="about_feature2_title">Удобная категоризация</h3>
          <p data-translate="about_feature2_desc">Гранаты отсортированы по типам и картам для быстрого поиска</p>
        </div>
        
        <div class="feature">
          <i class="fas fa-map-marked-alt"></i>
          <h3 data-translate="about_feature3_title">Все карты CS2</h3>
          <p data-translate="about_feature3_desc">Гранаты для всех официальных карт</p>
        </div>
        
        <div class="feature">
          <i class="fas fa-rocket"></i>
          <h3 data-translate="about_feature4_title">Актуальные стратегии</h3>
          <p data-translate="about_feature4_desc">Мы регулярно обновляем коллекцию под текущую мету игры</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Футер -->
  <footer>
    <div class="footer-content">
      <div class="logo">
        <i class="fas fa-bomb"></i>
        <span data-translate="logo">NadeSpot</span>
      </div>
      
      <div class="social-links">
        <a href="https://t.me/NadeSpot"><i class="fab fa-telegram"></i></a>
        <a href="https://discord.gg/XvqAavd865"><i class="fab fa-discord"></i></a>
      </div>
      
      <p class="copyright" data-translate="footer_copyright">NadeSpot © 2025 - Все права защищены</p>
      <p class="copyright" data-translate="footer_demo">Это демонстрационный сайт, созданный в образовательных целях</p>
    </div>
  </footer>

  <script>
    // База переводов
    const translations = {
      "ru": {
        "logo": "NadeSpot",
        "nav_home": "Главная",
        "nav_videos": "Видео",
        "nav_collections": "Коллекции",
        "nav_upload": "Загрузить",
        "nav_admin": "Управление",
        "nav_about": "О сайте",
        "hero_title": "Лучшие гранаты в CS2",
        "hero_text": "Изучайте, практикуйте и совершенствуйте свои навыки владения гранатами",
        "hero_btn_watch": "Смотреть гранаты",
        "hero_btn_upload": "Загрузить видео",
        "videos_title": "Популярные гранаты",
        "videos_subtitle": "Изучайте проверенные гранаты от профессиональных игроков",
        "search_placeholder": "Поиск по названию, карте или описанию...",
        "filter_category": "Категория",
        "filter_all": "Все",
        "filter_smoke": "Дымовые",
        "filter_flash": "Светошумовые",
        "filter_molotov": "Зажигательные",
        "filter_he": "Осколочные",
        "filter_map": "Карта",
        "filter_position": "Позиция",
        "filter_side": "Сторона",
        "filter_difficulty": "Сложность",
        "filter_both": "Обе стороны",
        "filter_ct": "Контр-террористы",
        "filter_t": "Террористы",
        "filter_sort": "Сортировка",
        "sort_newest": "Сначала новые",
        "sort_oldest": "Сначала старые",
        "sort_popular": "По популярности",
        "sort_rating": "По рейтингу",
        "collections_title": "Коллекции",
        "collections_subtitle": "Организуйте свои любимые гранаты в коллекции для быстрого доступа",
        "collections_create": "Создать коллекцию",
        "collections_favorites": "Избранное",
        "collections_back": "← Назад к коллекциям",
        "collections_login_title": "Для создания коллекций необходима авторизация",
        "collections_login_text": "Войдите в аккаунт, чтобы создавать и управлять своими коллекциями",
        "favorites_title": "Избранные гранаты",
        "favorites_subtitle": "Ваши любимые гранаты всегда под рукой",
        "upload_title": "Загрузить видео",
        "upload_subtitle": "Поделитесь своими уникальными гранатами с сообществом",
        "upload_type_file": "Файл видео",
        "upload_type_youtube": "YouTube ссылка",
        "upload_drag": "Перетащите видеофайл сюда или",
        "upload_select": "Выбрать файл",
        "upload_youtube_label": "Ссылка на YouTube видео",
        "upload_youtube_placeholder": "https://www.youtube.com/watch?v=...",
        "upload_title_label": "Название видео",
        "upload_title_placeholder": "Введите название видео",
        "upload_category_label": "Категория гранаты",
        "upload_category_select": "Выберите категорию",
        "upload_map_label": "Карта",
        "upload_map_select": "Выберите карту",
        "upload_position_label": "Позиция",
        "upload_position_select": "Выберите позицию",
        "upload_side_label": "Сторона",
        "upload_side_select": "Выберите сторону",
        "upload_difficulty_label": "Сложность",
        "upload_difficulty_select": "Выберите сложность",
        "upload_difficulty_easy": "Легкая",
        "upload_difficulty_medium": "Средняя",
        "upload_difficulty_hard": "Сложная",
        "upload_description_label": "Описание",
        "upload_description_placeholder": "Опишите гранату",
        "upload_btn": "Загрузить видео",
        "admin_title": "Управление",
        "admin_subtitle": "Управляйте контентом и пользователями",
        "admin_videos_tab": "Видео",
        "admin_featured_tab": "Быстрый старт",
        "admin_videos_title": "Управление видео",
        "admin_videos_description": "Здесь вы можете управлять загруженными видео. Для удаления видео нажмите на кнопку \"Удалить\".",
        "admin_featured_title": "Управление разделом \"Быстрый старт\"",
        "admin_featured_description": "Здесь вы можете выбрать видео, которые будут отображаться в разделе \"Быстрый старт\" на главной странице.",
        "admin_add_featured": "Добавить видео",
        "admin_delete": "Удалить",
        "auth_title": "Вход в аккаунт",
        "auth_subtitle": "Войдите в свой аккаунт или создайте новый",
        "auth_login": "Вход",
        "auth_register": "Регистрация",
        "auth_email": "Email",
        "auth_password": "Пароль",
        "auth_confirm_password": "Подтвердите пароль",
        "auth_name": "Имя",
        "auth_logout": "Выйти",
        "account_title": "Настройки аккаунта",
        "account_subtitle": "Управляйте настройками вашего аккаунта",
        "account_settings": "Настройки аккаунта",
        "account_current_password": "Текущий пароль",
        "account_new_password": "Новый пароль",
        "account_save": "Сохранить изменения",
        "account_delete_title": "Удаление аккаунта",
        "account_delete_description": "Удаление аккаунта приведет к безвозвратному удалению всех ваших данных, включая коллекции и избранное.",
        "account_delete_button": "Удалить аккаунт",
        "modal_views": "просмотров",
        "modal_favorites": "в избранном",
        "view3d_example_meta": "Дымовая граната • Mirage",
        "view3d_example_side": "CT сторона",
        "confirm_title": "Подтверждение удаления",
        "confirm_message": "Вы уверены, что хотите удалить эту коллекцию? Это действие нельзя отменить.",
        "confirm_yes": "Да, удалить",
        "confirm_no": "Отмена",
        "about_title": "О сайте",
        "about_subtitle": "Узнайте больше о платформе NadeSpot и нашей миссии",
        "about_text1": "NadeSpot — это платформа для изучения и применения гранат в Counter-Strike 2. Наша цель — помочь игрокам улучшить свои навыки и тактическое мышление.",
        "about_text2": "Здесь вы найдете тщательно отобранные видео с эффективными применениями гранат на всех популярных картах. Наша команда модераторов проверяет каждый материал перед публикацией.",
        "about_feature1_title": "Качественный контент",
        "about_feature1_desc": "Все видео проверяются на эффективность и актуальность",
        "about_feature2_title": "Удобная категоризация",
        "about_feature2_desc": "Гранаты отсортированы по типам и картам для быстрого пошука",
        "about_feature3_title": "Все карты CS2",
        "about_feature3_desc": "Гранаты для всех официальных карт",
        "about_feature4_title": "Актуальные стратегии",
        "about_feature4_desc": "Мы регулярно обновляем коллекцию под текущую мету игры",
        "footer_copyright": "NadeSpot © 2025 - Все права защищены",
        "footer_demo": "Это демонстрационный сайт, созданный в образовательных целях",
        "notification_success": "Операция выполнена успешно!",
        "notification_error": "Произошла ошибка!",
        "notification_info": "Тема изменена",
        "no_videos": "Видео не найдены",
        "no_videos_text": "Будьте первым, кто загрузит видео с гранатой!",
        "no_favorites": "Нет избранных видео",
        "no_favorites_text": "Добавляйте видео в избранное, чтобы легко находить их позже",
        "no_collections": "Коллекций пока нет",
        "no_collections_text": "Создайте свою первую коллекцию для организации видео",
        "collection_empty": "В коллекции пока нет видео",
        "video_duration": "Длительность",
        "video_views": "просмотров",
        "video_favorites": "в избранном",
        "video_add_to_collection": "Добавить в коллекцию",
        "video_remove_from_favorites": "Удалить из избранного",
        "video_add_to_favorites": "Добавить в избранное",
        "video_rating": "Рейтинг",
        "video_side": "Сторона",
        "video_map": "Карта",
        "video_tags": "Теги",
        "grenade_molotov": "Зажигательная",
        "difficulty_hard": "СЛОЖНАЯ",
        "side_ct": "Контр-террористы",
        "total_videos": "Всего видео",
        "total_collections": "Мои коллекции",
        "popular_maps": "Популярные карты",
        "maps_subtitle": "Изучайте гранаты на самых популярных картах CS2",
        "grenade": "Граната",
        "grenades": "Гранаты",
        "grenades_count": "Гранаты",
        "grenade_types": "Типы гранат",
        "grenades_subtitle": "Изучите все виды гранат и их применение",
        "smoke_desc": "Создают дымовую завесу для скрытия перемещений и блокировки обзора",
        "flash_desc": "Ослепляют противников на короткое время, позволяя зайти с фланга",
        "molotov_desc": "Создают зону огня, нанося урон и вынуждая противников покинуть позицию",
        "he_desc": "Наносят прямой урон противникам в радиусе взрыва",
        "quick_start": "Быстрый старт",
        "quick_start_subtitle": "Начните изучение с самых эффективных гранат",
        "collection_select_title": "Выберите коллекцию",
        "role_admin": "Администратор",
        "role_moderator": "Модератор",
        "role_user": "Пользователь",
        "no_collections_create": "У вас нет коллекций. Создать коллекцию",
        "featured_add_title": "Добавить видео в \"Быстрый старт\"",
        "featured_add_description": "Выберите видео для добавления в раздел \"Быстрый старт\" на главной странице",
        "featured_all_added": "Все доступные видео уже добавлены в \"Быстрый старт\""
      },
      "uk": {
        "logo": "NadeSpot",
        "nav_home": "Головна",
        "nav_videos": "Відео",
        "nav_collections": "Колекції",
        "nav_upload": "Завантажити",
        "nav_admin": "Управління",
        "nav_about": "Про сайт",
        "hero_title": "Найкращі гранати в CS2",
        "hero_text": "Вивчайте, практикуйте та вдосконалюйте свої навички володіння гранатами",
        "hero_btn_watch": "Дивитися гранати",
        "hero_btn_upload": "Завантажити відео",
        "videos_title": "Популярні гранати",
        "videos_subtitle": "Вивчайте перевірені гранати від професійних гравців",
        "search_placeholder": "Пошук за назвою, картою або описом...",
        "filter_category": "Категорія",
        "filter_all": "Всі",
        "filter_smoke": "Димові",
        "filter_flash": "Світлошумові",
        "filter_molotov": "Запалювальні",
        "filter_he": "Осколкові",
        "filter_map": "Карта",
        "filter_position": "Позиція",
        "filter_side": "Сторона",
        "filter_difficulty": "Складність",
        "filter_both": "Обидві сторони",
        "filter_ct": "Контр-терористи",
        "filter_t": "Терористи",
        "filter_sort": "Сортування",
        "sort_newest": "Спочатку нові",
        "sort_oldest": "Спочатку старі",
        "sort_popular": "За популярністю",
        "sort_rating": "За рейтингом",
        "collections_title": "Колекції",
        "collections_subtitle": "Організуйте свої улюблені гранати в колекції для швидкого доступу",
        "collections_create": "Створити колекцію",
        "collections_favorites": "Обране",
        "collections_back": "← Назад до колекцій",
        "collections_login_title": "Для створення колекцій необхідна авторизація",
        "collections_login_text": "Увійдіть в акаунт, щоб створювати та керувати своїми колекціями",
        "favorites_title": "Обрані гранати",
        "favorites_subtitle": "Ваші улюблені гранати завжди під рукою",
        "upload_title": "Завантажити відео",
        "upload_subtitle": "Поділіться своїми унікальними гранатами зі спільнотою",
        "upload_type_file": "Файл відео",
        "upload_type_youtube": "YouTube посилання",
        "upload_drag": "Перетягніть відеофайл сюди або",
        "upload_select": "Обрати файл",
        "upload_youtube_label": "Посилання на YouTube відео",
        "upload_youtube_placeholder": "https://www.youtube.com/watch?v=...",
        "upload_title_label": "Назва відео",
        "upload_title_placeholder": "Введіть назву відео",
        "upload_category_label": "Категорія гранати",
        "upload_category_select": "Оберіть категорію",
        "upload_map_label": "Карта",
        "upload_map_select": "Оберіть карту",
        "upload_position_label": "Позиція",
        "upload_position_select": "Оберіть позицію",
        "upload_side_label": "Сторона",
        "upload_side_select": "Оберіть сторону",
        "upload_difficulty_label": "Складність",
        "upload_difficulty_select": "Виберіть складність",
        "upload_difficulty_easy": "Легка",
        "upload_difficulty_medium": "Середня",
        "upload_difficulty_hard": "Складна",
        "upload_description_label": "Опис",
        "upload_description_placeholder": "Опишіть гранату",
        "upload_btn": "Завантажити відео",
        "admin_title": "Управління",
        "admin_subtitle": "Керуйте контентом та користувачами",
        "admin_videos_tab": "Відео",
        "admin_featured_tab": "Швидкий старт",
        "admin_videos_title": "Управління відео",
        "admin_videos_description": "Тут ви можете керувати завантаженими відео. Для видалення відео натисніть кнопку \"Видалити\".",
        "admin_featured_title": "Управління розділом \"Швидкий старт\"",
        "admin_featured_description": "Тут ви можете обрати відео, які будуть відображатися в розділі \"Швидкий старт\" на головній сторінці.",
        "admin_add_featured": "Додати відео",
        "admin_delete": "Видалити",
        "auth_title": "Вхід в акаунт",
        "auth_subtitle": "Увійдіть в свій акаунт або створіть новий",
        "auth_login": "Вхід",
        "auth_register": "Реєстрація",
        "auth_email": "Email",
        "auth_password": "Пароль",
        "auth_confirm_password": "Підтвердіть пароль",
        "auth_name": "Ім'я",
        "auth_logout": "Вийти",
        "account_title": "Налаштування акаунта",
        "account_subtitle": "Керуйте налаштуваннями вашого акаунта",
        "account_settings": "Налаштування акаунта",
        "account_current_password": "Поточний пароль",
        "account_new_password": "Новий пароль",
        "account_save": "Зберегти зміни",
        "account_delete_title": "Видалення акаунта",
        "account_delete_description": "Видалення акаунта призведе до безповоротного видалення всіх ваших даних, включаючи колекції та обране.",
        "account_delete_button": "Видалити акаунт",
        "modal_views": "переглядів",
        "modal_favorites": "в обраному",
        "view3d_example_meta": "Димова граната • Mirage",
        "view3d_example_side": "CT сторона",
        "confirm_title": "Підтвердження видалення",
        "confirm_message": "Ви впевнені, що хочете видалити цю колекцію? Цю дію не можна скасувати.",
        "confirm_yes": "Так, видалити",
        "confirm_no": "Скасувати",
        "about_title": "Про сайт",
        "about_subtitle": "Дізнайтесь більше про платформу NadeSpot та нашу місію",
        "about_text1": "NadeSpot — це платформа для вивчення та застосування гранат у Counter-Strike 2. Наша мета — допомогти гравцям покращити свої навички та тактичне мислення.",
        "about_text2": "Тут ви знайдете ретельно відібрані відео з ефективними застосуваннями гранат на всіх популярних картах. Наша команда модераторів перевіряє кожен матеріал перед публікацією.",
        "about_feature1_title": "Якісний контент",
        "about_feature1_desc": "Усі відео перевіряються на ефективність та актуальність",
        "about_feature2_title": "Зручна категорізація",
        "about_feature2_desc": "Гранати відсортовані за типами та картами для швидкого пошуку",
        "about_feature3_title": "Усі карти CS2",
        "about_feature3_desc": "Гранати для всіх офіційних карт",
        "about_feature4_title": "Актуальні стратегії",
        "about_feature4_desc": "Ми регулярно оновлюємо колекцію під поточну мету гри",
        "footer_copyright": "NadeSpot © 2025 - Всі права захищені",
        "footer_demo": "Це демонстраційний сайт, створений в освітніх цілях",
        "notification_success": "Операція успішно виконана!",
        "notification_error": "Сталася помилка!",
        "notification_info": "Тема змінена",
        "no_videos": "Відео не знайдено",
        "no_videos_text": "Будьте першим, хто завантажить відео з гранатою!",
        "no_favorites": "Немає обраних відео",
        "no_favorites_text": "Додавайте відео в обране, щоб легко знаходити їх пізніше",
        "no_collections": "Колекцій поки немає",
        "no_collections_text": "Створіть свою першу колекцію для організації відео",
        "collection_empty": "У колекції поки немає відео",
        "video_duration": "Тривалість",
        "video_views": "переглядів",
        "video_favorites": "в обраному",
        "video_add_to_collection": "Додати до колекції",
        "video_remove_from_favorites": "Видалити з обраного",
        "video_add_to_favorites": "Додати в обране",
        "video_rating": "Рейтинг",
        "video_side": "Сторона",
        "video_map": "Карта",
        "video_tags": "Теги",
        "grenade_molotov": "Запалювальна",
        "difficulty_hard": "СКЛАДНА",
        "side_ct": "Контр-терористи",
        "total_videos": "Усього відео",
        "total_collections": "Мої колекції",
        "popular_maps": "Популярні карти",
        "maps_subtitle": "Вивчайте гранати на найпопулярніших картах CS2",
        "grenade": "Граната",
        "grenades": "Гранати",
        "grenades_count": "Гранати",
        "grenade_types": "Типи гранат",
        "grenades_subtitle": "Вивчіть усі види гранат та їх застосування",
        "smoke_desc": "Створюють димову завісу для приховання переміщень та блокування огляду",
        "flash_desc": "Осліплюють противників на короткий час, дозволяючи зайти з флангу",
        "molotov_desc": "Створюють зону вогню, завдаючи шкоди та змушуючи противників залишити позицію",
        "he_desc": "Завдають прямого урону противникам у радіусі вибуху",
        "quick_start": "Швидкий старт",
        "quick_start_subtitle": "Почніть вивчення з найефективніших гранат",
        "collection_select_title": "Оберіть колекцію",
        "role_admin": "Адміністратор",
        "role_moderator": "Модератор",
        "role_user": "Користувач",
        "no_collections_create": "У вас немає колекцій. Створити колекцію",
        "featured_add_title": "Додати відео в \"Швидкий старт\"",
        "featured_add_description": "Оберіть відео для додавання в розділ \"Швидкий старт\" на головній сторінці",
        "featured_all_added": "Усі доступні відео вже додані в \"Швидкий старт\""
      },
      "en": {
        "logo": "NadeSpot",
        "nav_home": "Home",
        "nav_videos": "Videos",
        "nav_collections": "Collections",
        "nav_upload": "Upload",
        "nav_admin": "Management",
        "nav_about": "About",
        "hero_title": "Best grenades in CS2",
        "hero_text": "Study, practice and improve your grenade skills",
        "hero_btn_watch": "Watch grenades",
        "hero_btn_upload": "Upload video",
        "videos_title": "Popular grenades",
        "videos_subtitle": "Learn proven grenades from professional players",
        "search_placeholder": "Search by name, map or description...",
        "filter_category": "Category",
        "filter_all": "All",
        "filter_smoke": "Smoke",
        "filter_flash": "Flash",
        "filter_molotov": "Molotov",
        "filter_he": "HE Grenade",
        "filter_map": "Map",
        "filter_position": "Position",
        "filter_side": "Side",
        "filter_difficulty": "Difficulty",
        "filter_both": "Both sides",
        "filter_ct": "Counter-Terrorists",
        "filter_t": "Terrorists",
        "filter_sort": "Sort by",
        "sort_newest": "Newest first",
        "sort_oldest": "Oldest first",
        "sort_popular": "By popularity",
        "sort_rating": "By rating",
        "collections_title": "Collections",
        "collections_subtitle": "Organize your favorite grenades into collections for quick access",
        "collections_create": "Create collection",
        "collections_favorites": "Favorites",
        "collections_back": "← Back to collections",
        "collections_login_title": "Authorization required to create collections",
        "collections_login_text": "Log in to your account to create and manage your collections",
        "favorites_title": "Favorite grenades",
        "favorites_subtitle": "Your favorite grenades are always at hand",
        "upload_title": "Upload video",
        "upload_subtitle": "Share your unique grenades with the community",
        "upload_type_file": "Video file",
        "upload_type_youtube": "YouTube link",
        "upload_drag": "Drag video file here or",
        "upload_select": "Select file",
        "upload_youtube_label": "YouTube video link",
        "upload_youtube_placeholder": "https://www.youtube.com/watch?v=...",
        "upload_title_label": "Video title",
        "upload_title_placeholder": "Enter video title",
        "upload_category_label": "Grenade category",
        "upload_category_select": "Select category",
        "upload_map_label": "Map",
        "upload_map_select": "Select map",
        "upload_position_label": "Position",
        "upload_position_select": "Select position",
        "upload_side_label": "Side",
        "upload_side_select": "Select side",
        "upload_difficulty_label": "Difficulty",
        "upload_difficulty_select": "Select difficulty",
        "upload_difficulty_easy": "Easy",
        "upload_difficulty_medium": "Medium",
        "upload_difficulty_hard": "Hard",
        "upload_description_label": "Description",
        "upload_description_placeholder": "Describe the grenade",
        "upload_btn": "Upload video",
        "admin_title": "Management",
        "admin_subtitle": "Manage content and users",
        "admin_videos_tab": "Videos",
        "admin_featured_tab": "Quick Start",
        "admin_videos_title": "Video management",
        "admin_videos_description": "Here you can manage uploaded videos. To delete a video, click the \"Delete\" button.",
        "admin_featured_title": "Quick Start section management",
        "admin_featured_description": "Here you can select videos that will be displayed in the Quick Start section on the main page.",
        "admin_add_featured": "Add video",
        "admin_delete": "Delete",
        "auth_title": "Account login",
        "auth_subtitle": "Log in to your account or create a new one",
        "auth_login": "Login",
        "auth_register": "Register",
        "auth_email": "Email",
        "auth_password": "Password",
        "auth_confirm_password": "Confirm password",
        "auth_name": "Name",
        "auth_logout": "Logout",
        "account_title": "Account settings",
        "account_subtitle": "Manage your account settings",
        "account_settings": "Account settings",
        "account_current_password": "Current password",
        "account_new_password": "New password",
        "account_save": "Save changes",
        "account_delete_title": "Account deletion",
        "account_delete_description": "Deleting your account will permanently delete all your data, including collections and favorites.",
        "account_delete_button": "Delete account",
        "modal_views": "views",
        "modal_favorites": "favorites",
        "view3d_example_meta": "Smoke grenade • Mirage",
        "view3d_example_side": "CT side",
        "confirm_title": "Delete confirmation",
        "confirm_message": "Are you sure you want to delete this collection? This action cannot be undone.",
        "confirm_yes": "Yes, delete",
        "confirm_no": "Cancel",
        "about_title": "About",
        "about_subtitle": "Learn more about the NadeSpot platform and our mission",
        "about_text1": "NadeSpot is a platform for learning and using grenades in Counter-Strike 2. Our goal is to help players improve their skills and tactical thinking.",
        "about_text2": "Here you will find carefully selected videos with effective grenade uses on all popular maps. Our team of moderators checks each material before publication.",
        "about_feature1_title": "Quality content",
        "about_feature1_desc": "All videos are checked for effectiveness and relevance",
        "about_feature2_title": "Convenient categorization",
        "about_feature2_desc": "Grenades are sorted by types and maps for quick search",
        "about_feature3_title": "All CS2 maps",
        "about_feature3_desc": "Grenades for all official maps",
        "about_feature4_title": "Relevant strategies",
        "about_feature4_desc": "We regularly update the collection for the current game meta",
        "footer_copyright": "NadeSpot © 2025 - All rights reserved",
        "footer_demo": "This is a demo site created for educational purposes",
        "notification_success": "Operation completed successfully!",
        "notification_error": "An error has occurred!",
        "notification_info": "Theme changed",
        "no_videos": "No videos found",
        "no_videos_text": "Be the first to upload a grenade video!",
        "no_favorites": "No favorite videos",
        "no_favorites_text": "Add videos to favorites to easily find them later",
        "no_collections": "No collections yet",
        "no_collections_text": "Create your first collection to organize videos",
        "collection_empty": "No videos in collection yet",
        "video_duration": "Duration",
        "video_views": "views",
        "video_favorites": "favorites",
        "video_add_to_collection": "Add to collection",
        "video_remove_from_favorites": "Remove from favorites",
        "video_add_to_favorites": "Add to favorites",
        "video_difficulty": "Difficulty",
        "video_side": "Side",
        "video_map": "Map",
        "video_tags": "Tags",
        "grenade_molotov": "Molotov",
        "difficulty_hard": "HARD",
        "side_ct": "Counter-Terrorists",
        "total_videos": "Total Videos",
        "total_collections": "My Collections",
        "popular_maps": "Popular Maps",
        "maps_subtitle": "Learn grenades on the most popular CS2 maps",
        "grenade": "Grenade",
        "grenades": "Grenades",
        "grenades_count": "Grenades",
        "grenade_types": "Grenade Types",
        "grenades_subtitle": "Learn all types of grenades and their usage",
        "smoke_desc": "Create smoke screens to hide movements and block line of sight",
        "flash_desc": "Blind enemies for a short time, allowing flanking maneuvers",
        "molotov_desc": "Create fire zones that deal damage and force enemies out of position",
        "he_desc": "Deal direct damage to enemies within the explosion radius",
        "quick_start": "Quick Start",
        "quick_start_subtitle": "Start learning with the most effective grenades",
        "collection_select_title": "Select collection",
        "role_admin": "Administrator",
        "role_moderator": "Moderator",
        "role_user": "User",
        "no_collections_create": "You don't have any collections. Create collection",
        "featured_add_title": "Add video to \"Quick Start\"",
        "featured_add_description": "Select videos to add to the \"Quick Start\" section on the main page",
        "featured_all_added": "All available videos have already been added to \"Quick Start\""
      }
    };

    // Функция для применения перевода
    function applyLanguage(lang) {
      document.documentElement.lang = lang;
      const elements = document.querySelectorAll('[data-translate]');
      elements.forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang] && translations[lang][key]) {
          if (key === 'grenades_count') {
            const count = element.getAttribute('data-count');
            const grenadesText = count === 'X' ? 
              translations[lang]['grenades'] : 
              `${count} ${getGrenadesWord(count, lang)}`;
            element.textContent = grenadesText;
          } else {
            element.textContent = translations[lang][key];
          }
        }
      });
      const placeholders = document.querySelectorAll('[data-placeholder]');
      placeholders.forEach(element => {
        const key = element.getAttribute('data-placeholder');
        if (translations[lang] && translations[lang][key]) {
          element.setAttribute('placeholder', translations[lang][key]);
        }
      });
      document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.getAttribute('data-lang') === lang) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
      
      // Мгновенно перерисовываем контент с новым языком
      const activeSection = Array.from(document.querySelectorAll('section')).find(s => s.classList.contains('active'));
      if (activeSection) {
        const sectionId = activeSection.id;
        const currentLang = lang;
        
        if (sectionId === 'videos') {
          renderVideos(currentLang);
        } else if (sectionId === 'collections') {
          renderCollections(currentLang);
        } else if (sectionId === 'admin') {
          renderAdminPanel(currentLang);
        } else if (sectionId === 'favorites') {
          renderFavorites(currentLang);
        } else if (sectionId === 'home') {
          updateStats();
        }
      }
      
      saveSetting('preferredLanguage', lang);
    }

    // Функция для получения правильной формы слова "граната" в зависимости от числа
    function getGrenadesWord(count, lang) {
      if (lang === 'ru') {
        const lastDigit = count % 10;
        const lastTwoDigits = count % 100;
        
        if (lastTwoDigits >= 11 && lastTwoDigits <= 19) {
          return 'Гранат';
        }
        
        if (lastDigit === 1) {
          return 'Граната';
        } else if (lastDigit >= 2 && lastDigit <= 4) {
          return 'Гранаты';
        } else {
          return 'Гранат';
        }
      } else if (lang === 'uk') {
        const lastDigit = count % 10;
        const lastTwoDigits = count % 100;
        
        if (lastTwoDigits >= 11 && lastTwoDigits <= 19) {
          return 'Гранат';
        }
        
        if (lastDigit === 1) {
          return 'Граната';
        } else if (lastDigit >= 2 && lastDigit <= 4) {
          return 'Гранати';
        } else {
          return 'Гранат';
        }
      } else {
        return count === 1 ? 'Grenade' : 'Grenades';
      }
    }

    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      saveSetting('preferredTheme', newTheme);
      const lang = document.documentElement.lang || 'ru';
      showNotification(translations[lang]['notification_info'], 'info');
    }

    // Инициализация IndexedDB
    let db;
    const dbName = 'NadeSpotDB';
    const dbVersion = 2;

    // Инициализация базы данных
    function initDB() {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open(dbName, dbVersion);
        request.onerror = event => {
          console.error('IndexedDB error:', event.target.error);
          reject(event.target.error);
        };
        request.onsuccess = event => {
          db = event.target.result;
          resolve(db);
        };
        request.onupgradeneeded = event => {
          const idb = event.target.result;
          if (!idb.objectStoreNames.contains('videos')) {
            const videoStore = idb.createObjectStore('videos', { keyPath: 'id' });
            videoStore.createIndex('category', 'category', { unique: false });
            videoStore.createIndex('map', 'map', { unique: false });
            videoStore.createIndex('position', 'position', { unique: false });
          }
          if (!idb.objectStoreNames.contains('collections')) {
            const collectionStore = idb.createObjectStore('collections', { keyPath: 'id' });
            collectionStore.createIndex('name', 'name', { unique: false });
          }
          if (!idb.objectStoreNames.contains('favorites')) {
            idb.createObjectStore('favorites', { keyPath: 'id' });
          }
          if (!idb.objectStoreNames.contains('settings')) {
            idb.createObjectStore('settings', { keyPath: 'key' });
          }
          if (!idb.objectStoreNames.contains('users')) {
            const userStore = idb.createObjectStore('users', { keyPath: 'id' });
            userStore.createIndex('email', 'email', { unique: true });
          }
          if (!idb.objectStoreNames.contains('featuredVideos')) {
            idb.createObjectStore('featuredVideos', { keyPath: 'id' });
          }
        };
      });
    }

    async function saveSetting(key, value) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['settings'], 'readwrite');
        const store = transaction.objectStore('settings');
        const request = store.put({ key, value });
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function getSetting(key, defaultValue = null) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['settings'], 'readonly');
        const store = transaction.objectStore('settings');
        const request = store.get(key);
        request.onsuccess = () => resolve(request.result ? request.result.value : defaultValue);
        request.onerror = () => reject(request.error);
      });
    }

    // Функции для работы с пользователями
    async function getAllUsers() {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['users'], 'readonly');
        const store = transaction.objectStore('users');
        const request = store.getAll();
        request.onsuccess = () => resolve(request.result || []);
        request.onerror = () => reject(request.error);
      });
    }

    async function saveUser(user) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['users'], 'readwrite');
        const store = transaction.objectStore('users');
        const request = store.put(user);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function getUserByEmail(email) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['users'], 'readonly');
        const store = transaction.objectStore('users');
        const index = store.index('email');
        const request = index.get(email);
        request.onsuccess = () => resolve(request.result);
        request.onerror = () => reject(request.error);
      });
    }

    async function deleteUserFromDB(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['users'], 'readwrite');
        const store = transaction.objectStore('users');
        const request = store.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    // Функции для работы с избранными видео
    async function getAllFavorites() {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['favorites'], 'readonly');
        const store = transaction.objectStore('favorites');
        const request = store.getAll();
        request.onsuccess = () => resolve((request.result || []).map(f => f.id));
        request.onerror = () => reject(request.error);
      });
    }

    async function addFavorite(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['favorites'], 'readwrite');
        const store = transaction.objectStore('favorites');
        const request = store.put({ id });
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function removeFavorite(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['favorites'], 'readwrite');
        const store = transaction.objectStore('favorites');
        const request = store.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    // Функции для работы с видео
    async function getAllVideos() {
      try {
        const response = await fetch('api/get_videos.php');
        if (!response.ok) throw new Error('Ошибка сети');
        
        const videos = await response.json();
        
        return videos.map(v => ({
            ...v,
            id: Number(v.id)
        }));
      } catch (error) {
        console.error('Ошибка получения видео:', error);
        return [];
      }
    }

    async function saveVideo(video) {
      // Защита от дублей при просмотрах (пропускаем обновление)
      if (video.id && video.id < 1000000000000) {
          console.log('Обновление статистики пропущено');
          return; 
      }

      try {
        const response = await fetch('api/upload_video.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(video)
        });

        const result = await response.json();
        if (!result.success && !result.id) {
           throw new Error(result.error || 'Ошибка загрузки');
        }
        
        console.log('Видео успешно загружено на сервер, ID:', result.id);
      } catch (error) {
        console.error('Ошибка сохранения:', error);
        showNotification('Ошибка сохранения на сервере', 'error');
        throw error;
      }
    }

    async function deleteVideoFromDB(id) {
      try {
        const response = await fetch('api/delete_video.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ id: id })
        });

        const result = await response.json();
        if (!result.success) {
          throw new Error(result.error || 'Ошибка удаления');
        }
      } catch (error) {
        console.error('Ошибка удаления:', error);
        showNotification('Не удалось удалить видео', 'error');
      }
    }

    // Функции для работы с коллекциями
    async function getAllCollections() {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['collections'], 'readonly');
        const store = transaction.objectStore('collections');
        const request = store.getAll();
        request.onsuccess = () => resolve(request.result || []);
        request.onerror = () => reject(request.error);
      });
    }

    async function saveCollection(collection) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['collections'], 'readwrite');
        const store = transaction.objectStore('collections');
        const request = store.put(collection);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function deleteCollectionFromDB(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['collections'], 'readwrite');
        const store = transaction.objectStore('collections');
        const request = store.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    // Функции для работы с избранными видео на главной
    async function getAllFeaturedVideos() {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['featuredVideos'], 'readonly');
        const store = transaction.objectStore('featuredVideos');
        const request = store.getAll();
        request.onsuccess = () => resolve(request.result || []);
        request.onerror = () => reject(request.error);
      });
    }

    async function saveFeaturedVideo(video) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['featuredVideos'], 'readwrite');
        const store = transaction.objectStore('featuredVideos');
        const request = store.put(video);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    async function deleteFeaturedVideoFromDB(id) {
      if (!db) await initDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['featuredVideos'], 'readwrite');
        const store = transaction.objectStore('featuredVideos');
        const request = store.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    }

    // Инициализация UI при загрузке
    document.addEventListener('DOMContentLoaded', async function() {
      await initDB();
      const savedLanguage = await getSetting('preferredLanguage');
      const savedTheme = await getSetting('preferredTheme', 'dark');
      const browserLanguage = navigator.language.substring(0, 2);
      if (savedLanguage) applyLanguage(savedLanguage);
      else if (browserLanguage in translations) applyLanguage(browserLanguage);
      else applyLanguage('ru');
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      // Создаем администратора по умолчанию
      await createDefaultAdmin();
      
      // Проверяем авторизацию
      await checkAuth();
      
      const lang = document.documentElement.lang || 'ru';
      await renderVideos(lang);
      await renderCollections(lang);
      
      // Обработчики для навигации
      document.getElementById('menu-toggle').addEventListener('click', function() {
        document.getElementById('nav-links').classList.toggle('active');
      });
      
      // Обработчики для навигационных ссылок
      document.querySelectorAll('nav a, .btn, .hero-buttons a').forEach(element => {
        if (element.hasAttribute('data-section')) {
          element.addEventListener('click', function(e) {
            e.preventDefault();
            const sectionId = this.getAttribute('data-section');
            showSection(sectionId);
          });
        }
      });
      
      // Обработчики для переключения языка
      document.querySelectorAll('.lang-btn').forEach(button => {
        button.addEventListener('click', function() {
          const lang = this.getAttribute('data-lang');
          applyLanguage(lang);
        });
      });
      
      // Обработчик для переключения темы
      document.getElementById('theme-switcher').addEventListener('click', toggleTheme);
      
      // Обработчики для клавиш Enter и Esc
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          // Подтверждение действий с помощью Enter
          const activeModal = document.querySelector('.modal.active, .confirm-modal.active, .collection-create-modal.active');
          if (activeModal) {
            if (activeModal.id === 'confirm-modal') {
              document.getElementById('confirm-yes').click();
            } else if (activeModal.id === 'collection-create-modal') {
              document.querySelector('.collection-create-buttons .btn:last-child').click();
            }
          }
        } else if (e.key === 'Escape') {
          // Закрытие модальных окон с помощью Esc
          closeAllModals();
        }
      });
      
      // Обновляем статистику после загрузки
      setTimeout(updateStats, 1000);
    });

    // Переменные состояния
    let currentUploadType = 'file';
    let isAdminMode = false;
    let currentDeletion = { type: null, id: null };
    let currentUser = null;
    let currentVideoForCollection = null;

    // Создание администратора по умолчанию
    async function createDefaultAdmin() {
      const adminEmail = 'nadespot0@gmail.com';
      const existingAdmin = await getUserByEmail(adminEmail);
      
      if (!existingAdmin) {
        const adminUser = {
          id: Date.now(),
          name: 'NadeSpot Admin',
          email: adminEmail,
          password: 'admin123', 
          role: 'admin',
          created: new Date().toISOString(),
          isProtected: true 
        };
        await saveUser(adminUser);
        console.log('Администратор создан: nadespot0@gmail.com / admin123');
      }
    }

    // Проверка авторизации
    async function checkAuth() {
      const savedUser = await getSetting('currentUser');
      if (savedUser) {
        currentUser = savedUser;
        updateUIForUser();
      }
    }

    // Обновление UI в зависимости от пользователя
    function updateUIForUser() {
      if (currentUser) {
        // Показываем пользовательское меню
        document.getElementById('auth-buttons').style.display = 'none';
        document.getElementById('user-menu').style.display = 'block';
        
        // Обновляем аватар
        document.getElementById('user-avatar').textContent = currentUser.name.charAt(0).toUpperCase();
        
        // Показываем загрузку и управление для администраторов и модераторов
        if (currentUser.role === 'admin' || currentUser.role === 'moderator') {
          document.getElementById('upload-nav').style.display = 'block';
          document.getElementById('upload-btn-main').style.display = 'inline-block';
          document.getElementById('admin-nav').style.display = 'block';
        } else {
          document.getElementById('upload-nav').style.display = 'none';
          document.getElementById('upload-btn-main').style.display = 'none';
          document.getElementById('admin-nav').style.display = 'none';
        }
        
        // Показываем кнопки коллекций
        document.getElementById('collections-buttons').style.display = 'flex';
        document.getElementById('collections-login-prompt').style.display = 'none';
      } else {
        // Показываем кнопки авторизации
        document.getElementById('auth-buttons').style.display = 'flex';
        document.getElementById('user-menu').style.display = 'none';
        
        // Скрываем загрузку и управление
        document.getElementById('upload-nav').style.display = 'none';
        document.getElementById('upload-btn-main').style.display = 'none';
        document.getElementById('admin-nav').style.display = 'none';
        
        // Скрываем кнопки коллекций
        document.getElementById('collections-buttons').style.display = 'none';
        document.getElementById('collections-login-prompt').style.display = 'block';
      }
    }

    // Уведомления
    function showNotification(message, type = 'success') {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.className = `notification ${type} show`;
      setTimeout(() => {
        notification.classList.remove('show');
      }, 2500);
    }

    // Проверка дубликатов
    async function isDuplicateVideo(videoData) {
      const videos = await getAllVideos();
      return videos.some(video => {
        if (videoData.type === 'youtube' && video.type === 'youtube') {
          return video.src === videoData.src;
        }
        if (videoData.type === 'file' && video.type === 'file') {
          return video.title === videoData.title && video.category === videoData.category;
        }
        return false;
      });
    }

    // Показать/скрыть секции
    async function showSection(id) {
      document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
      const el = document.getElementById(id);
      if (el) el.classList.add("active");

      // Обновление активной ссылки в навигации
      document.querySelectorAll("nav a").forEach(a => a.classList.remove("active"));
      const navLink = Array.from(document.querySelectorAll("nav a")).find(a => {
        return a.getAttribute('data-section') === id;
      });
      if (navLink) navLink.classList.add('active');

      // Закрытие мобильного меню
      document.getElementById('nav-links').classList.remove('active');
      
      // Прокрутка к началу страницы
      window.scrollTo(0, 0);

      const lang = document.documentElement.lang || 'ru';

      // Обновление контента в зависимости от раздела
      if (id === 'videos') {
        isAdminMode = false;
        await renderVideos(lang);
      } else if (id === 'admin') {
        isAdminMode = true;
        await renderAdminPanel(lang);
      } else if (id === 'collections') {
        await renderCollections(lang);
      } else if (id === 'favorites') {
        await renderFavorites(lang);
      } else if (id === 'home') {
        updateStats();
      } else if (id === 'account' && currentUser) {
        document.getElementById('account-name').value = currentUser.name;
        document.getElementById('account-email').value = currentUser.email;
      }
      
      // Очистка полей ввода при переходе на страницу авторизации
      if (id === 'auth') {
        document.getElementById('login-email').value = '';
        document.getElementById('login-password').value = '';
        document.getElementById('register-name').value = '';
        document.getElementById('register-email').value = '';
        document.getElementById('register-password').value = '';
        document.getElementById('register-confirm-password').value = '';
      }
    }

    // Управление вкладками авторизации
    function showAuthTab(tab) {
      document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
      document.getElementById('login-tab').style.display = tab === 'login' ? 'block' : 'none';
      document.getElementById('register-tab').style.display = tab === 'register' ? 'block' : 'none';
      document.querySelector(`.auth-tab[onclick="showAuthTab('${tab}')"]`).classList.add('active');
    }

    // Управление вкладками администратора
    function showAdminTab(tab) {
      document.querySelectorAll('.admin-tab-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('admin-videos-tab').style.display = tab === 'videos' ? 'block' : 'none';
      document.getElementById('admin-featured-tab').style.display = tab === 'featured' ? 'block' : 'none';
      document.querySelector(`.admin-tab-btn[onclick="showAdminTab('${tab}')"]`).classList.add('active');
    }

    // Валидация email
    function isValidEmail(email) {
      const emailRegex = /^[a-zA-Z0-9._%+-]+@gmail\.com$/;
      return emailRegex.test(email);
    }

    // Валидация пароля
    function isValidPassword(password) {
      if (password.length < 6) return false;
      if (!/[a-zA-Z]/.test(password)) return false;
      const forbiddenChars = /[*:;№"!'\\|\/\]}{\[.<>,#@\-=+()&^~`]/;
      if (forbiddenChars.test(password)) return false;
      return true;
    }

    // Регистрация
    async function register() {
      const name = document.getElementById('register-name').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      const confirmPassword = document.getElementById('register-confirm-password').value;
      const lang = document.documentElement.lang || 'ru';

      if (!name || !email || !password || !confirmPassword) {
        showNotification(translations[lang]['notification_error'], 'error');
        return;
      }

      if (!isValidEmail(email)) {
        showNotification('Пожалуйста, используйте email в формате @gmail.com', 'error');
        return;
      }

      if (!isValidPassword(password)) {
        showNotification('Пароль должен содержать минимум 6 символов, хотя бы одну букву и не содержать специальных символов', 'error');
        return;
      }

      if (password !== confirmPassword) {
        showNotification('Пароли не совпадают', 'error');
        return;
      }

      const existingUser = await getUserByEmail(email);
      if (existingUser) {
        showNotification('Пользователь с таким email уже существует', 'error');
        return;
      }

      const newUser = {
        id: Date.now(),
        name,
        email,
        password, 
        role: 'user',
        created: new Date().toISOString()
      };

      await saveUser(newUser);
      showNotification(translations[lang]['notification_success']);
      
      // Автоматический вход после регистрации
      currentUser = newUser;
      await saveSetting('currentUser', newUser);
      updateUIForUser();
      showSection('home');
    }

    // Вход
    async function login() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      const lang = document.documentElement.lang || 'ru';

      if (!email || !password) {
        showNotification(translations[lang]['notification_error'], 'error');
        return;
      }

      const user = await getUserByEmail(email);
      if (!user || user.password !== password) {
        showNotification('Неверный email или пароль', 'error');
        return;
      }

      currentUser = user;
      await saveSetting('currentUser', user);
      updateUIForUser();
      showNotification(translations[lang]['notification_success']);
      showSection('home');
    }

    // Выход
    async function logout() {
      currentUser = null;
      await saveSetting('currentUser', null);
      updateUIForUser();
      const lang = document.documentElement.lang || 'ru';
      showNotification(translations[lang]['notification_info'], 'info');
      showSection('home');
      document.getElementById('user-dropdown').classList.remove('active');
    }

    // Обновление аккаунта
    async function updateAccount() {
      const name = document.getElementById('account-name').value;
      const currentPassword = document.getElementById('account-current-password').value;
      const newPassword = document.getElementById('account-new-password').value;
      const confirmPassword = document.getElementById('account-confirm-password').value;
      const lang = document.documentElement.lang || 'ru';

      if (!name) {
        showNotification(translations[lang]['notification_error'], 'error');
        return;
      }

      // Проверяем текущий пароль
      if (currentPassword && currentUser.password !== currentPassword) {
        showNotification('Неверный текущий пароль', 'error');
        return;
      }

      // Проверяем новый пароль
      if (newPassword) {
        if (!isValidPassword(newPassword)) {
          showNotification('Пароль должен содержать минимум 6 символов, хотя бы одну букву и не содержать специальных символов', 'error');
          return;
        }
        
        if (newPassword !== confirmPassword) {
          showNotification('Новые пароли не совпадают', 'error');
          return;
        }
      }

      // Обновляем пользователя
      currentUser.name = name;
      if (newPassword) {
        currentUser.password = newPassword;
      }

      await saveUser(currentUser);
      await saveSetting('currentUser', currentUser);
      showNotification(translations[lang]['notification_success']);
      document.getElementById('account-current-password').value = '';
      document.getElementById('account-new-password').value = '';
      document.getElementById('account-confirm-password').value = '';
    }

    // Удаление аккаунта
    async function deleteAccount() {
      if (!currentUser) return;
      
      // Нельзя удалить защищенный аккаунт
      if (currentUser.isProtected) {
        showNotification('Этот аккаунт защищен от удаления', 'error');
        return;
      }
      
      // Удаляем коллекции пользователя
      const collections = await getAllCollections();
      const userCollections = collections.filter(c => c.userId === currentUser.id);
      for (const collection of userCollections) {
        await deleteCollectionFromDB(collection.id);
      }
      
      // Удаляем избранные пользователя
      const favorites = await getAllFavorites();
      for (const favorite of favorites) {
        await removeFavorite(favorite);
      }
      
      // Удаляем пользователя
      await deleteUserFromDB(currentUser.id);
      
      // Выходим из аккаунта
      currentUser = null;
      await saveSetting('currentUser', null);
      updateUIForUser();
      
      const lang = document.documentElement.lang || 'ru';
      showNotification('Аккаунт успешно удален', 'success');
      showSection('home');
    }

    function confirmDeleteAccount() {
      currentDeletion = { type: 'account', id: currentUser.id };
      const lang = document.documentElement.lang || 'ru';
      document.getElementById('confirm-title').textContent = translations[lang]['account_delete_title'];
      document.getElementById('confirm-message').textContent = translations[lang]['account_delete_description'];
      document.getElementById('confirm-modal').classList.add('active');
    }

    // Переключение пользовательского меню
    function toggleUserDropdown() {
      document.getElementById('user-dropdown').classList.toggle('active');
    }

    // Закрытие пользовательского меню при клике вне его
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.user-menu')) {
        document.getElementById('user-dropdown').classList.remove('active');
      }
    });

    // Закрытие всех модальных окон
    function closeAllModals() {
      document.querySelectorAll('.modal.active, .confirm-modal.active, .collection-create-modal.active, .collection-select-modal.active, .featured-modal.active').forEach(modal => {
        modal.classList.remove('active');
      });
    }

    // Закрытие модального окна авторизации
    function closeAuthModal() {
      showSection('home');
    }

    // Открытие модального окна создания коллекции
    function openCreateCollectionModal() {
      if (!currentUser) {
        showNotification('Для создания коллекции необходимо войти в аккаунт', 'error');
        return;
      }
      
      document.getElementById('collection-create-name').value = '';
      document.getElementById('collection-create-description').value = '';
      document.getElementById('collection-create-modal').classList.add('active');
    }

    // Закрытие модального окна создания коллекции
    function closeCreateCollectionModal() {
      document.getElementById('collection-create-modal').classList.remove('active');
    }

    // Создание новой коллекции
    async function createNewCollection() {
      const name = document.getElementById('collection-create-name').value;
      const description = document.getElementById('collection-create-description').value;
      const lang = document.documentElement.lang || 'ru';
      
      if (!name) {
        showNotification('Введите название коллекции', 'error');
        return;
      }

      const newCollection = {
        id: Date.now(),
        name,
        description,
        videos: [],
        created: new Date().toLocaleDateString('ru-RU'),
        userId: currentUser.id
      };
      
      await saveCollection(newCollection);
      closeCreateCollectionModal();
      await renderCollections(lang);
      showNotification(translations[lang]['notification_success']);
      updateStats();
    }

    // Обработчики для загрузки видео
    document.querySelectorAll('.upload-type-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.upload-type-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        currentUploadType = this.getAttribute('data-type');
        document.getElementById('file-upload-section').style.display =
          currentUploadType === 'file' ? 'block' : 'none';
        document.getElementById('youtube-upload-section').style.display =
          currentUploadType === 'youtube' ? 'block' : 'none';
      });
    });

    document.getElementById('video-file').addEventListener('change', function(e) {
      if (e.target.files.length > 0) {
        const fileName = e.target.files[0].name;
        document.querySelector('#drop-zone p').textContent = `Выбран файл: ${fileName}`;
      }
    });

    const dropZone = document.getElementById('drop-zone');
    dropZone.addEventListener('dragover', function(e) {
      e.preventDefault();
      this.style.borderColor = 'var(--primary)';
      this.style.backgroundColor = 'rgba(255, 69, 0, 0.1)';
    });
    dropZone.addEventListener('dragleave', function() {
      this.style.borderColor = 'var(--border-color)';
      this.style.backgroundColor = 'transparent';
    });
    dropZone.addEventListener('drop', function(e) {
      e.preventDefault();
      this.style.borderColor = 'var(--border-color)';
      this.style.backgroundColor = 'transparent';
      if (e.dataTransfer.files.length > 0) {
        const file = e.dataTransfer.files[0];
        if (file.type.startsWith('video/')) {
          document.getElementById('video-file').files = e.dataTransfer.files;
          document.querySelector('#drop-zone p').textContent = `Выбран файл: ${file.name}`;
        } else {
          showNotification('Пожалуйста, выберите видео файл', 'error');
        }
      }
    });

    async function uploadVideo() {
      // Проверяем права доступа
      if (!currentUser || (currentUser.role !== 'admin' && currentUser.role !== 'moderator')) {
        const lang = document.documentElement.lang || 'ru';
        showNotification('У вас нет прав для загрузки видео', 'error');
        return;
      }

      const title = document.getElementById('video-title').value;
      const category = document.getElementById('video-category').value;
      const map = document.getElementById('video-map').value;
      const position = document.getElementById('video-position').value;
      const side = document.getElementById('video-side').value;
      const difficulty = document.getElementById('video-difficulty').value;
      const description = document.getElementById('video-description').value;

      if (!title || !category) {
        const lang = document.documentElement.lang || 'ru';
        showNotification(translations[lang]['notification_error'], 'error');
        return;
      }

      let videoData = {
        id: Date.now(),
        title,
        category,
        map,
        position,
        side,
        difficulty,
        description,
        date: new Date().toLocaleDateString('ru-RU'),
        views: 0,
        favorites: 0,
        author: currentUser.name
      };

      if (currentUploadType === 'file') {
        const fileInput = document.getElementById('video-file');
        if (fileInput.files.length === 0) {
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_error'], 'error');
          return;
        }
        const file = fileInput.files[0];
        const reader = new FileReader();
        reader.onload = async function(e) {
          videoData.src = e.target.result;
          videoData.type = 'file';

          if (await isDuplicateVideo(videoData)) {
            showNotification('Такое видео уже существует!', 'error');
            return;
          }

          await saveVideo(videoData);
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_success']);
          resetForm();
          await renderVideos(lang);
          updateStats();
        };
        reader.readAsDataURL(file);
      } else {
        const youtubeUrl = document.getElementById('youtube-url').value;
        if (!youtubeUrl) {
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_error'], 'error');
          return;
        }
        let videoId = youtubeUrl.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);
        if (videoId) {
          videoId = videoId[1];
          videoData.src = `https://www.youtube.com/embed/${videoId}`;
          videoData.type = 'youtube';
          if (await isDuplicateVideo(videoData)) {
            showNotification('Это YouTube видео уже добавлено!', 'error');
            return;
          }
          await saveVideo(videoData);
          const lang = document.documentElement.lang || 'ru';
          showNotification(translations[lang]['notification_success']);
          resetForm();
          await renderVideos(lang);
          updateStats();
        } else {
          showNotification('Некорректная ссылка на YouTube видео', 'error');
        }
      }
    }

    function resetForm() {
      document.getElementById('video-title').value = '';
      document.getElementById('video-category').value = '';
      document.getElementById('video-map').value = '';
      document.getElementById('video-position').value = '';
      document.getElementById('video-side').value = '';
      document.getElementById('video-difficulty').value = '';
      document.getElementById('video-description').value = '';
      document.getElementById('youtube-url').value = '';
      document.getElementById('video-file').value = '';
      document.querySelector('#drop-zone p').textContent = 'Перетащите видеофайл сюда или';
    }

    // Функции перевода
    function getCategoryName(category, lang = document.documentElement.lang || 'ru') {
      const categories = {
        'smoke': translations[lang]?.['filter_smoke'] || 'Дымовая',
        'flash': translations[lang]?.['filter_flash'] || 'Светошумовая',
        'molotov': translations[lang]?.['filter_molotov'] || 'Зажигательная',
        'he': translations[lang]?.['filter_he'] || 'Осколочная'
      };
      return categories[category] || category || '—';
    }

    function getDifficultyName(difficulty, lang = document.documentElement.lang || 'ru') {
      const difficulties = {
        'easy': translations[lang]?.['upload_difficulty_easy'] || 'Легкая',
        'medium': translations[lang]?.['upload_difficulty_medium'] || 'Средняя',
        'hard': translations[lang]?.['upload_difficulty_hard'] || 'Сложная'
      };
      return difficulties[difficulty] || difficulty || '—';
    }

    function getSideName(side, lang = document.documentElement.lang || 'ru') {
      const sides = {
        'CT': translations[lang]?.['filter_ct'] || 'Контр-террористы',
        'T': translations[lang]?.['filter_t'] || 'Террористы',
        'both': translations[lang]?.['filter_both'] || 'Обе стороны'
      };
      return sides[side] || side || '—';
    }

    function getRoleName(role, lang = document.documentElement.lang || 'ru') {
      const roles = {
        'admin': translations[lang]?.['role_admin'] || 'Администратор',
        'moderator': translations[lang]?.['role_moderator'] || 'Модератор',
        'user': translations[lang]?.['role_user'] || 'Пользователь'
      };
      return roles[role] || role || '—';
    }

    // Функция для обновления статистики
    async function updateStats() {
      const videos = await getAllVideos();
      const collections = await getAllCollections();
      
      document.getElementById('total-videos').textContent = videos.length;
      
      // Обновляем счетчик коллекций пользователя
      if (currentUser) {
        const userCollections = collections.filter(c => c.userId === currentUser.id);
        document.getElementById('user-collections-count').textContent = userCollections.length;
      } else {
        document.getElementById('user-collections-count').textContent = 0;
      }
      
      // Обновляем счетчики для карт
      const mirageCount = videos.filter(v => v.map === 'Mirage').length;
      const dust2Count = videos.filter(v => v.map === 'Overpass').length;
      const ancientCount = videos.filter(v => v.map === 'Ancient').length;
      
      const lang = document.documentElement.lang || 'ru';
      
      document.getElementById('mirage-count').textContent = `${mirageCount} ${getGrenadesWord(mirageCount, lang)}`;
      document.getElementById('dust2-count').textContent = `${dust2Count} ${getGrenadesWord(dust2Count, lang)}`;
      document.getElementById('ancient-count').textContent = `${ancientCount} ${getGrenadesWord(ancientCount, lang)}`;
      
      // Показываем избранные видео на главной
      const featuredContainer = document.getElementById('featured-videos');
      if (featuredContainer) {
        featuredContainer.innerHTML = '';
        const featuredVideos = await getAllFeaturedVideos();
        
        if (featuredVideos.length === 0) {
          // Если нет избранных видео, показываем первые 3
          const firstVideos = videos.slice(0, 3);
          firstVideos.forEach(video => {
            const videoCard = createVideoCard(video, lang);
            featuredContainer.appendChild(videoCard);
          });
        } else {
          // Показываем избранные видео
          featuredVideos.forEach(featured => {
            const video = videos.find(v => v.id === featured.videoId);
            if (video) {
              const videoCard = createVideoCard(video, lang);
              featuredContainer.appendChild(videoCard);
            }
          });
        }
      }
    }

    // Функция создания карточки видео
    function createVideoCard(video, lang) {
      const videoCard = document.createElement('div');
      videoCard.className = 'video-card';
      videoCard.setAttribute('data-category', video.category);
      videoCard.setAttribute('data-map', video.map || '');
      videoCard.setAttribute('data-position', video.position || '');
      videoCard.setAttribute('data-side', video.side || '');
      videoCard.setAttribute('data-difficulty', video.difficulty || '');
      
      let thumbContent = '';
      if (video.type === 'youtube') {
        const videoId = (video.src || '').split('/embed/')[1] || '';
        thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}">`;
      } else {
        // Убрана надпись "Файл" и оставлен просто темный фон
        thumbContent = `<div style="display:flex; align-items:center; justify-content:center; height:100%; background:#222;"></div>`;
      }
      
      videoCard.innerHTML = `
        <div class="video-actions">
          ${currentUser ? `
            <button class="action-btn" onclick="toggleFavorite(${video.id}, this)">
              <i class="fas fa-star"></i>
            </button>
            <button class="action-btn" onclick="openCollectionSelect(${video.id})">
              <i class="fas fa-folder-plus"></i>
            </button>
          ` : ''}
        </div>
        <div class="video-thumb" onclick="openVideo(${video.id})">
          ${thumbContent}
          <div class="play-icon"><i class="fas fa-play"></i></div>
        </div>
        <div class="video-info">
          <h3 class="video-title">${escapeHtml(video.title)}</h3>
          <div class="video-meta">
            <span>${getCategoryName(video.category, lang)}</span>
            <span>${escapeHtml(video.map || '—')}</span>
          </div>
          <p>${escapeHtml(video.description || '')}</p>
          <div class="video-details">
            ${video.difficulty ? `<div class="video-detail"><i class="fas fa-signal"></i> <span class="difficulty-badge difficulty-${video.difficulty}">${getDifficultyName(video.difficulty, lang)}</span></div>` : ''}
            ${video.side ? `<div class="video-detail"><i class="fas fa-user-shield"></i> ${getSideName(video.side, lang)}</div>` : ''}
            ${video.position ? `<div class="video-detail"><i class="fas fa-map-marker-alt"></i> ${escapeHtml(video.position)}</div>` : ''}
          </div>
        </div>
      `;
      
      return videoCard;
    }

    // Отображение и управление видео
    async function renderVideos(lang = document.documentElement.lang || 'ru') {
      const videoContainer = document.getElementById('video-container');
      videoContainer.innerHTML = '';
      const videos = await getAllVideos();
      
      if (videos.length === 0) {
        videoContainer.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <i class="fas fa-video-slash" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>${translations[lang]['no_videos']}</h3>
            <p>${translations[lang]['no_videos_text']}</p>
          </div>
        `;
        return;
      }
      const favorites = await getAllFavorites();
      // сортируем новые сверху
      videos.sort((a,b) => (b.date || 0) - (a.date || 0));
      videos.forEach(video => {
        const isFavorited = favorites.includes(video.id);
        const videoCard = document.createElement('div');
        videoCard.className = 'video-card';
        videoCard.setAttribute('data-category', video.category);
        videoCard.setAttribute('data-map', video.map || '');
        videoCard.setAttribute('data-position', video.position || '');
        videoCard.setAttribute('data-side', video.side || '');
        videoCard.setAttribute('data-difficulty', video.difficulty || '');
        let thumbContent = '';
        if (video.type === 'youtube') {
          const videoId = (video.src || '').split('/embed/')[1] || '';
          thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}">`;
        } else {
          thumbContent = `<div style="display:flex; align-items:center; justify-content:center; height:100%; background:#222;"></div>`;
        }
        videoCard.innerHTML = `
          <div class="video-actions">
            ${currentUser ? `
              <button class="action-btn ${isFavorited ? 'favorited' : ''}" onclick="toggleFavorite(${video.id}, this)">
                <i class="fas fa-star"></i>
              </button>
              <button class="action-btn" onclick="openCollectionSelect(${video.id})">
                <i class="fas fa-folder-plus"></i>
              </button>
            ` : ''}
          </div>
          <div class="video-thumb" onclick="openVideo(${video.id})">
            ${thumbContent}
            <div class="play-icon"><i class="fas fa-play"></i></div>
          </div>
          <div class="video-info">
            <h3 class="video-title">${escapeHtml(video.title)}</h3>
            <div class="video-meta">
              <span>${getCategoryName(video.category, lang)}</span>
              <span>${escapeHtml(video.map || '—')}</span>
            </div>
            <p>${escapeHtml(video.description || '')}</p>
            <div class="video-details">
              ${video.difficulty ? `<div class="video-detail"><i class="fas fa-signal"></i> <span class="difficulty-badge difficulty-${video.difficulty}">${getDifficultyName(video.difficulty, lang)}</span></div>` : ''}
              ${video.side ? `<div class="video-detail"><i class="fas fa-user-shield"></i> ${getSideName(video.side, lang)}</div>` : ''}
              ${video.position ? `<div class="video-detail"><i class="fas fa-map-marker-alt"></i> ${escapeHtml(video.position)}</div>` : ''}
            </div>
          </div>
        `;
        videoContainer.appendChild(videoCard);
      });
    }

    // Поиск видео
    function searchVideos() {
      const searchTerm = document.getElementById('search-input').value.toLowerCase();
      const videoCards = document.querySelectorAll('.video-card');
      videoCards.forEach(card => {
        const title = (card.querySelector('.video-title') ? card.querySelector('.video-title').textContent : '').toLowerCase();
        const description = (card.querySelector('p') ? card.querySelector('p').textContent : '').toLowerCase();
        const map = (card.getAttribute('data-map') || '').toLowerCase();
        if (title.includes(searchTerm) || description.includes(searchTerm) || map.includes(searchTerm)) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    }

    // Фильтрация видео
    function filterVideos() {
      const category = document.getElementById('filter-category').value;
      const map = document.getElementById('filter-map').value;
      const position = document.getElementById('filter-position').value;
      const side = document.getElementById('filter-side').value;
      const difficulty = document.getElementById('filter-difficulty').value;
      const videoCards = document.querySelectorAll('.video-card');
      videoCards.forEach(card => {
        const videoCategory = card.getAttribute('data-category');
        const videoMap = card.getAttribute('data-map');
        const videoPosition = card.getAttribute('data-position');
        const videoSide = card.getAttribute('data-side');
        const videoDifficulty = card.getAttribute('data-difficulty');
        let show = true;
        if (category !== 'all' && category !== '' && videoCategory !== category) show = false;
        if (map !== 'all' && map !== '' && videoMap !== map) show = false;
        if (position !== 'all' && position !== '' && videoPosition !== position) show = false;
        if (side !== 'all' && side !== '' && videoSide !== side) show = false;
        if (difficulty !== 'all' && difficulty !== '' && videoDifficulty !== difficulty) show = false;
        card.style.display = show ? 'block' : 'none';
      });
    }

    // Фильтрация по карте при клике на карточку карты
    function filterByMap(mapName) {
      showSection('videos');
      document.getElementById('filter-map').value = mapName;
      filterVideos();
    }

    async function toggleFavorite(videoId, element) {
      if (!currentUser) {
        showNotification('Для добавления в избранное необходимо войти в аккаунт', 'error');
        return;
      }

      const favorites = await getAllFavorites();
      const index = favorites.indexOf(videoId);
      const lang = document.documentElement.lang || 'ru';
      
      if (index === -1) {
        await addFavorite(videoId);
        element.classList.add('favorited');
        const videos = await getAllVideos();
        const video = videos.find(v => v.id === videoId);
        if (video) {
          video.favorites = (video.favorites || 0) + 1;
          await saveVideo(video);
        }
        showNotification(translations[lang]['video_add_to_favorites']);
      } else {
        await removeFavorite(videoId);
        element.classList.remove('favorited');
        const videos = await getAllVideos();
        const video = videos.find(v => v.id === videoId);
        if (video && video.favorites > 0) {
          video.favorites -= 1;
          await saveVideo(video);
        }
        showNotification(translations[lang]['video_remove_from_favorites']);
      }
      if (document.getElementById('favorites').classList.contains('active')) {
        await renderFavorites(lang);
      }
    }

    // Отображение избранного
    async function renderFavorites(lang = document.documentElement.lang || 'ru') {
      const favoritesContainer = document.getElementById('favorites-container');
      favoritesContainer.innerHTML = '';
      
      if (!currentUser) {
        favoritesContainer.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <i class="fas fa-exclamation-circle" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>Необходима авторизация</h3>
            <p>Для просмотра избранного необходимо войти в аккаунт</p>
          </div>
        `;
        return;
      }
      
      const favorites = await getAllFavorites();
      const videos = await getAllVideos();
      
      if (favorites.length === 0) {
        favoritesContainer.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
            <i class="far fa-star" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>${translations[lang]['no_favorites']}</h3>
            <p>${translations[lang]['no_favorites_text']}</p>
          </div>
        `;
        return;
      }
      videos.forEach(video => {
        if (favorites.includes(video.id)) {
          const videoCard = document.createElement('div');
          videoCard.className = 'video-card';
          let thumbContent = '';
          if (video.type === 'youtube') {
            const videoId = (video.src || '').split('/embed/')[1] || '';
            thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}">`;
          } else {
            // Убрана надпись "Файл" и оставлен просто темный фон
            thumbContent = `<div style="display:flex; align-items:center; justify-content:center; height:100%; background:#222;"></div>`;
          }
          videoCard.innerHTML = `
            <div class="video-actions">
              <button class="action-btn favorited" onclick="toggleFavorite(${video.id}, this)">
                <i class="fas fa-star"></i>
              </button>
              <button class="action-btn" onclick="openCollectionSelect(${video.id})">
                <i class="fas fa-folder-plus"></i>
              </button>
            </div>
            <div class="video-thumb" onclick="openVideo(${video.id})">
              ${thumbContent}
              <div class="play-icon"><i class="fas fa-play"></i></div>
            </div>
            <div class="video-info">
              <h3 class="video-title">${escapeHtml(video.title)}</h3>
              <div class="video-meta">
                <span>${getCategoryName(video.category, lang)}</span>
                <span>${escapeHtml(video.map || '—')}</span>
              </div>
              <p>${escapeHtml(video.description || '')}</p>
              <div class="video-details">
                ${video.difficulty ? `<div class="video-detail"><i class="fas fa-signal"></i> <span class="difficulty-badge difficulty-${video.difficulty}">${getDifficultyName(video.difficulty, lang)}</span></div>` : ''}
                ${video.side ? `<div class="video-detail"><i class="fas fa-user-shield"></i> ${getSideName(video.side, lang)}</div>` : ''}
                ${video.position ? `<div class="video-detail"><i class="fas fa-map-marker-alt"></i> ${escapeHtml(video.position)}</div>` : ''}
              </div>
            </div>
          `;
          favoritesContainer.appendChild(videoCard);
        }
      });
    }

    // Открытие модального окна выбора коллекции
    async function openCollectionSelect(videoId) {
      if (!currentUser) {
        showNotification('Для добавления в коллекцию необходимо войти в аккаунт', 'error');
        return;
      }

      currentVideoForCollection = videoId;
      const collections = await getAllCollections();
      const userCollections = collections.filter(c => c.userId === currentUser.id);
      const lang = document.documentElement.lang || 'ru';
      
      const collectionList = document.getElementById('collection-select-list');
      collectionList.innerHTML = '';
      
      if (userCollections.length === 0) {
        collectionList.innerHTML = `
          <div style="text-align: center; padding: 20px; color: var(--gray);">
            <p>${translations[lang]['no_collections_create']}</p>
            <button class="btn" onclick="openCreateCollectionModal()">${translations[lang]['collections_create']}</button>
          </div>
        `;
      } else {
        userCollections.forEach(collection => {
          const collectionItem = document.createElement('div');
          collectionItem.className = 'collection-select-item';
          collectionItem.innerHTML = `
            <h4>${escapeHtml(collection.name)}</h4>
            <p>${collection.videos ? collection.videos.length : 0} видео</p>
          `;
          collectionItem.addEventListener('click', () => addVideoToCollection(collection.id, videoId));
          collectionList.appendChild(collectionItem);
        });
      }
      
      document.getElementById('collection-select-modal').classList.add('active');
    }

    // Закрытие модального окна выбора коллекции
    function closeCollectionSelect() {
      document.getElementById('collection-select-modal').classList.remove('active');
      currentVideoForCollection = null;
    }

    // Добавление видео в коллекцию
    async function addVideoToCollection(collectionId, videoId) {
      const collections = await getAllCollections();
      const collection = collections.find(c => c.id === collectionId);
      const lang = document.documentElement.lang || 'ru';
      
      if (collection) {
        if (!collection.videos) collection.videos = [];
        if (!collection.videos.includes(videoId)) {
          collection.videos.push(videoId);
          await saveCollection(collection);
          showNotification(translations[lang]['notification_success']);
          closeCollectionSelect();
        } else {
          showNotification('Видео уже в этой коллекции', 'info');
        }
      } else {
        showNotification(translations[lang]['notification_error'], 'error');
      }
    }

    // Отображение коллекций
    async function renderCollections(lang = document.documentElement.lang || 'ru') {
      const collectionsContainer = document.getElementById('collections-container');
      collectionsContainer.innerHTML = '';
      
      const collections = await getAllCollections();
      let userCollections = [];
      
      if (currentUser) {
        userCollections = collections.filter(c => c.userId === currentUser.id);
      }
      
      if (!userCollections || userCollections.length === 0) {
        if (currentUser) {
          collectionsContainer.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
              <i class="far fa-folder-open" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
              <h3>${translations[lang]['no_collections']}</h3>
              <p>${translations[lang]['no_collections_text']}</p>
            </div>
          `;
        }
        document.getElementById('collection-view').style.display = 'none';
        return;
      }
      const videos = await getAllVideos();
      userCollections.forEach(collection => {
        const collectionItem = document.createElement('div');
        collectionItem.className = 'collection-gallery-item';
        collectionItem.innerHTML = `
          <div class="collection-actions">
            <button class="collection-action-btn" onclick="event.stopPropagation(); confirmDeleteCollection(${collection.id})">
              <i class="fas fa-trash"></i>
            </button>
          </div>
          <div class="collection-gallery-thumb">
            <i class="fas fa-folder"></i>
            <div class="collection-gallery-count">${(collection.videos ? collection.videos.length : 0)}</div>
          </div>
          <div class="collection-gallery-info">
            <h3 class="collection-gallery-title">${escapeHtml(collection.name)}</h3>
            <p class="collection-gallery-desc">${escapeHtml(collection.description || '')}</p>
          </div>
        `;
        collectionItem.addEventListener('click', () => openCollection(collection.id, lang));
        collectionsContainer.appendChild(collectionItem);
      });
      document.getElementById('collection-view').style.display = 'none';
    }

    // Открытие коллекции
    async function openCollection(collectionId, lang = document.documentElement.lang || 'ru') {
      const collections = await getAllCollections();
      const collection = collections.find(c => String(c.id) === String(collectionId));
      
      if (!collection) {
        showNotification(translations[lang]['notification_error'], 'error');
        return;
      }
      // Загружаем видео
      const videos = await getAllVideos();
      const container = document.getElementById('collection-videos-container');
      container.innerHTML = '';
      const ids = collection.videos || [];
      if (ids.length === 0) {
        container.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; padding: 30px; color: var(--gray);">${translations[lang]['collection_empty']}</div>`;
      } else {
        for (const id of ids) {
          const video = videos.find(v => String(v.id) === String(id));
          if (video) {
            const card = document.createElement('div');
            card.className = 'video-card';
            card.setAttribute('data-category', video.category || '');
            card.setAttribute('data-map', video.map || '');
            let thumbContent = '';
            if (video.type === 'youtube') {
              const videoId = (video.src || '').split('/embed/')[1] || '';
              thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}">`;
            } else {
              thumbContent = `<div style="display:flex; align-items:center; justify-content:center; height:100%; background:#222;"></div>`;
            }
            card.innerHTML = `
              <div class="video-actions">
                ${currentUser ? `
                  <button class="action-btn" onclick="toggleFavorite(${video.id}, this)">
                    <i class="fas fa-star"></i>
                  </button>
                  <button class="action-btn" onclick="openCollectionSelect(${video.id})">
                    <i class="fas fa-folder-plus"></i>
                  </button>
                ` : ''}
              </div>
              <div class="video-thumb" onclick="openVideo(${video.id})">
                ${thumbContent}
                <div class="play-icon"><i class="fas fa-play"></i></div>
              </div>
              <div class="video-info">
                <h3 class="video-title">${escapeHtml(video.title)}</h3>
                <div class="video-meta">
                  <span>${getCategoryName(video.category, lang)}</span>
                  <span>${escapeHtml(video.map || '—')}</span>
                </div>
                <p>${escapeHtml(video.description || '')}</p>
                <div class="video-details">
                  ${video.difficulty ? `<div class="video-detail"><i class="fas fa-signal"></i> <span class="difficulty-badge difficulty-${video.difficulty}">${getDifficultyName(video.difficulty, lang)}</span></div>` : ''}
                  ${video.side ? `<div class="video-detail"><i class="fas fa-user-shield"></i> ${getSideName(video.side, lang)}</div>` : ''}
                  ${video.position ? `<div class="video-detail"><i class="fas fa-map-marker-alt"></i> ${escapeHtml(video.position)}</div>` : ''}
                </div>
              </div>
            `;
            container.appendChild(card);
          }
        }
      }
      document.getElementById('collection-view').style.display = 'block';
      const backBtn = document.getElementById('collection-back-btn');
      backBtn.style.display = 'inline-block';
      document.getElementById('collection-view-title').textContent = collection.name;
      setTimeout(()=> document.getElementById('collection-view').scrollIntoView({behavior:'smooth'}), 50);
    }

    function closeCollectionView() {
      document.getElementById('collection-view').style.display = 'none';
      document.getElementById('collection-back-btn').style.display = 'none';
      document.getElementById('collection-view-title').textContent = '';
      document.getElementById('collection-videos-container').innerHTML = '';
      document.getElementById('collections-container').scrollIntoView({behavior:'smooth'});
    }

    // Рендер панели администратора
    async function renderAdminPanel(lang = document.documentElement.lang || 'ru') {
      // Проверяем права доступа
      if (!currentUser || (currentUser.role !== 'admin' && currentUser.role !== 'moderator')) {
        document.getElementById('admin').innerHTML = `
          <div style="text-align: center; padding: 40px;">
            <i class="fas fa-exclamation-triangle" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>Доступ запрещен</h3>
            <p>У вас нет прав для доступа к панели управления</p>
          </div>
        `;
        return;
      }

      // Показываем вкладку видео по умолчанию
      showAdminTab('videos');
      
      // Рендерим видео
      const adminList = document.getElementById('admin-video-list');
      adminList.innerHTML = '';
      const videos = await getAllVideos();
      
      if (videos.length === 0) {
        adminList.innerHTML = `
          <div style="text-align: center; padding: 40px;">
            <i class="fas fa-video-slash" style="font-size: 50px; color: var(--gray); margin-bottom: 15px;"></i>
            <h3>${translations[lang]['no_videos']}</h3>
            <p>${translations[lang]['no_videos_text']}</p>
          </div>
        `;
      } else {
        videos.forEach(video => {
          const videoItem = document.createElement('div');
          videoItem.className = 'admin-video-item';
          videoItem.innerHTML = `
            <div class="admin-video-info">
              <div class="admin-video-title">${escapeHtml(video.title)}</div>
              <div class="admin-video-meta">
                ${getCategoryName(video.category, lang)} • ${escapeHtml(video.map || 'Не указана')} • 
                ${video.date} • ${translations[lang]['video_views']}: ${video.views || 0}
              </div>
            </div>
            <button class="btn btn-danger" onclick="confirmDeleteVideo(${video.id})">
              <i class="fas fa-trash"></i> ${translations[lang]['admin_delete']}
            </button>
          `;
          adminList.appendChild(videoItem);
        });
      }
      
      // Рендерим избранные видео
      const featuredList = document.getElementById('featured-videos-list');
      featuredList.innerHTML = '';
      const featuredVideos = await getAllFeaturedVideos();
      const allVideos = await getAllVideos();
      
      featuredVideos.forEach(featured => {
        const video = allVideos.find(v => v.id === featured.videoId);
        if (video) {
          const featuredItem = document.createElement('div');
          featuredItem.className = 'featured-video-item';
          featuredItem.innerHTML = `
            <div class="admin-video-info">
              <div class="admin-video-title">${escapeHtml(video.title)}</div>
              <div class="admin-video-meta">
                ${getCategoryName(video.category, lang)} • ${escapeHtml(video.map || 'Не указана')}
              </div>
            </div>
            <button class="btn btn-danger" onclick="removeFeaturedVideo(${featured.id})">
              <i class="fas fa-trash"></i> ${translations[lang]['admin_delete']}
            </button>
          `;
          featuredList.appendChild(featuredItem);
        }
      });
    }

    // Открытие модального окна для добавления видео в быстрый старт
    async function openFeaturedModal() {
      const videos = await getAllVideos();
      const featuredVideos = await getAllFeaturedVideos();
      const featuredVideoIds = featuredVideos.map(f => f.videoId);
      
      const featuredList = document.getElementById('featured-video-select-list');
      featuredList.innerHTML = '';
      
      if (videos.length === 0) {
        featuredList.innerHTML = `
          <div style="text-align: center; padding: 20px; color: var(--gray);">
            <p>Нет доступных видео</p>
          </div>
        `;
      } else {
        videos.forEach(video => {
          if (!featuredVideoIds.includes(video.id)) {
            const videoItem = document.createElement('div');
            videoItem.className = 'featured-video-select-item';
            
            let thumbContent = '';
            if (video.type === 'youtube') {
              const videoId = (video.src || '').split('/embed/')[1] || '';
              thumbContent = `<img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title}" style="width: 100%; height: 100%; object-fit: cover;">`;
            } else {
              thumbContent = `<div style="display:flex; align-items:center; justify-content:center; height:100%; background:#333;"></div>`;
            }
            
            videoItem.innerHTML = `
              <div class="featured-video-thumb">
                ${thumbContent}
              </div>
              <div class="featured-video-info">
                <div class="featured-video-title">${escapeHtml(video.title)}</div>
                <div class="featured-video-meta">
                  ${getCategoryName(video.category)} • ${escapeHtml(video.map || 'Не указана')}
                </div>
              </div>
            `;
            videoItem.addEventListener('click', () => addFeaturedVideo(video.id));
            featuredList.appendChild(videoItem);
          }
        });
        
        if (featuredList.children.length === 0) {
          const lang = document.documentElement.lang || 'ru';
          featuredList.innerHTML = `
            <div style="text-align: center; padding: 20px; color: var(--gray);">
              <p>${translations[lang]['featured_all_added']}</p>
            </div>
          `;
        }
      }
      
      document.getElementById('featured-modal').classList.add('active');
    }

    // Закрытие модального окна добавления в быстрый старт
    function closeFeaturedModal() {
      document.getElementById('featured-modal').classList.remove('active');
    }

    // Добавление видео в раздел "Быстрый старт"
    async function addFeaturedVideo(videoId) {
      const lang = document.documentElement.lang || 'ru';
      
      const featuredVideo = {
        id: Date.now(),
        videoId: videoId
      };
      await saveFeaturedVideo(featuredVideo);
      showNotification(translations[lang]['notification_success']);
      closeFeaturedModal();
      await renderAdminPanel(lang);
      updateStats();
    }

    // Удаление видео из раздела "Быстрый старт"
    async function removeFeaturedVideo(id) {
      await deleteFeaturedVideoFromDB(id);
      const lang = document.documentElement.lang || 'ru';
      await renderAdminPanel(lang);
      updateStats();
      showNotification(translations[lang]['notification_success']);
    }

    // Подтверждение удаления видео
    function confirmDeleteVideo(videoId) {
      currentDeletion = { type: 'video', id: videoId };
      const lang = document.documentElement.lang || 'ru';
      document.getElementById('confirm-title').textContent = translations[lang]['confirm_title'];
      document.getElementById('confirm-message').textContent = translations[lang]['confirm_message'];
      document.getElementById('confirm-modal').classList.add('active');
    }

    // Подтверждение удаления коллекции
    async function confirmDeleteCollection(collectionId) {
      const collections = await getAllCollections();
      const collection = collections.find(c => String(c.id) === String(collectionId));
      if (!collection) return;
      currentDeletion = { type: 'collection', id: collectionId };
      const lang = document.documentElement.lang || 'ru';
      document.getElementById('confirm-title').textContent = translations[lang]['confirm_title'];
      document.getElementById('confirm-message').textContent = translations[lang]['confirm_message'];
      document.getElementById('confirm-modal').classList.add('active');
    }

    // Обработчики кнопок
    document.getElementById('confirm-yes').addEventListener('click', async function() {
      const { type, id } = currentDeletion;
      const lang = document.documentElement.lang || 'ru';
      
      if (!type || id === null) {
        document.getElementById('confirm-modal').classList.remove('active');
        return;
      }
      if (type === 'video') {
        try {
          const collections = await getAllCollections();
          for (const c of collections) {
            if (c.videos && c.videos.includes(id)) {
              c.videos = c.videos.filter(vid => String(vid) !== String(id));
              await saveCollection(c);
            }
          }
          await removeFavorite(id);
          await deleteVideoFromDB(id);
          // Обновляем UI
          await renderVideos(lang);
          await renderCollections(lang);
          await renderAdminPanel(lang);
          await renderFavorites(lang);
          updateStats();
          showNotification(translations[lang]['notification_success']);
        } catch (e) {
          console.error(e);
          showNotification(translations[lang]['notification_error'], 'error');
        }
      } else if (type === 'collection') {
        try {
          await deleteCollectionFromDB(id);
          await renderCollections(lang);
          updateStats();
          showNotification(translations[lang]['notification_success']);
        } catch (e) {
          console.error(e);
          showNotification(translations[lang]['notification_error'], 'error');
        }
      } else if (type === 'account') {
        try {
          await deleteAccount();
        } catch (e) {
          console.error(e);
          showNotification(translations[lang]['notification_error'], 'error');
        }
      }
      currentDeletion = { type: null, id: null };
      document.getElementById('confirm-modal').classList.remove('active');
    });

    document.getElementById('confirm-no').addEventListener('click', function() {
      currentDeletion = { type: null, id: null };
      document.getElementById('confirm-modal').classList.remove('active');
    });

    // Открытие видео
    async function openVideo(id) {
      const videos = await getAllVideos();
      const video = videos.find(v => v.id === id);
      if (!video) return;
      
      // Увеличиваем счетчик просмотров
      video.views = (video.views || 0) + 1;
      await saveVideo(video);
      
      const modal = document.getElementById('video-modal');
      const container = document.getElementById('modal-video-container');
      container.innerHTML = '';
      
      if (video.type === 'youtube') {
        const iframe = document.createElement('iframe');
        iframe.className = 'modal-video';
        iframe.src = video.src + '?autoplay=1';
        iframe.allowFullscreen = true;
        container.appendChild(iframe);
      } else {
        const videoEl = document.createElement('video');
        videoEl.className = 'modal-video';
        videoEl.src = video.src;
        videoEl.controls = true;
        videoEl.autoplay = true;
        container.appendChild(videoEl);
      }
      
      document.getElementById('modal-title').textContent = video.title;
      document.getElementById('modal-category').textContent = getCategoryName(video.category);
      document.getElementById('modal-date').textContent = video.date;
      document.getElementById('modal-description').textContent = video.description || '';
      document.getElementById('modal-map').textContent = video.map || '—';
      document.getElementById('modal-side').textContent = getSideName(video.side);
      document.getElementById('modal-difficulty').textContent = getDifficultyName(video.difficulty);
      
      modal.classList.add('active');
    }

    // Закрытие видео
    function closeVideo() {
      document.getElementById('video-modal').classList.remove('active');
      const container = document.getElementById('modal-video-container');
      container.innerHTML = '';
    }

    // Вспомогательные функции
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Обработчики для кнопок категорий
    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        const filter = this.getAttribute('data-filter');
        document.getElementById('filter-category').value = filter;
        filterVideos();
      });
    });

    // Обработчики для Enter в поиске
    document.getElementById('search-input').addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        searchVideos();
      }
    });

    // Обработчики для Enter в формах
    document.querySelectorAll('input, textarea').forEach(input => {
      input.addEventListener('keyup', function(e) {
        if (e.key === 'Enter' && this.closest('.auth-form')) {
          if (this.closest('#login-tab')) {
            login();
          } else if (this.closest('#register-tab')) {
            register();
          }
        }
      });
    });
  </script>
</body>
</html>
<?php
header('Content-Type: application/json');
require 'db.php';

// Получаем JSON от JS
$data = json_decode(file_get_contents('php://input'), true);

if (!$data) {
    http_response_code(400);
    echo json_encode(['error' => 'No data']);
    exit;
}

// В реальном проекте тут нужна проверка авторизации (сессии)!
// Для простоты пока сохраняем так.

try {
    $sql = "INSERT INTO videos (title, category, map, position, side, difficulty, description, src, type, author_id) 
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
    $stmt= $pdo->prepare($sql);
    $stmt->execute([
        $data['title'],
        $data['category'],
        $data['map'],
        $data['position'],
        $data['side'],
        $data['difficulty'],
        $data['description'],
        $data['src'],
        $data['type'],
        1 // Временно ставим ID 1, пока не настроили авторизацию
    ]);

    echo json_encode(['success' => true, 'id' => $pdo->lastInsertId()]);
} catch (Exception $e) {
    http_response_code(500);
    echo json_encode(['error' => $e->getMessage()]);
}
?>
